[
{"site": "community", "title": "Platform.sh Community", "section": "Platform.sh Community", "url": "https://community.platform.sh/", "documentId": "dd8f1db4b010992a1954719885282d8eddf7ab33", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  \n    \n      \n        Category\n        Topics\n      \n    \n    \n      \n        \n          \n            \n              \n              \n              \n                \n                  How-to Guides\n                \n              \n              A How-to Guide is a goal-oriented document that shows a series of steps or actions needed to do a specific task.\n            \n          \n          \n            83\n          \n        \n        \n          \n            \n              \n              \n              \n                \n                  Questions &amp; Answers\n                \n              \n              \n            \n          \n          \n            104\n          \n        \n        \n          \n            \n              \n              \n              \n                \n                  Tutorials\n                \n              \n              Tutorials are learning oriented set of tasks aimed at getting users started with a topic. It\u2019s a set of well explained steps to take to see immediate results, even if those results are not production-grade. At the end of the tutorial, the reader has accomplished and learned something.\n            \n          \n          \n            10\n          \n        \n    \n  \n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Privacy", "section": "Platform.sh Community", "url": "https://community.platform.sh/privacy", "documentId": "3da31d8460dc647c5d58786cba0d8ae725b87ff1", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  \n  \n      About\n        FAQ\n    Terms of Service\n    Privacy\n  \n\n\n  \n    See the Platform.sh Privacy Policy.\n  \n\n\n  \n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "FAQ", "section": "Platform.sh Community", "url": "https://community.platform.sh/faq", "documentId": "d175792e7ed491957b0e67c76f05b067fb6b569b", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  \n  \n      About\n        FAQ\n    Terms of Service\n    Privacy\n  \n\n\n  \n    \nThis is a Civilized Place for Public Discussion\nPlease treat this discussion forum with the same respect you would a public park.  We, too, are a shared community resource \u2014 a place to share skills, knowledge and interests through ongoing conversation.\nThese are not hard and fast rules, merely guidelines to aid the human judgment of our community and keep this a clean and well-lighted place for civilized public discourse.\n\nImprove the Discussion\nHelp us make this a great place for discussion by always working to improve the discussion in some way, however small. If you are not sure your post adds to the conversation, think over what you want to say and try again later.\nThe topics discussed here matter to us, and we want you to act as if they matter to you, too. Be respectful of the topics and the people discussing them, even if you disagree with some of what is being said.\nOne way to improve the discussion is by discovering ones that are already happening. Spend time browsing the topics here before replying or starting your own, and you\u2019ll have a better chance of meeting others who share your interests.\n\nBe Agreeable, Even When You Disagree\nYou may wish to respond to something by disagreeing with it. That\u2019s fine. But remember to criticize ideas, not people. Please avoid:\n\nName-calling\nAd hominem attacks\nResponding to a post\u2019s tone instead of its actual content\nKnee-jerk contradiction\n\nInstead, provide reasoned counter-arguments that improve the conversation.\n\nYour Participation Counts\nThe conversations we have here set the tone for every new arrival. Help us influence the future of this community by choosing to engage in discussions that make this forum an interesting place to be \u2014 and avoiding those that do not.\nDiscourse provides tools that enable the community to collectively identify the best (and worst) contributions: bookmarks, likes, flags, replies, edits, and so forth. Use these tools to improve your own experience, and everyone else\u2019s, too.\nLet\u2019s leave our community better than we found it.\n\nIf You See a Problem, Flag It\nModerators have special authority; they are responsible for this forum. But so are you. With your help, moderators can be community facilitators, not just janitors or police.\nWhen you see bad behavior, don\u2019t reply. It encourages the bad behavior by acknowledging it, consumes your energy, and wastes everyone\u2019s time. Just flag it. If enough flags accrue, action will be taken, either automatically or by moderator intervention.\nIn order to maintain our community, moderators reserve the right to remove any content and any user account for any reason at any time. Moderators do not preview new posts; the moderators and site operators take no responsibility for any content posted by the community.\n\nAlways Be Civil\nNothing sabotages a healthy conversation like rudeness:\n\nBe civil. Don\u2019t post anything that a reasonable person would consider offensive, abusive, or hate speech.\nKeep it clean. Don\u2019t post anything obscene or sexually explicit.\nRespect each other. Don\u2019t harass or grief anyone, impersonate people, or expose their private information.\nRespect our forum. Don\u2019t post spam or otherwise vandalize the forum.\n\nThese are not concrete terms with precise definitions \u2014 avoid even the appearance of any of these things. If you\u2019re unsure, ask yourself how you would feel if your post was featured on the front page of the New York Times.\nThis is a public forum, and search engines index these discussions. Keep the language, links, and images safe for family and friends.\n\nKeep It Tidy\nMake the effort to put things in the right place, so that we can spend more time discussing and less cleaning up. So:\n\nDon\u2019t start a topic in the wrong category.\nDon\u2019t cross-post the same thing in multiple topics.\nDon\u2019t post no-content replies.\nDon\u2019t divert a topic by changing it midstream.\nDon\u2019t sign your posts \u2014 every post has your profile information attached to it.\n\nRather than posting \u201c+1\u201d or \u201cAgreed\u201d, use the Like button. Rather than taking an existing topic in a radically different direction, use Reply as a Linked Topic.\n\nPost Only Your Own Stuff\nYou may not post anything digital that belongs to someone else without permission. You may not post descriptions of, links to, or methods for stealing someone\u2019s intellectual property (software, video, audio, images), or for breaking any other law.\n\nPowered by You\nThis site is operated by your friendly local staff and you, the community. If you have any further questions about how things should work here, open a new topic in the site feedback category and let\u2019s discuss! If there\u2019s a critical or urgent issue that can\u2019t be handled by a meta topic or flag, contact us.\n\nTerms of Service\nYes, legalese is boring, but we must protect ourselves \u2013 and by extension, you and your data \u2013 against unfriendly folks. We have a Terms of Service describing your (and our) behavior and rights related to content, privacy, and laws. To use this service, you must agree to abide by our TOS.\n  \n\n\n  \n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Platform.sh Community", "section": "Platform.sh Community", "url": "https://community.platform.sh/categories", "documentId": "179aa3f7a7743c9a9a6547bdb49980fd688287af", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  \n    \n      \n        Category\n        Topics\n      \n    \n    \n      \n        \n          \n            \n              \n              \n              \n                \n                  How-to Guides\n                \n              \n              A How-to Guide is a goal-oriented document that shows a series of steps or actions needed to do a specific task.\n            \n          \n          \n            83\n          \n        \n        \n          \n            \n              \n              \n              \n                \n                  Questions &amp; Answers\n                \n              \n              \n            \n          \n          \n            104\n          \n        \n        \n          \n            \n              \n              \n              \n                \n                  Tutorials\n                \n              \n              Tutorials are learning oriented set of tasks aimed at getting users started with a topic. It\u2019s a set of well explained steps to take to see immediate results, even if those results are not production-grade. At the end of the tutorial, the reader has accomplished and learned something.\n            \n          \n          \n            10\n          \n        \n    \n  \n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Terms of Service", "section": "Platform.sh Community", "url": "https://community.platform.sh/tos", "documentId": "a48fa5b5a67797315fbdb803f3ccc0d1f7ec3c4f", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  \n  \n      About\n        FAQ\n    Terms of Service\n    Privacy\n  \n\n\n  \n    See the Platform.sh Terms of Service.\n  \n\n\n  \n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Latest How-to Guides topics", "section": "Platform.sh Community", "url": "https://community.platform.sh/c/how-to", "documentId": "f2cd5f12120bb3cb0f8a161a94cbc3a5489bfe1e", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n\n\n\n  \n\n    \n      How-to Guides\n  \n  \n\n\n\n  \n\n    \n      \n        Topic\n        Replies\n        Activity\n      \n    \n\n    \n      \n        \n          \n            \n            \n            \n            \n              How to make a Vue.js single page application (SPA) on Platform.sh\n            \n          \n          \n            4\n          \n          \n            April 22, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to monitor long running scripts with pv\n            \n          \n          \n            1\n          \n          \n            April 22, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to configure Java with New Relic At Platform.sh\n            \n          \n          \n            1\n          \n          \n            April 17, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to Migrate my Java Application to Platfrom.sh\n            \n          \n          \n            1\n          \n          \n            April 15, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Improving GraphQL performance by caching POST requests\n            \n          \n          \n            1\n          \n          \n            April 15, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to Overwrite Spring Data variable to access Platform.sh services\n            \n          \n          \n            1\n          \n          \n            April 13, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to Migrate your Java 8 application to Java 11 on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 18, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to Overwrite variables to Payara JPA access Platform.sh SQL services\n            \n          \n          \n            1\n          \n          \n            April 13, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to overwrite configuration to Jakarta/MicroProfile to access Platform.sh services\n            \n          \n          \n            1\n          \n          \n            April 13, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to Configure your Java Application with Log4J at Platform.sh\n            \n          \n          \n            1\n          \n          \n            April 2, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to overwrite Spring Data MongodB variable to access Platform.sh services\n            \n          \n          \n            1\n          \n          \n            April 15, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to migrate your Java Application from Heroku to Platform.sh\n            \n          \n          \n            1\n          \n          \n            January 14, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to set up Wordpress to use the HTTP cache of Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 24, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to install Wordpress plugins and themes with Composer\n            \n          \n          \n            1\n          \n          \n            March 24, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to use environment variables with nuxtjs on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 20, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to deploy Nextcloud to Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 19, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to deploy Mattermost (Slack alternative) on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 19, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to create, initialize, and delete a Platform.sh project from the command line\n            \n          \n          \n            1\n          \n          \n            April 3, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to access InfluxDB credentials on Platform.sh\n            \n          \n          \n            4\n          \n          \n            March 19, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to run Grocy on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 18, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to run CryptPad on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 8, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to fail a build on failing unit tests\n            \n          \n          \n            3\n          \n          \n            March 6, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to flush the Fastly cache\n            \n          \n          \n            1\n          \n          \n            March 6, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to determine database usage of an environment\n            \n          \n          \n            1\n          \n          \n            March 25, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to compile CSS using SASS on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 13, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to set up automated environment tasks\n            \n          \n          \n            1\n          \n          \n            March 13, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to use wkhtmltopdf on platform.sh\n            \n          \n          \n            1\n          \n          \n            January 24, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Set up XDebug on Dedicated (Pro) server clusters\n            \n          \n          \n            1\n          \n          \n            November 19, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to configure a php mail library (like Drupal 7 phpmailer) to use the correct server\n            \n          \n          \n            1\n          \n          \n            December 30, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How do I get a postgres connection string for prisma2 framework\n            \n          \n          \n            1\n          \n          \n            December 11, 2019\n          \n        \n    \n\n  \n\n\n  \n    next page \u2192\n  \n\n\n \n\n\n\n  \n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Latest Tutorials topics", "section": "Platform.sh Community", "url": "https://community.platform.sh/c/tutorial", "documentId": "a768c61b2709fb1f5e584cc8f4079c12e364c145", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n\n\n\n  \n\n    \n      Tutorials\n  \n  \n\n\n\n  \n\n    \n      \n        Topic\n        Replies\n        Activity\n      \n    \n\n    \n      \n        \n          \n            \n            \n            \n            \n              Multiple Applications (Tomcat)\n            \n          \n          \n            1\n          \n          \n            February 19, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Tips for running Java on Platform.sh\n            \n          \n          \n            1\n          \n          \n            April 16, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Java Memory commands\n            \n          \n          \n            1\n          \n          \n            March 5, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Garbage Collector Log\n            \n          \n          \n            1\n          \n          \n            March 5, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Java Email at Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 5, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to kill stuck processes that block your deployments\n            \n          \n          \n            1\n          \n          \n            February 24, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Consequences of restoring backups after the persistent data model has been changed\n            \n          \n          \n            1\n          \n          \n            February 12, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Preventing stuck deployments caused by long-running cron jobs\n            \n          \n          \n            1\n          \n          \n            December 17, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Compiling a Drupal site with Tome\n            \n          \n          \n            1\n          \n          \n            July 23, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Installing Drupal and Mautic together in one project\n            \n          \n          \n            1\n          \n          \n            November 22, 2019\n          \n        \n    \n\n  \n\n\n  \n    next page \u2192\n  \n\n\n \n\n\n\n  \n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "FAQ", "section": "Platform.sh Community", "url": "https://community.platform.sh/guidelines", "documentId": "697e64e54fe9255deff2d9ffa112f7a03e8f9a6c", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  \n  \n      About\n        FAQ\n    Terms of Service\n    Privacy\n  \n\n\n  \n    \nThis is a Civilized Place for Public Discussion\nPlease treat this discussion forum with the same respect you would a public park.  We, too, are a shared community resource \u2014 a place to share skills, knowledge and interests through ongoing conversation.\nThese are not hard and fast rules, merely guidelines to aid the human judgment of our community and keep this a clean and well-lighted place for civilized public discourse.\n\nImprove the Discussion\nHelp us make this a great place for discussion by always working to improve the discussion in some way, however small. If you are not sure your post adds to the conversation, think over what you want to say and try again later.\nThe topics discussed here matter to us, and we want you to act as if they matter to you, too. Be respectful of the topics and the people discussing them, even if you disagree with some of what is being said.\nOne way to improve the discussion is by discovering ones that are already happening. Spend time browsing the topics here before replying or starting your own, and you\u2019ll have a better chance of meeting others who share your interests.\n\nBe Agreeable, Even When You Disagree\nYou may wish to respond to something by disagreeing with it. That\u2019s fine. But remember to criticize ideas, not people. Please avoid:\n\nName-calling\nAd hominem attacks\nResponding to a post\u2019s tone instead of its actual content\nKnee-jerk contradiction\n\nInstead, provide reasoned counter-arguments that improve the conversation.\n\nYour Participation Counts\nThe conversations we have here set the tone for every new arrival. Help us influence the future of this community by choosing to engage in discussions that make this forum an interesting place to be \u2014 and avoiding those that do not.\nDiscourse provides tools that enable the community to collectively identify the best (and worst) contributions: bookmarks, likes, flags, replies, edits, and so forth. Use these tools to improve your own experience, and everyone else\u2019s, too.\nLet\u2019s leave our community better than we found it.\n\nIf You See a Problem, Flag It\nModerators have special authority; they are responsible for this forum. But so are you. With your help, moderators can be community facilitators, not just janitors or police.\nWhen you see bad behavior, don\u2019t reply. It encourages the bad behavior by acknowledging it, consumes your energy, and wastes everyone\u2019s time. Just flag it. If enough flags accrue, action will be taken, either automatically or by moderator intervention.\nIn order to maintain our community, moderators reserve the right to remove any content and any user account for any reason at any time. Moderators do not preview new posts; the moderators and site operators take no responsibility for any content posted by the community.\n\nAlways Be Civil\nNothing sabotages a healthy conversation like rudeness:\n\nBe civil. Don\u2019t post anything that a reasonable person would consider offensive, abusive, or hate speech.\nKeep it clean. Don\u2019t post anything obscene or sexually explicit.\nRespect each other. Don\u2019t harass or grief anyone, impersonate people, or expose their private information.\nRespect our forum. Don\u2019t post spam or otherwise vandalize the forum.\n\nThese are not concrete terms with precise definitions \u2014 avoid even the appearance of any of these things. If you\u2019re unsure, ask yourself how you would feel if your post was featured on the front page of the New York Times.\nThis is a public forum, and search engines index these discussions. Keep the language, links, and images safe for family and friends.\n\nKeep It Tidy\nMake the effort to put things in the right place, so that we can spend more time discussing and less cleaning up. So:\n\nDon\u2019t start a topic in the wrong category.\nDon\u2019t cross-post the same thing in multiple topics.\nDon\u2019t post no-content replies.\nDon\u2019t divert a topic by changing it midstream.\nDon\u2019t sign your posts \u2014 every post has your profile information attached to it.\n\nRather than posting \u201c+1\u201d or \u201cAgreed\u201d, use the Like button. Rather than taking an existing topic in a radically different direction, use Reply as a Linked Topic.\n\nPost Only Your Own Stuff\nYou may not post anything digital that belongs to someone else without permission. You may not post descriptions of, links to, or methods for stealing someone\u2019s intellectual property (software, video, audio, images), or for breaking any other law.\n\nPowered by You\nThis site is operated by your friendly local staff and you, the community. If you have any further questions about how things should work here, open a new topic in the site feedback category and let\u2019s discuss! If there\u2019s a critical or urgent issue that can\u2019t be handled by a meta topic or flag, contact us.\n\nTerms of Service\nYes, legalese is boring, but we must protect ourselves \u2013 and by extension, you and your data \u2013 against unfriendly folks. We have a Terms of Service describing your (and our) behavior and rights related to content, privacy, and laws. To use this service, you must agree to abide by our TOS.\n  \n\n\n  \n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "All Time", "section": "Platform.sh Community", "url": "https://community.platform.sh/c/questions-answers", "documentId": "ec1f8b61dfe30e87299a23c703da2904e82f9a15", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n\n\n\n  \n\n    \n      Questions &amp; Answers\n  \n  \n\n\n\n  \n\n    \n      \n        Topic\n        Replies\n        Activity\n      \n    \n\n    \n      \n        \n          \n            \n            \n            \n            \n              Is it possible to kill a build or deploy?\n            \n          \n          \n            2\n          \n          \n            March 26, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              What does \"WARNING: [pool web] server reached max_children setting (2), consider raising it\" mean?\n            \n          \n          \n            2\n          \n          \n            May 7, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I forward my logs to Splunk or Logz.io?\n            \n          \n          \n            2\n          \n          \n            April 8, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Using a custom certificate and LetsEncrypt certificates on the same project?\n            \n          \n          \n            2\n          \n          \n            July 24, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Can I use Platform.sh for a different language?\n            \n          \n          \n            2\n          \n          \n            May 6, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Does Platform.sh support subdomains and Let's Encrypt for them?\n            \n          \n          \n            3\n          \n          \n            April 18, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              My plan has 10GB of storage. How can I see precisely how much I am using?\n            \n          \n          \n            4\n          \n          \n            April 16, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Using platform.sh environments for continuous integration / functional tests\n            \n          \n          \n            2\n          \n          \n            February 7, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to use FTP to upload files?\n            \n          \n          \n            2\n          \n          \n            May 15, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Log location? dblog or syslog?\n            \n          \n          \n            2\n          \n          \n            April 16, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How do I access my .git directory from within my app?\n            \n          \n          \n            4\n          \n          \n            February 18, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Transferring backups from P.sh to S3\n            \n          \n          \n            4\n          \n          \n            May 29, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              My project has exceeded its cpu limit. What do I do?\n            \n          \n          \n            2\n          \n          \n            May 22, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I access to an environment variable in Javascript?\n            \n          \n          \n            2\n          \n          \n            May 6, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              My project looks to be out of storage. How do I add more?\n            \n          \n          \n            2\n          \n          \n            May 6, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I move a Wordpress site to Platform.sh?\n            \n          \n          \n            3\n          \n          \n            May 29, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Is it possible to run a docker container on Platform.sh?\n            \n          \n          \n            2\n          \n          \n            July 11, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              What is the different between Platform.sh and Terraform?\n            \n          \n          \n            2\n          \n          \n            August 1, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I connect an external tool to my database?\n            \n          \n          \n            2\n          \n          \n            May 2, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I refresh my projects list in Platform CLI?\n            \n          \n          \n            5\n          \n          \n            July 12, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              I need to connect to a VPN endpoint. What are my options?\n            \n          \n          \n            2\n          \n          \n            February 7, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Is there a way to do the equivalent of \"screen\" on platform.sh?\n            \n          \n          \n            2\n          \n          \n            February 7, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Can I point my apex (naked) domain to Platform.sh if I'm using Amazon Route 53 to manage DNS?\n            \n          \n          \n            2\n          \n          \n            June 7, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              What is the difference between a rebuild and a redeploy?\n            \n          \n          \n            2\n          \n          \n            July 11, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I make custom 404 pages?\n            \n          \n          \n            2\n          \n          \n            April 11, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I receive a notification if one of my services (eg. MariaDB) dies?\n            \n          \n          \n            2\n          \n          \n            March 27, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              (How) Can I change the \"Code base template\" after purchasing a plan?\n            \n          \n          \n            3\n          \n          \n            May 7, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Where do I submit bug reports?\n            \n          \n          \n            4\n          \n          \n            May 20, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              What is the right way to run multiple processes from my start command?\n            \n          \n          \n            3\n          \n          \n            March 17, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Why is the .platform.app.yaml file separate from the .platform folder?\n            \n          \n          \n            3\n          \n          \n            May 15, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I remove the \"sent via platform.sh\" in my emails\n            \n          \n          \n            2\n          \n          \n            May 8, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              What is Git? How to use it?\n            \n          \n          \n            2\n          \n          \n            May 6, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How are mounts in .platform.app.yaml sized?\n            \n          \n          \n            2\n          \n          \n            March 26, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I expose non-80/443 TCP port to the Internet?\n            \n          \n          \n            2\n          \n          \n            May 17, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Is there a public product roadmap?\n            \n          \n          \n            2\n          \n          \n            May 17, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Why should I use Platform.sh over AWS?\n            \n          \n          \n            2\n          \n          \n            June 20, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I see the status of a bug?\n            \n          \n          \n            2\n          \n          \n            May 20, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Where could I submit feature request?\n            \n          \n          \n            2\n          \n          \n            May 17, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Is my built code counted against my global plan storage?\n            \n          \n          \n            2\n          \n          \n            April 12, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Can I SSH into my website?\n            \n          \n          \n            2\n          \n          \n            May 2, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How much storage can I add to my project?\n            \n          \n          \n            2\n          \n          \n            April 29, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              What is the routes.yaml max file size?\n            \n          \n          \n            2\n          \n          \n            March 28, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              More production environments on the project\n            \n          \n          \n            2\n          \n          \n            May 15, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              What does it mean when my environment has a \"dirty\" status?\n            \n          \n          \n            2\n          \n          \n            March 26, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Can I just have my whole project read / write and serve my PHP website from here?\n            \n          \n          \n            2\n          \n          \n            May 3, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Do you support other version control system?\n            \n          \n          \n            2\n          \n          \n            May 6, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How do the queues in my project work? Is it only possible to have one thing building/deploying at a time?\n            \n          \n          \n            2\n          \n          \n            April 11, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Can I get a dedicated FTP/SFTP account for access to a specific directory?\n            \n          \n          \n            2\n          \n          \n            February 7, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Can I have root permissions?\n            \n          \n          \n            2\n          \n          \n            May 3, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Can I get FTP access to change my html pages?\n            \n          \n          \n            2\n          \n          \n            May 15, 2019\n          \n        \n    \n\n  \n\n\n  \n    next page \u2192\n  \n\n\n \n\n\n\n  \n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "About", "section": "Platform.sh Community", "url": "https://community.platform.sh/about", "documentId": "bbc6b2ab855de6369f7dff1c4da5c57b17930592", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n\n  \n    About Platform.sh Community\n  \n\n  \n    For developers using Platform.sh, providing answers to questions, How-to Guides, and Tutorials.\n  \n\n  Our Admins\n\n  \n      \n        \n        \n          \n            \n          \n          \n            robert\n              - Robert Douglass\n          \n        \n      \n      \n        \n        \n          \n            \n          \n          \n            oripekelman\n          \n        \n      \n      \n        \n        \n          \n            \n          \n          \n            otavio-santana\n              - Otavio Santana\n          \n        \n      \n      \n        \n        \n          \n            \n          \n          \n            Crell\n              - Larry Garfield\n          \n        \n      \n      \n        \n        \n          \n            \n          \n          \n            chad-carlson\n              - Chad Carlson\n          \n        \n      \n      \n        \n        \n          \n            \n          \n          \n            nick\n              - Nick Anderegg\n          \n        \n      \n      \n        \n        \n          \n            \n          \n          \n            alex.hobday\n          \n        \n      \n      \n        \n        \n          \n            \n          \n          \n            pjcdawkins\n              - Patrick Dawkins\n          \n        \n      \n  \n\n    Our Moderators\n    \n        \n          \n          \n            \n              \n            \n            \n              alphonse\n                - Alphonse Delaporte\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              pdinoto\n                - Pablo Di Noto\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              nicholas-bennison\n                - Nicholas Bennison\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              vuyo-dumisizwe-bhemb\n                - Vuyo Dumisizwe Bhembe\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              branislav\n                - Branislav Bujisic\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              krishna-kashyap\n                - Krishna Kashyap\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              sruggier\n                - Simon\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              allison\n                - Allison Simmons\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              arun\n                - Arun Prasath\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              jeremie-preault\n                - Jeremie Preault\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              benoit-hamon\n                - Benoit Hamon\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              shawn-ogasawara\n                - Shawn Ogasawara\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              mariebischoff\n                - Marie Bischoff\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              matthieu\n                - Matthieu Tardivat\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              thomas\n                - Thomas Webb\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              merrick-young\n                - Merrick Young\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              brandy\n                - Brandy Chupe\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              praburaj-dravidamani\n                - Praburaj D\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              matthias-van-woensel\n                - Matthias Van Woensel\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              dman\n                - Dan Morrison\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              travis.raup\n                - Travis Raup\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              jared-wright\n                - Jared Wright\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              duncan\n                - Duncan Naves\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              GuGuss\n                - Augustin Delaporte\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              jonaskroeger\n                - Jonas Kr\u00f6ger\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              kotnik\n                - Nikola Kotur\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              maria-a\n                - Maria A.\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              gnufred\n                - Fr\u00e9d\u00e9ric Potvin\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              bogdan-vasilescu\n                - Bogdan Vasilescu\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              adam-mahar\n                - Adam Mahar\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              zendoodles\n                - Andrea Soper\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              tristan-blattman\n                - Tristan Blattman\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              Gauthier\n                - Gauthier Garnier\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              jgrubb\n                - John Grubb\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              sawssen\n                - Sawssen\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              chris.yates\n                - Chris Yates\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              julien.khamis\n                - Julien Khamis\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              afotey\n                - Afotey Quaye\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              Mac_Weber\n                - Weber Macedo\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              Kfray\n                - Kathryn Frazer\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              royall\n                - Royall Spence\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              ralt\n                - Florian Margaine\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              sholdowa\n                - Steve Holdoway\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              brandon\n                - Brandon LeBlanc\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              csabapardovicki\n                - Csaba Pardovicki\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              lucas\n                - Lucas Stil\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              chris-skene-platform\n                - Chris Skene\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              anders-savill\n                - Anders Savill\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              dudenhofer\n                - Aaron Dudenhofer\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              ludoge\n                - Ludovico Altana\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              omurphy\n                - Ollie Murphy\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              timgilmour\n                - Tim Gilmour\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              danmilon\n                - Dan Milon\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              mrkschan\n                - Ks Chan\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              Ovv\n                - Quentin Dawans\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              tony\n                - Tony Greising Murschel\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              mouhamadou\n                - Mouhamadou Fall\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              bradhomer\n                - Brad Homer\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              nls\n                - Guillaume Moigneu\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              juliensalinas\n                - Julien Salinas\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              stephanie-daugherty\n                - Stephanie Daugherty\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              joey\n                - Joey Stanford\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              daniel-snider\n                - Daniel Snider\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              natharper\n                - Natalie Harper\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              andrew-kester\n                - Andrew Kester\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              cmstrickland\n                - Cms\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              nils.ottermann\n                - Nils Ottermann\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              robertonovelo\n                - Roberto Novelo\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              olga-linek\n                - Olga Linek\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              adamb\n                - \u00c1d\u00e1m Bakal\u00e1r\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              dawid\n                - Dawid Kuder\n            \n          \n        \n        \n          \n          \n            \n              \n            \n            \n              alexmadon\n                - Alex Madon\n            \n          \n        \n    \n\n\n  \n    Site Statistics\n\n    \n      \n        \u00a0\n        All Time\n        Last 7\n        Last 30\n      \n      \n        Topics\n        217\n        2\n        14\n      \n      \n        Posts\n        804\n        17\n        68\n      \n      \n        Users\n        185\n        5\n        14\n      \n      \n        Active Users\n        \u2014\n        14\n        38\n      \n      \n        Likes\n        61\n        0\n        8\n      \n    \n  \n\n\n\n\n\n\n  \n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to use environment variables with nuxtjs on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-use-environment-variables-with-nuxtjs-on-platform-sh/505", "documentId": "13da455c03f56ab3042003cd3aefd80122dc4c22", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to use environment variables with nuxtjs on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            vuejs\n          \n        \n        \n          \n            env-variables\n          \n        \n        \n          \n            build-hook\n          \n        \n        \n          \n            nuxtjs\n          \n        \n        \n          \n            nuxt-env\n          \n        \n        \n          \n            environment\n          \n        \n        \n          \n            variables\n          \n        \n    \n\n\n\n\n  \n      \n        \n          matthias-van-woensel\n          \n        \n\n        \n            \n              March 20, 2020, 11:08am\n            \n        #1\n        \n      \n      \n        Goal\nTo use environment variables in a nuxtjs app on Platform.sh\nProblem\nNuxt currently provides a very handy way of injecting environment variables which uses webpack substitution to inject your env vars at build time.\nThis works most of the time, but on Platform.Sh the build process is environment-agnostic. A build can, and will be reused on different environments. This means that environment variables are not available in the build hook. So nuxt is not able to compile them.\nBuilding nuxt in the deploy hook, is also not possible, since the file system is read only.\nWork around: nuxt-env\nLuckily, there is a work around.\nThere\u2019s a nuxtjs plugin called nuxt-env. This allows you to define the environment variables that you want to access at runtime.\nFirst, make sure you have nuxt-env installed by running yarn add nuxt-env on your local pc, and commit that yarn.lock file to your repository\nThen, you can add the env vars you want to injects to your nuxt.config.js file\n// nuxt.config.js\n\n// Tell nuxt-env which env vars you want to inject\nmodules: [\n  'other-nuxt-module',\n  ['nuxt-env', {\n    keys: [\n      'TEST_ENV_VAR', // Basic usage\u2014equivalent of { key: 'TEST_ENV_VAR' }\n      { key: 'OTHER_ENV_VAR', default: 'defaultValue' } // Specify a default value\n      { key: 'THIRD_ENV_VAR', secret: true } // Only inject the var server side\n      { key: 'ANOTHER_ENV_VAR', name: 'MY_ENV_VAR' } // Rename the variable\n    ]\n  }]\n]\n\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to deploy Mattermost (Slack alternative) on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-deploy-mattermost-slack-alternative-on-platform-sh/503", "documentId": "e30b693152ca176a4c3ef5c3b899fad1e111d1fa", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to deploy Mattermost (Slack alternative) on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            slack\n          \n        \n        \n          \n            mattermost\n          \n        \n        \n          \n            template\n          \n        \n    \n\n\n\n\n  \n      \n        \n          robert\n          \n        \n\n        \n            \n              March 19, 2020, 12:03pm\n            \n        #1\n        \n      \n      \n        Goal\nThis how-to guide will guide you through deploying Mattermost on Platform.sh.\nAssumptions\nYou will need:\n\nAn SSH key configured on your Platform.sh account\nThe Platform.sh CLI tool installed.\n\nSteps\n\nCreate a new Platform.sh project\nInstall Mattermost from the CLI\nCreate a first account and team\nConnect it to your Desktop and Mobile Mattermost clients\n\n1. Create a new project\nYou can create a new project using the Platform.sh CLI tool:\nplatform create\n\nAfter following the instructions, you will get a confirmation that a new project has been created. Copy the new project ID.\n2. Initialize your project with your new project ID\nReplace &lt;PROJECT ID&gt;with the ID from the previous step and execute this command:\nplatform environment:init -p &lt;PROJECT ID&gt; -e master https://github.com/platformsh-templates/mattermost\n\n3. Create a first account and team\nUse the URL from the first step to visit your new Mattermost website, and complete the steps in the setup wizard.\n\nScreen Shot 2020-03-19 at 12.43.41.png1136\u00d71518 100 KB\n\n\nScreen Shot 2020-03-19 at 12.44.34.png2616\u00d71642 238 KB\n\n4. Connect it to your Desktop and Mobile Mattermost clients\nOnce you have created an account and a team on your Mattermost server, you can log into the server from your desktop client or mobile app. See Mattermost downloads on how to get those.\nThe server URL is the same URL that was displayed in Step 1 of this how-to guide, the URL to your running Mattermost server.\nThe authentication that follows is the account you created in Step 3.\n\nScreen Shot 2020-03-19 at 12.58.56.png1968\u00d7742 70.2 KB\n\nConclusion\nUsing the Platform.sh CLI and the Mattermost template provided by Platform.sh, it is a straightforward process to set up a Mattermost server.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to install Wordpress plugins and themes with Composer", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-install-wordpress-plugins-and-themes-with-composer/507", "documentId": "629a1fcb4ec0a1e35d90ef5bffb6ff9b6d6c170c", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to install Wordpress plugins and themes with Composer\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            composer\n          \n        \n        \n          \n            wordpress\n          \n        \n        \n          \n            php\n          \n        \n    \n\n\n\n\n  \n      \n        \n          jonaskroeger\n          \n        \n\n        \n            \n            \n              March 24, 2020, 12:32pm\n            \n        #1\n        \n      \n      \n        Goal\nAdd external plugins or themes from the official directory to your Wordpress installation using composer.\nAssumptions\n\nA WordPress installation on Platform.sh that uses Composer, for example one that uses the WordPress Template.\nAn SSH key configured on the project account\n\nComposer installed locally\n\nProblems\nSince Platform.sh deploys the code read-only (and thus makes many Wordpress sites more secure by default), the integrated mechanism to add and update both plugins and themes doesn\u2019t work.\nLuckily, wpackagist.org mirrors the WordPress plugin and theme directories as a Composer repository. This means you can add all plugins and themes covered by the directory using composer.\nSteps\n1. Add the external repository\nEdit your composer.json file and add wpackagist as a repository.\n\"repositories\":[\n\t{\n\t    \"type\":\"composer\",\n\t    \"url\":\"https://wpackagist.org\"\n\t}\n],\n\n2. Add a plugin or theme via composer\nYou can use composer require to add a plugin or a theme as a dependency. For plugins, use wpackagist-plugin as the vendor name, for themes use wpackagist-theme.\nExamples:\nPlugin: composer require wpackagist-plugin/cache-control\nTheme: composer require wpackagist-theme/neve\nComposer will update your composer.json and composer.lock files accordingly.\n3. Push to your repository\nBy pushing those changes to Platform.sh, the build process will automatically install the themes and plugins in the right folder.\ngit add composer.json composer.lock\ngit commit -m 'adding themes/plugins'\ngit push\n\n4. Enable plugins/themes in the WP-Admin Dashboard\nThe admin interface will show the plugins/themes and will allow you to enable them directly via the interface.\n\nScreenshot 2020-03-24 13.06.57.jpg1792\u00d71086 242 KB\n\n\nScreenshot 2020-03-24 13.09.05.jpg1792\u00d71086 283 KB\n\nConclusion\nBy using composer to install 3rd party plugins and themes, you get a reliable build process and make sure the code is deployed safely. This avoids committing plugins and themes into your git repository.\nIt also makes it easy to keep plugins and themes up to date. You can follow this guide on how to keep your Wordpress site updated.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to migrate your Java Application from Heroku to Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-migrate-your-java-application-from-heroku-to-platform-sh/441", "documentId": "17662e3900d1f0f4707310c0b0c779b0d8c21953", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to migrate your Java Application from Heroku to Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            java\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n            \n              April 15, 2020,  1:41pm\n            \n        #1\n        \n      \n      \n        Goal\nMigrate a Heroku Java Application to a Platform.sh service.\nAssumptions\nYou will need:\n\nan active application on Platform.sh configured to an empty database\nan active application on Heroku\n\nSteps\n1. Git clone the Heroku Repository\ngit clone heroku_repository.git\n\n2. Create the three basic Platform.sh file\n\n\n.platform/routes.yaml : Platform.sh allows you to define the routes.\n\n.platform/services.yaml: Platform.sh allows you to completely define and configure the topology and services you want to use on your project.\n\n.platform.app.yaml: You control your application and the way it will be built and deployed on Platform.sh via a single configuration file.\n\n3. Set the Application File\nAt the .platform.app.yaml we\u2019ll set the minimum configuration to run a plain configuration be aware that it does not include database services such as MySQL, MariaDB and so on.\n# This file describes an application. You can have multiple applications\n# in the same project.\n#\n# See https://docs.platform.sh/user_guide/reference/platform-app-yaml.html\n# The name of this app. Must be unique within a project.\nname: app\n\n# The runtime the application uses.\ntype: 'java:8'\n\ndisk: 1024\n\n# The hooks executed at various points in the lifecycle of the application.\nhooks:\n    build: mvn clean install\n\nmounts:\n    'server/':\n        source: local\n        source_path: server_source\n\n# The relationships of the application with services or other applications.\n#\n# The left-hand side is the name of the relationship as it will be exposed\n# to the application in the PLATFORM_RELATIONSHIPS variable. The right-hand\n# side is in the form `&lt;service name&gt;:&lt;endpoint name&gt;`.\n\n# The configuration of app when it is exposed to the web.\nweb:\n    commands:\n        start: |\n            cp target/dependency/webapp-runner.jar server/webapp-runner.jar\n            cp target/tomcat.war server/tomcat.war\n            cd server &amp;&amp; java -jar -Xmx$(jq .info.limits.memory /run/config.json)m -XX:+ExitOnOutOfMemoryError webapp-runner.jar --port $PORT tomcat.war\n\n4. Add Platform.sh Remote Repository\ngit remote add platform platform_repository.git\n\n5. Push the changes to the Repository\ngit push platform master\n\nConclusion\nBy adding a .platform.app.yaml file to a project,  a Java application\u2019s build process can be migrated from Heroku. In order to fully migrate, the next step is to use the Heroku CLI to dump your database and import it to a service defined on your Platform.sh project.\nAdditional resources:\n\nHow to migrate a PostgreSQL database from Heroku to Platform.sh\nSample App\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    How to Migrate my Java Application to Platfrom.sh\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to deploy Nextcloud to Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-deploy-nextcloud-to-platform-sh/504", "documentId": "966b584dff46e893c8c6484892f3a9eb80c27bf8", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to deploy Nextcloud to Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          robert\n          \n        \n\n        \n            \n            \n              March 19, 2020, 12:32pm\n            \n        #1\n        \n      \n      \n        Goal\nNextcloud is a full, self-hosted alternative to tools such as G Suite or Microsoft 360. It includes a wide range of features, such as file management and sharing, calendars, document editing, voice and video conferencing, chat, and more. This how-to guide will show a basic Nextcloud installation on Platform.sh.\nAssumptions\nYou will need:\n\nAn SSH key configured on your Platform.sh account\nThe Platform.sh CLI tool installed.\n\nSteps\n\nCreate a new Platform.sh project\nInstall Nextcloud from the CLI\nLog into Nextcloud\nSet up integrations\n\n1. Create a new project\nYou can create a new project using the Platform.sh CLI tool:\nplatform create\n\nAfter following the instructions, you will get a confirmation that a new project has been created. Copy the new project ID.\n2. Initialize your project with your new project ID\nReplace &lt;PROJECT ID&gt; with the ID from the previous step and execute this command:\nplatform environment:init -p &lt;PROJECT ID&gt; -e master https://github.com/platformsh-templates/nextcloud\n\n3. Log into Nextcloud\nThe username and password for the administration account were created for you during deployment, and can be viewed in the deploy log:\nplatform log deploy -p &lt;PROJECT ID&gt;\nUsing the URL from Step 1, and the credentials listed in the logs, visit your new Nextcloud installation to complete the setup.\n4. Set up integrations\nDepending on how you intend to use Nextcloud, you will want to enhance the basic installation with some integrations. Common integrations that will give Nextcloud full functionality include:\n\nIMAP server for sending mail\n\n\nFile storage (eg. Dropbox, S3, SFTP) for enabling file exchange\n\nCollabra Online or ONLYOFFICE integration for collaborative document editing\n\nConclusion\nThe basic installation of Nextcloud on Platform.sh is straightforward using the CLI and the provided template. Nextcloud users will still need to look after some integrations before the full potential of Nextcloud is available.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to overwrite Spring Data MongodB variable to access Platform.sh services", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-overwrite-spring-data-mongodb-variable-to-access-platform-sh-services/528", "documentId": "7d8ddac2786e6d6cd16212f43143cfd7817b6690", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to overwrite Spring Data MongodB variable to access Platform.sh services\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            java\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n            \n              April 15, 2020,  1:43pm\n            \n        #1\n        \n      \n      \n        Goal\nIn this tutorial, we\u2019ll cover how you can overwrite Spring  Data MongoDB configurations to access the services in Platform.sh.\nPreparation\nThis tutorial assumes you have\n\n\nA working Spring Data MongoDB application with Java 8 or higher\n\n\nA text editor of your choice.\n\n\nProblems\nPlatform.sh has a Java configuration-reader that provides a streamlined and easy to use way to interact with a Platform.sh environment and its services. However, you can also use the application regularly and overwrite those configurations when you deploy your application on Platform.sh. That is useful when you either already have one app and want to move to Platform.sh or keep the default configuration to run locally.\nSteps\nTo keep the configurations Spring has, by default, the application.properties file where you can set the settings that you wish on your application. Furthermore, those settings can be overwritten as external configuration.\nGive a Spring Data MongoDB application that you\u2019re running locally with either an empty or non applications.properties file:\nYou can overwrite those configurations on the platform.app.yaml the application configuration to Platform.sh. As shown in the configuration below.\nname: app\ntype: \"java:11\"\ndisk: 1024\n\nhooks:\n    build: mvn clean install\n\nrelationships:\n  database: 'mongodb:mongodb'\n\n# The configuration of app when it is exposed to the web.\nweb:\n    commands:\n        start:  |\n           export USER=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".database[0].username\"`\n           export PASSWORD=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".database[0].password\"`\n           export HOST=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".database[0].host\"`\n           export DATABASE=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".database[0].path\"`\n           java -jar -Xmx$(jq .info.limits.memory /run/config.json)m -XX:+ExitOnOutOfMemoryError \\\n           -Dspring.data.mongodb.database=$DATABASE \\\n           -Dspring.data.mongodb.host=$HOST \\\n           -Dspring.data.mongodb.username=$USER \\\n           -Dspring.data.mongodb.password=$PASSWORD \\\n            target/spring-boot.jar --server.port=$PORT\n\n\n\nTherefore, you can have the configuration or just migrate the application that already exists to Platform.sh.\nReferences\n\nSpring\nSpring Data MongoDB\nSpring Properties\nSpring Externalized Configuration\nSpring with Platform.sh Configuration Reader\nSource code\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    How to Migrate my Java Application to Platfrom.sh\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to set up Wordpress to use the HTTP cache of Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-set-up-wordpress-to-use-the-http-cache-of-platform-sh/508", "documentId": "65c50777f142c379db76434a25cdd6ef4de1ab78", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to set up Wordpress to use the HTTP cache of Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            wordpress\n          \n        \n        \n          \n            cache\n          \n        \n        \n          \n            php\n          \n        \n    \n\n\n\n\n  \n      \n        \n          jonaskroeger\n          \n        \n\n        \n            \n              March 24, 2020,  4:17pm\n            \n        #1\n        \n      \n      \n        Goal\nConfigure Wordpress to send proper cache-control headers, so the HTTP cache can be used.\nAssumptions\n\nA WordPress installation on Platform.sh that uses Composer, for example one that uses the WordPress Template and is configured for a composer-based installation of plugins\n\nAn SSH key configured on the project account\n\nComposer installed locally\n\nProblems\nBy default, Wordpress doesn\u2019t set proper headers to allow the build-in HTTP cache to work efficiently.\nYou can test if your site is cached based on the x-platform-cache response header which will probably be a MISS with the default Wordpress installation.\nSteps\n1. Install and enable the cache-control plugin\nThe main configuration that the HTTP cache needs to work properly, is Cache-Control header. Since Wordpress does not include an option to set those headers in their core, you need to use a 3rd party plugin. The example used here is cache-control.\nIf you have set up your project to use a composer-based installation of plugins (see here on how to do this), you can use composer require wpackagist-plugin/cache-control locally to update your composer files.\nAfter that commit and push them so the plugin gets deployed to your project. In the Admin-Dashboard go to Plugins, find Cache-Control and click Activate.\n2. Verify and adjust the header values\nIn the plugin settings, you can adjust the time different sites is being cached (e.g home page, post sites, etc). You can adjust that as necessary, following good practises.\n\nScreenshot 2020-03-24 16.52.31.jpg1792\u00d71086 230 KB\n\n3. Settings for static assets\nFor static assets, the Wordpress template includes a default Cache-Control of 600 in your .platform.app.yaml file. To adjust that (if needed), you find the expires setting in the location block.\n4. Verify your site is being cached\nTo check if the response is cached, you can use curl -I to retrieve the headers. While the first response might be a MISS (because the page has not been cached yet), as soon as you send the same request again, it should return HIT.\ncurl -I https://master-7rqtwti-af6kbo7ndasc2.eu-3.platformsh.site/\nHTTP/2 200\ncache-control: max-age=300\n\u2026\nx-platform-cache: HIT\n\u2026\n\nConclusion\nWith this setup, your Wordpress site can leverage the Platform.sh HTTP Cache and you have control over the caching behaviour for different parts of your Wordpress site.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to Configure your Java Application with Log4J at Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-configure-your-java-application-with-log4j-at-platform-sh/514", "documentId": "d3d0835add9bf4cd062b1e68dba0290ffacdc210", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to Configure your Java Application with Log4J at Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            java\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n            \n              April 15, 2020,  1:43pm\n            \n        #1\n        \n      \n      \n        Goal\nIn this tutorial, we\u2019ll cover the how and why to use log in your application using Log4J  Platform.sh.\nPreparation\nThis tutorial assumes you have\n\nA working Java 8 application already deployed on Platform.sh.\n\n\nA text editor of your choice.\n\nProblems\nLogging is the process of writing log messages during the execution of a program to a central place. This logging allows you to report and persist error and warning messages as well as info messages (e.g., runtime statistics) so that the messages can later be retrieved and analyzed.\nSteps\n1.  Platform.sh log file\nIn Platform.sh we have two options to log your Java application.\nThe first one is to use the stdout where Platform.sh will handle the folder it includes to avoid the oversized in the disk issue.\nThis log will be at the /var/log/app.log:\nhttps://docs.platform.sh/development/logs.html\nIn your log4j.properties you can set it, e.g.:\nlog4j.appender.stdout=org.apache.log4j.ConsoleAppender\nlog4j.appender.stdout.Target=System.out\nlog4j.appender.stdout.layout=org.apache.log4j.PatternLayout\nlog4j.appender.stdout.layout.ConversionPattern=%d{yyyy-MM-dd HH:mm:ss} %-5p %c{1}:%L - %m%n\n\nAll log files are trimmed to 100 MB automatically. But if you need to have complete logs, you can set up cron which will upload them to third-party storage. Contextual Code made a simple and well-described example how to achieve it.\n2.  The custom log folder\nThe second option is to create a new mount directory and then use it to handle your logs. The advantage is that we can create multiple records as you wish; however, you will then be responsible for purging old log files to avoid filling up the disk.\nIn your log4j.properties you can set, e.g.:\nlog4j.rootLogger=DEBUG, R\nlog4j.appender.R=org.apache.log4j.RollingFileAppender\nlog4j.appender.R.MaxFileSize=1MB\nlog4j.appender.R.MaxBackupIndex=20\nlog4j.appender.R.File=/app/log/app.log\nlog4j.appender.R.Append=true\nlog4j.appender.R.DatePattern='.'yyyy-MM-dd'.log'\nlog4j.appender.R.layout=org.apache.log4j.PatternLayout\nlog4j.appender.R.layout.ConversionPattern=%d{MM/dd/yyyy HH:mm:ss,SSS} %-5p %c - %m%n\n\nThis time we need to create a mount folder to create your log, so we need to go in the application description file to define a writable folder to the log.\nmounts:\n    'log/':\n        source: local\n        source_path: log_source\n\nCommit the changes and push to redeploy.\nReferences\n\nLogging With Log4j in Java\nJava Logging API - Tutorial\nJava Platform.sh Documentation\nPlatform.sh Logs\n\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to overwrite configuration to Jakarta/MicroProfile to access Platform.sh services", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-overwrite-configuration-to-jakarta-microprofile-to-access-platform-sh-services/520", "documentId": "68c35a59a80f7bff58417e55f90e61e5da7589e2", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to overwrite configuration to Jakarta/MicroProfile to access Platform.sh services\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            java\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n            \n              April 15, 2020,  1:43pm\n            \n        #1\n        \n      \n      \n        Goal\nIn this tutorial, we\u2019ll cover how you can overwrite Jakarta EE/MicroProfile configurations to access the services in Platform.sh.\nPreparation\nThis tutorial assumes you have:\n\nA working Jakarta EE/MicroProfile application with Java 8 or higher\nA text editor of your choice.\n\nProblems\nPlatform.sh has a Java configuration-reader library that provides a streamlined and easy to interact with a Platform.sh environment and its services. However, you can also use the application regularly and overwrite those configurations when you deploy your application on Platform.sh. That is useful when you either already have one app and want to move to Platform.sh or keep the default configuration to run locally.\nSteps\nFor MicroProfile/Jakarta EE the configurations and settings are set by MicroProfile Configuration. It is as a convention and not as standard, which by default it uses the microprofile-config.properties file where you can set the settings and overwrite it. To have a Jakarta NoSQL application that connects a MongoDB database locally, the configuration will be like this:\ndocument=document\ndocument.database=conferences\ndocument.settings.jakarta.nosql.host=localhost:27017\ndocument.provider=org.eclipse.jnosql.diana.mongodb.document.MongoDBDocumentConfiguration\n\nYou can overwrite those configurations in platform.app.yaml, the application configuration file for Platform.sh:\nname: app\ntype: \"java:8\"\ndisk: 800\n\nhooks:\n  build: mvn -U -DskipTests clean package payara-micro:bundle\nrelationships:\n  mongodb: 'mongodb:mongodb'\n\nweb:\n  commands:\n    start: |\n      export MONGO_PORT=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".mongodb[0].port\"`\n      export MONGO_HOST=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".mongodb[0].host\"`\n      export MONGO_ADDRESS=\"${MONGO_HOST}:${MONGO_PORT}\"\n      export MONGO_PASSWORD=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".mongodb[0].password\"`\n      export MONGO_USER=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".mongodb[0].username\"`\n      export MONGO_DATABASE=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".mongodb[0].path\"`\n      java -jar -Xmx$(jq .info.limits.memory /run/config.json)m -XX:+ExitOnOutOfMemoryError -Ddocument.settings.jakarta.nosql.host=$MONGO_ADDRESS \\\n      -Ddocument.database=$MONGO_DATABASE -Ddocument.settings.jakarta.nosql.user=$MONGO_USER \\\n      -Ddocument.settings.jakarta.nosql.password=$MONGO_PASSWORD \\\n      -Ddocument.settings.mongodb.authentication.source=$MONGO_DATABASE \\\n      target/heroes-microbundle.jar --port $PORT\n\nTherefore, you can have the configuration or just migrate the application that already exists to Platform.sh.\nReferences\n\nJakarta EE\nMicroProfile\nMicroProfile Configuration\nJNoSQL\nPayara with Platform.sh Configuration Reader\nSource code\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to Overwrite Spring Data variable to access Platform.sh services", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-overwrite-spring-data-variable-to-access-platform-sh-services/518", "documentId": "1b2ec64e01dc2b33887aeeec77befbaf7217b440", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to Overwrite Spring Data variable to access Platform.sh services\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            java\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n            \n              April 15, 2020,  1:47pm\n            \n        #1\n        \n      \n      \n        Goal\nIn this tutorial, we\u2019ll cover how you can overwrite Spring configurations to access the services in Platform.sh.\nPreparation\nThis tutorial assumes you have\n\n\nA working Spring application with Java 8 or higher\n\n\nA text editor of your choice.\n\n\nProblems\nPlatform.sh has a Java configuration-reader library that provides a streamlined and easy to interact with a Platform.sh environment and its services. However, you can also use the application regularly and overwrite those configurations when you deploy your application on Platform.sh. That is useful when you either already have one app and want to move to Platform.sh or keep the default configuration to run locally.\nSteps\nTo keep the configurations Spring has by default, the application.properties file is where you can set the settings that you wish on your application. Furthermore, those settings can be overwritten as external configuration.\nE.g.: Give a Spring Data JPA application that you\u2019re running locally PostgreSQL with those properties on the applications.properties:\n## default connection pool\nspring.datasource.hikari.connectionTimeout=20000\nspring.datasource.hikari.maximumPoolSize=5  \n## PostgreSQL\nspring.datasource.url=jdbc:postgresql://localhost:5432/people\nspring.datasource.username=postgres\nspring.datasource.password=password\nspring.jpa.hibernate.ddl-auto=update\n\n\nYou can overwrite those configurations on the platform.app.yaml, the application configuration file for Platform.sh:\nname: app\ntype: \"java:11\"\ndisk: 1024\nhooks:\n    build: mvn clean install\nrelationships:\n    database: \"dbpostgres:postgresql\"\nweb:\n    commands:\n        start:  |\n           export DB_PORT=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".database[0].port\"`\n           export USER=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".database[0].username\"`\n           export PASSWORD=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".database[0].password\"`\n           export HOST=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".database[0].host\"`\n           export DATABASE=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".database[0].path\"`\n           export URL=\"jdbc:postgresql://${HOST}:${DB_PORT}/${DATABASE}\"\n           java -jar -Xmx$(jq .info.limits.memory /run/config.json)m -XX:+ExitOnOutOfMemoryError  \\\n           -Dspring.datasource.url=$URL \\\n           -Dspring.datasource.username=$USER \\\n           -Dspring.datasource.password=$PASSWORD \\\n           target/spring-boot.jar --server.port=$PORT\n\nTherefore, you can have the configuration or just migrate the application that already exists to Platform.sh.\nReferences\n\nSpring\nSpring Properties\nSpring Externalized Configuration\nSpring with Platform.sh Configuration Reader\nSource code\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    How to Migrate my Java Application to Platfrom.sh\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to Overwrite variables to Payara JPA access Platform.sh SQL services", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-overwrite-variables-to-payara-jpa-access-platform-sh-sql-services/519", "documentId": "dbed0734633a250c09220950fb3f2b24d4dbb7a7", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to Overwrite variables to Payara JPA access Platform.sh SQL services\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            java\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n            \n              April 15, 2020,  1:43pm\n            \n        #1\n        \n      \n      \n        Goal\nIn this tutorial, we\u2019ll cover how you can overwrite Payara configurations to access the services in Platform.sh.\nPreparation\nThis tutorial assumes you have\n\nA working Payara application with Java 8 or higher\nA text editor of your choice.\n\nProblems\nPlatform.sh has a Java configuration-reader library that provides a streamlined and easy to use way to interact with a Platform.sh environment and those services. However, you can also use the application regularly and overwrite those configurations when you deploy your application on Platform.sh. That is useful when you either already have one app and want to move to Platform.sh or keep the default configuration to run locally.\nSteps\nFirst, to use a database as a data source in Payara Micro, you\u2019ll need to have the database already running. Once you have that in place, download the JDBC driver for the database and put it into your WEB-INF/lib directory.\nIn your web.xml add the following:\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;web-app version=\"4.0\" xmlns=\"http://xmlns.jcp.org/xml/ns/javaee\"  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd\"&gt;\n    &lt;data-source&gt;\n        &lt;name&gt;java:global/JPAExampleDataSource&lt;/name&gt;\n        &lt;class-name&gt;org.postgresql.ds.PGSimpleDataSource&lt;/class-name&gt;\n        &lt;server-name&gt;${server.host}&lt;/server-name&gt;\n        &lt;port-number&gt;5432&lt;/port-number&gt;\n        &lt;database-name&gt;${server.database}&lt;/database-name&gt;\n        &lt;user&gt;${server.user}&lt;/user&gt;\n        &lt;password&gt;${server.password}&lt;/password&gt;\n    &lt;/data-source&gt;\n&lt;/web-app&gt;\n\nYou can overwrite those configurations on the platform.app.yaml the application configuration to Platform.sh. As shown in the configuration below.\nname: app\ntype: \"java:8\"\ndisk: 1024\nhooks:\n    build: mvn clean package payara-micro:bundle\nrelationships:\n    database: \"db:postgresql\"\nweb:\n    commands:\n        start: |\n          export HOST=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".database[0].host\"`\n          export PASSWORD=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".database[0].password\"`\n          export USER=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".database[0].username\"`\n          export DATABASE=`echo $PLATFORM_RELATIONSHIPS|base64 -d|jq -r \".database[0].path\"`\n          java -jar -Xmx$(jq .info.limits.memory /run/config.json)m -XX:+ExitOnOutOfMemoryError  \\\n          -Dserver.host=$HOST \\\n          -Dserver.database=$DATABASE \\\n          -Dserver.user=$USER \\\n          -Dserver.password=$PASSWORD \\\n          target/microprofile-microbundle.jar --port $PORT\n\nTherefore, you can have the configuration or just migrate the application that already exists to Platform.sh.\nReferences\n\nPayara\nData Source Example\nSetting Up a Data Source in Payara Micro\nPayara with Platform.sh Configuration Reader\nSource code\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    How to Migrate my Java Application to Platfrom.sh\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to Migrate your Java 8 application to Java 11 on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-migrate-your-java-8-application-to-java-11-on-platform-sh/499", "documentId": "953e0f6c54c580f2d080b0f72c2dd216ccf04341", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to Migrate your Java 8 application to Java 11 on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            java\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n            \n              April 15, 2020,  1:44pm\n            \n        #1\n        \n      \n      \n        Goal\nIn this tutorial, we\u2019ll cover the how and why of upgrading a Java 8 project to Java 11 on Platform.sh.\nPreparation\nThis tutorial assumes you have\n\nA working Java 8 application already deployed on Platform.sh.\nA text editor of your choice.\n\nProblems\nJava 8, the old Java LTS release, is no longer maintained.  As an unmaintained version it will no longer receive security fixes, and so over time there will be more and more known-but-unfixed security issues found with it.\nJava 11 is the new LTS release, and is both more secure and more performant.   Leonardo Zanivan\u2019s blog covers the major new features, including:\n\nNext LTS version\nFull support for containers\nSupport parallel full garbage collection on G1.\nFree Application Class-Data Sharing feature.\nHeap allocation on alternative memory devices.\nNew default set of root authority certificates.\nNew ZGC and Epsilon garbage collectors.\nAhead-of-time compilation and GraalVM.\nTransport Layer Security (TLS) 1.3.\nCompact Strings\nMake G1 the Default Garbage Collector\n\nSeveral benchmarks on the JVM improvements show an improvement of around 20%. Furthermore, code written for Java 8 doesn\u2019t need to be updated to run on the Java 11 JVM, but still sees improvements in both memory usage and boot up time.\nTo keep your code working you need to be aware of JEP 320: Remove the Java EE and CORBA Modules. If you are using those modules you\u2019ll need to re-add them in your dependency management tool. See this blog post for general migration tips.\nSteps\nTo update the application, you need to update a single file: the .platform.app.yaml file.  On a development branch (not production), find the type property:\nname: app\ntype: \"java:8\"\n\n\nUpdate this line to Java 11:\nname: app\ntype: \"java:11\"\n\n\nCommit the changes and push.\nPlatform.sh will then build a new container using Java 11 instead of Java 8.  The new version will be used for both the build process (compilation) and the running environment.\nOnce you\u2019re satisfied that the update is safe to complete, merge this new branch to master and push.\nReferences\nJava Platform.sh Documentation\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Latest Tutorials topics", "section": "Platform.sh Community", "url": "https://community.platform.sh/c/tutorial?page=1", "documentId": "cdfdf72f962a432d464eec97d9edc3c65fa607d2", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n\n\n\n  \n\n    \n      Tutorials\n  \n  \n\n\n\n  \n\n    \n      \n        Topic\n        Replies\n        Activity\n      \n    \n\n    \n      \n    \n\n  \n\n\n\n \n\n\n\n  \n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Improving GraphQL performance by caching POST requests", "section": "How-to Guides", "url": "https://community.platform.sh/t/improving-graphql-performance-by-caching-post-requests/530", "documentId": "1d7af0000ec733229c4e2eff4856fa9b39f925d2", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Improving GraphQL performance by caching POST requests\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            fastly\n          \n        \n        \n          \n            graphql\n          \n        \n        \n          \n            cdn\n          \n        \n    \n\n\n\n\n  \n      \n        \n          yuriy-babenko\n          \n        \n\n        \n            \n              April 15, 2020,  4:22pm\n            \n        #1\n        \n      \n      \n        At Platform.sh we recently came across a project that utilized GraphQL to pull in data for its front-end, but was experiencing performance issues with slow GraphQL queries. We found a way to conveniently cache those query results and greatly speed up the project as a result.\nQueries to GraphQL are normally done as POST requests, and caching the results of POST requests is typically bad practice. In our use case, some queries are taking upwards of 5s to execute, which results in a rather poor user experience. Combining caching with a short TTL, (say, 60 seconds) the slightly-outdated content is preferable to an incredibly slow user experience.\nWe start at Fastly, and create a custom CDN endpoint to the GraphQL URI. This passes all requests (to that new endpoint) through the Fastly service, which uses Varnish to cache requests.\nFastly allows the user to upload a custom VCL, using the boilerplate VCL as a starting point. The only change we need to make is to ensure that POST requests are treated in the same manner as GET requests. This results in two small changes:\nThe block\nif (req.method != \"HEAD\" &amp;&amp; req.method != \"GET\" &amp;&amp; req.method != \"FASTLYPURGE\") {\n    return(pass);\n}\n\n\u2026 should be changed to:\nif (req.method != \"HEAD\" &amp;&amp; req.method != \"GET\" &amp;&amp; req.method != \"POST\" &amp;&amp; req.method != \"FASTLYPURGE\") {\n    return(pass);\n}\n\nAnd similarly, the block\nif ((beresp.status == 500 || beresp.status == 503) &amp;&amp; req.restarts &lt; 1 &amp;&amp; (req.method == \"GET\" || req.method == \"HEAD\")) {\n    restart;\n}\n\n\u2026 changes to:\nif ((beresp.status == 500 || beresp.status == 503) &amp;&amp; req.restarts &lt; 1 &amp;&amp; (req.method == \"GET\" || req.method == \"HEAD\" || req.method == \"POST\")) {\n    restart;\n}\n\nThese changes will allow POST requests to be cached. However, you\u2019ll note that\nnow all POST requests to GraphQL will return the same data, regardless of the\nquery. This happens because the default cache_key, which is based on the\nrequest URL (req.url) and some headers (req.http.Host,\nreq.http.Authorization, req.http.Fastly-SSL) remains consistent between the\ndifferent query requests, and Fastly (correctly) returns the existing, cached\ndata for that key.\nWhat we need, then, is a cache_key that will change between different\nqueries.\nThe simplest way of accomplishing this is by adding the request body\n(ie. the query) to the cache_key. This can be done by simply adding req.body\nto the cache_key in Fastly\u2019s settings.\nHowever, the request body will be fairly long, and using such long strings in\nthe cache_key is not ideal. Further, Fastly documentation for req.body\nmentions that only the first 8kb of the body are available in the req.body\nvariable. This means that two different queries with identical content in the\nfirst 8kb of the body may end up with the same cache_key.\nA better solution would be to generate a hash from the request body, include\nthat hash as a custom header in the POST request, and then use the custom\nheader to create the cache_key.\nFor example, if you were to include the hash in a header called body-hash,\nyou could then add req.http.body-hash to the cache_key, and each unique\nPOST request would return the correct data for that request, while also\ncaching the GraphQL response for as long as your configured TTL.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Latest How-to Guides topics", "section": "Platform.sh Community", "url": "https://community.platform.sh/c/how-to?page=1", "documentId": "e28c3f74d3590ed4f8256928a7a8f2312ec9379b", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n\n\n\n  \n\n    \n      How-to Guides\n  \n  \n\n\n\n  \n\n    \n      \n        Topic\n        Replies\n        Activity\n      \n    \n\n    \n      \n        \n          \n            \n            \n            \n            \n              How to back up environment variables\n            \n          \n          \n            1\n          \n          \n            December 11, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to use cmake in a Platform.sh build hook\n            \n          \n          \n            1\n          \n          \n            November 20, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How do I check the disk usage for elastic search?\n            \n          \n          \n            2\n          \n          \n            November 15, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to reset a project's code and data\n            \n          \n          \n            1\n          \n          \n            August 26, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to deploy a Vue.js Single Page Application (SPA) with a Golang API on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 25, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to transfer files between two different projects\n            \n          \n          \n            3\n          \n          \n            August 13, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to export database table data to a CSV file with platform-cli\n            \n          \n          \n            1\n          \n          \n            August 8, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to serve a static HTML page on Platform.sh\n            \n          \n          \n            2\n          \n          \n            August 2, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to automatically update Composer dependencies with Source Operations\n            \n          \n          \n            2\n          \n          \n            July 29, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to generate PDFs using Puppeteer and Headless Chrome\n            \n          \n          \n            1\n          \n          \n            June 5, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to set up and deploy a Ruby on Rails application on Platform.sh\n            \n          \n          \n            2\n          \n          \n            June 18, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to enable commandline autocomplete support for the `platform` CLI tool\n            \n          \n          \n            2\n          \n          \n            June 13, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to take screenshots using Puppeteer and Headless Chrome\n            \n          \n          \n            1\n          \n          \n            June 5, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to modify my Platform.sh project plan and its resources\n            \n          \n          \n            1\n          \n          \n            March 13, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to sync database backups to Amazon S3\n            \n          \n          \n            1\n          \n          \n            May 29, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to migrate a PostgreSQL database from Heroku to Platform.sh\n            \n          \n          \n            1\n          \n          \n            June 4, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to configure caching for static assets\n            \n          \n          \n            1\n          \n          \n            April 2, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How do I install Apache Tika with Solr\n            \n          \n          \n            2\n          \n          \n            May 24, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to develop locally on Platform.sh with a tethered connection\n            \n          \n          \n            1\n          \n          \n            March 8, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to create and restore snapshots using the CLI\n            \n          \n          \n            1\n          \n          \n            March 11, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to access Elasticsearch credentials on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 14, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to access Solr credentials on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 14, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to access RabbitMQ credentials on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 14, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to interactively debug Python applications on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 19, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to derive metrics from access log via ngxtop\n            \n          \n          \n            1\n          \n          \n            March 12, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to forward Platform.sh logs to Logz.io\n            \n          \n          \n            1\n          \n          \n            April 8, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to forward Platform.sh logs to a Splunk Indexer\n            \n          \n          \n            1\n          \n          \n            April 8, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to run R Shiny on Platform.sh\n            \n          \n          \n            1\n          \n          \n            April 29, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to run an Anaconda/Miniconda Python stack on Platform.sh\n            \n          \n          \n            3\n          \n          \n            April 30, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to access Memcached credentials on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 14, 2019\n          \n        \n    \n\n  \n\n\n  \n      \u2190 previous page \u00a0\n    next page \u2192\n  \n\n\n \n\n\n\n  \n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Installing Drupal and Mautic together in one project", "section": "Tutorials", "url": "https://community.platform.sh/t/installing-drupal-and-mautic-together-in-one-project/412", "documentId": "cb35d0f5b1ff75133d98a481c8feb0a3fe49ec12", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Installing Drupal and Mautic together in one project\n\n\n\n    \n      \n        \n        Tutorials\n      \n    \n\n\n    \n        \n          \n            drupal\n          \n        \n        \n          \n            multiapp\n          \n        \n        \n          \n            mautic\n          \n        \n        \n          \n            php\n          \n        \n    \n\n\n\n\n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n            \n              November 25, 2019,  9:57pm\n            \n        #1\n        \n      \n      \n        Goal\nTo set up a multi-app site with both Drupal 8 and Mautic.  The process is also very similar for any other site that combines two templates.\nPreparation\nYou will need:\n\nA new project with no code.  You will need at least a Medium plan to go live, but you can start with a Dev plan for setup.  You will need a Medium plan and a domain configured before the Drupal Mautic module can be configured, however.\nA local working Git client and Composer.\n\nProblems\nDrupal needs a Mautic site URL in order to connect to it.  It will do so over HTTP, not through a backend connection.  That means the domain name will be different on every branch.  Generally you would only care about Mautic tracking on production anyway, so that is not a major issue.\nSteps\n1. Download the Drupal 8 template\nThe Platform.sh Drupal 8 template is available on GitHub.  Clone it to your local computer, then remove the .git directory to reset the repository.\n# Download Drupal 8\ngit clone https://github.com/platformsh-templates/drupal8.git d8-mautic\n# Remove the git repository itself.\ncd d8-mautic\nrm -rf .git\n\nResetting the repository is technically optional, but the existing history is useless for you and as you will be moving a lot of files around it\u2019s easier to not deal with Git at this point.\n2. Move Drupal to a subdirectory\nMake a new directory named drupal and move all of the existing files into it, except for the .platform subdirectory.  Make sure to include the various other dot files.\nmkdir drupal\nmv * drupal\nmv .platform.app.yaml .env* .editorconfig .gitattributes .gitignore drupal\n\n3. Add Mautic\nDownload the Mautic template into the project directory and remove its .git repository as well.\n# Download Mautic\n$ git clone https://github.com/platformsh-templates/mautic.git\n# Remove the git repository itself.\n$ cd mautic\n$ rm -rf .git\n\n4. Rename applications\nThe two applications will need unique names, such as drupal and mautic.  (You may use other names if you wish.)  Change the name field in each application\u2019s .platform.app.yaml file:\n# in drupal/.platform.app.yaml\nname: drupal\n\n# in mautic/.platform.app.yaml\nname: mautic\n\nNote: If you have an existing Drupal site you are modifying to include Mautic, do not rename that application.  Doing so will result in data loss.\n5. Update routes.yaml\n\nUpdate the .platform/routes.yaml file to supply different routes for each application.  The exact configuration will vary depending on your preferred domains.  For example, the following configuration will serve Drupal from www.YOURSITE.com and Mautic from mautic.YOURSITE.com:\n\"https://www.{default}/\":\n    type: upstream\n    upstream: \"drupal:http\"\n    cache:\n      enabled: true\n      cookies: ['/^SS?ESS/', '/^Drupal.visitor/']\n\n\"https://{default}/\":\n    type: redirect\n    to: \"https://www.{default}/\"\n\n\"https://mautic.{default}/\":\n  type: upstream\n  upstream: \"mautic:http\"\n  cache:\n    enabled: true\n\n6. Merge the services.yaml files\nAt this point, Drupal\u2019s original services.yaml is in .platform/services.yaml and Mautic\u2019s is in mautic/.platform/services.yaml.  The second will not be used so its content should be merged into the main one, and then it can be removed.\nBy default, Mautic and Drupal both use MariaDB; Drupal also uses Redis, and Mautic also uses RabbitMQ.  If you wish to add additional services you may do so.  The same MariaDB service can hold the database for both applications.  A typical configuration for running both applications would looks like this:\ndb:\n    type: mariadb:10.4\n    disk: 2048\n    configuration:\n        schemas:\n            - drupal\n            - mautic\n        endpoints:\n            drupal:\n                default_schema: drupal\n                privileges:\n                    drupal: admin\n            mautic:\n                default_schema: mautic\n                privileges:\n                    mautic: admin\n\ncache:\n    type: redis:5.0\n\nqueuerabbit:\n    type: rabbitmq:3.7\n    disk: 256\n\nThat includes the cache service from Drupal, the queuerabbit service from Mautic, and a single MariaDB 10.4 server to serve both databases.  It defines two databases, drupal and mautic, and then creates two separate endpoints of the same name that have full access to their respective databases only.\nNote: If you are adding Mautic to an existing Drupal site, you must name the Drupal database main and the Drupal endpoint mysql.  Doing otherwise will result in data loss.\nOnce that is done, remove the now-unused Mautic .platform directory.\nrm -rf mautic/.platform\n\n7. Update each application\u2019s relationships definition.\nIn drupal/.platform.app.yaml, change the database relationship to point to the drupal endpoint:\n# in drupal/.platform.app.yaml\nrelationships:\n    database: 'db:drupal'\n## Uncomment this line to enable Redis caching for Drupal.\n#    redis: 'cache:redis'\n\n# in mautic/.platform.app.yaml\nrelationships:\n    database: \"db:mautic\"\n    rabbitmqqueue: \"queuerabbit:rabbitmq\"\n\n8. Reduce disk usage OR increase plan size\nThe default templates for Drupal and Mautic, when combined, will ask for a total of about 6 GB of storage.  By default plans on Platform.sh start with 5 GB.  You may either increase the disk usage of your plan to a value higher than 6 GB, OR you can reduce the disk space requested by each application container.\nFor the latter, change the disk key in both .platform.app.yaml files to 1024:\ndisk: 1024\n\nThat will give each application 1 GB of disk space.  Both applications will share the disk space used for the database (2 GB in the example above).\n9. Add the Drupal Mautic module to the project\nInstall the drupal/mautic module in the Drupal instance, using Composer:\ncd drupal\ncomposer require drupal/mautic\n\nBecause of the way Composer works that will require downloading all dependencies, even though they will not be needed.  That\u2019s fine.  When it is done go back to the project directory:\ncd ..\n\n10. Commit and deploy\nInitialize a new Git repository and commit all of the files you\u2019ve created to it.\ngit init\ngit add .\ngit commit -m \"Add Drupal and Mautic.\"\n\nNext, set a Git remote for the empty Platform.sh project you have waiting for it, using the Platform.sh CLI.  You can find the exact command to copy and paste in the project\u2019s setup wizard.  Then push your code to the new remote.\nplatform project:set-remote YOUR_PROJECT_ID_HERE\ngit push -u platform master\n\nThe codebase will push to Platform.sh, and both applications will be built and deployed.\n11. Install both applications\nOnce the deploy is complete, run through the web installer for both applications.  The environment URL for each one will be visible in the CLI output as well as in the web console.\nConsult the README.md file for each application for steps that should be taken post-install.  They are not required for completing the integration but doing so will lead to a better experience for both applications.  You may also do any additional configuration desired for both applications either now or afterward.\n12. Enable and configure the Drupal module\nOnce logged into Drupal as the site administrator, go to /admin/modules and enable the Mautic module.\nOnce the module is enabled, go to the module\u2019s configuration page at /admin/config/system/mautic.  Check \u201cInclude Mautic Javascript Code\u201d.\nFor the Mautic URL, enter the domain name of your Mautic site followed by /mtc.js.  If you are on a development plan, it will be something similar to:\nhttps://mautic.master-t6dnbai-aqatptktdkxmi.us-2.platformsh.site/mtc.js\nIf you already have a domain name configured, it will be whatever the domain name is that Mautic is served from instead.\nClick \u201csave configuration\u201d.\nThe setup is now complete.  Browse to the Drupal home page and inspect the source code to locate the Mautic tracking Javascript code.\nConclusion\nIn this tutorial you have learned how to create a multi-application project on Platform.sh based on two separate application templates.  You\u2019ve also seen how to add a module to Drupal and configure it with Mautic.\nThe same basic process applies to any other two-template project, although the specific names and services will of course vary depending on the applications.\nExample\nAn example repository for this tutorial can be found on GitHub.  Note that it is not maintained and may include out of date versions by the time you read this.\n      \n\n      \n\n      \n         \n         \n         2 Likes\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Can I get FTP access to change my html pages?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/can-i-get-ftp-access-to-change-my-html-pages/246", "documentId": "80cbaf06aa40e2614c1a5a841ee8fd7184805fee", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Can I get FTP access to change my html pages?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          sawssen\n          \n        \n\n        \n            \n            \n              May 9, 2019,  9:25pm\n            \n        #1\n        \n      \n      \n        My developers are asking for an FTP access to update the html pages of my website. Can I get one?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              May 15, 2019,  4:49pm\n            \n        #2\n        \n      \n      \n        The file system on Platform.sh is read-only, by design.  That has two advantages:\n\nIt\u2019s more secure, as even a compromised application cannot modify application code.\nAll changes have an audit trail as they must go through Git updates.\n\nUpdates to files in the site should be pushed as new Git commits.  That will cause the environment to be rebuilt and redeployed.\nAny user with SSH access to the environment will also have SFTP (Secure FTP) access to read files, but will not be able to modify any file that was pushed through Git.\nPlain FTP is not available on any service whatsoever, as it is inherently insecure.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Compiling a Drupal site with Tome", "section": "Tutorials", "url": "https://community.platform.sh/t/compiling-a-drupal-site-with-tome/363", "documentId": "39c9378dfa299997a8316edc2740c42b4de0315c", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Compiling a Drupal site with Tome\n\n\n\n    \n      \n        \n        Tutorials\n      \n    \n\n\n    \n        \n          \n            drupal\n          \n        \n        \n          \n            multiapp\n          \n        \n        \n          \n            php\n          \n        \n    \n\n\n\n\n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n            \n              December 13, 2019,  9:02pm\n            \n        #1\n        \n      \n      \n        Goal\nTo demonstrate how a \u201ccompile to static\u201d tool, such as the Drupal Tome module, can be used on Platform.sh using multi-application configurations.\nPreparation\nThis tutorial will start from a basic Drupal 8 Composer site.  However, it will be easier to start from an empty Git repository.  It can be done from a Drupal 8 template site but that requires moving a number of hidden files and is therefore more prone to error.\nYou will need:\n\nA newly created empty site on Platform.sh.\nGit and SSH installed locally.\n\nProblems\nHow can you serve two closely related sites off of the same project?\nHow can static site generation work in production, rather than compiling locally or during build?\nSteps\n1. Create an empty working directory\nOn your local system, create an empty directory for your project and initialize it for Git.  Eg:\nmkdir project\ncd project\ngit init\n\n2. Download Drupal 8\nClone the Drupal 8 Platform.sh template into your project, then remove the git repository from it.\ngit clone https://github.com/platformsh-templates/drupal8.git drupal --depth=1\nrm -rf drupal/.git\n\nThat Git repository is what the Drupal 8 template in the new project wizard populates from.  The above commands are essentially what the new project wizard does, although it does not use a subdirectory.\n2. Move the .platform definition files to the repo root\nThe .platform directory must be in the repository root, so move it there:\nmv drupal/.platform .\n\nThe .platform.app.yaml file stays in the drupal directory so that the drupal directory becomes an application container itself.  That will let you create another directory for the static site.\n3. Add a network-storage service\nOpen .platform/services.yaml in your favorite text editor and add the following:\nfiles:\n    type: network-storage:1.0\n    disk: 512\n\nThat creates a new network-storage service named files.  Files there can be shared between the two application containers.\n4. Update Drupal mounts\nOpen drupal/.platform.app.yaml in your favorite text editor and update the mounts section to be as follows:\nmounts:\n    '/web/sites/default/files':\n        source: local\n        source_path: files\n    '/tmp':\n        source: local\n        source_path: tmp\n    '/private':\n        source: local\n        source_path: private\n    '/.drush':\n        source: local\n        source_path: drush\n    '/drush-backups':\n        source: local\n        source_path: drush-backups\n    '/.console':\n        source: local\n        source_path: console\n    '/content':\n        source: local\n        source_path: content\n    '/config':\n        source: local\n        source_path: config\n    '/static':\n        source: service\n        service: files\n        source_path: static\n\nMost of those are simply converting the normal Drupal mounts to the new-style mount syntax.  The most important are the final three paths.  Tome will automatically run a config-export every time configuration is exported, so the /config directory must be writeable.  It will also write out  a JSON version of all content as it is created and edited to /content.  The /static directory is where you\u2019ll instruct Tome to write out the static version of the site.\nOf particular note, the /static mount uses the network storage service, not the local file system.  That will make it available to other application containers.\n\nNote: Because these directories are writeable, they will not be tracked in Git.  That includes configuration exports, which will not be deployable via Git in this setup.\n\n5. Install Drupal Tome module\nRun:\ncd drupal\ncomposer require drupal/tome\n\nto add the Tome module.  (It\u2019s actually a suite of modules).  You\u2019ll enable it later once the code is deployed.  Once that\u2019s done return to the repository root directory:\ncd ..\n\n6. Set Tome export location\nModify the drupal/web/sites/default/settings.php file.  Add the following line at the location of your choice:\n$settings['tome_static_directory'] = '../static/html';\n\nThat will set the Tome export directory to the /static/html directory, which is inside the writeable mount you created above.  Because Tome completely removes the output directory before each rebuild it needs to be in a subdirectory of the mount.\n7. Disable allowed-host checking\nIn the drupal/web/sites/default/settings.platformsh.php file, look for a comment line that reads // Set trusted hosts based on Platform.sh routes.  The code block below that configures the hosts that Drupal is allowed to requests for.  Normally it is a security feature, however, on Platform.sh Professional the domain is already mangled by the router and will always be a \u201csafe\u201d domain.  That makes this code block unnecessary.  (It is included in the template only for Platform.sh Enterprise.)\nThe Tome module\u2019s export functionality, however, is incompatible with this code block as it will need to use the un-prefixed domain for the export.  It is safe to simply remove/comment out this entire block.  Alternatively, just comment out the last line that sets $settings['trusted_host_patterns'].\n8. Add a static site application to serve files\nCreate a new directory called static, and inside it create a .platform.app.yaml file.  Give it the following contents:\n# Note that this is different than what the Drupal site is called.\nname: 'static'\n\n# The type here doesn't really matter since it's just a static site.\ntype: 'php:7.3'\n\n# This must be set, but can be set at the minimum value.\ndisk: 16\n\nmounts:\n    'static':\n        source: service\n        service: files\n        source_path: static\n\nweb:\n    locations:\n        '/':\n            root: 'static/html'\n            index: ['index.html']\n            scripts: false\n            allow: true\n\nThat file is all that is needed to create a second application container.  This container will be called static, and will mount the same network storage directory as the app container that holds the Drupal site.  It will be empty aside from that mount, which is fine as the mount is where the files will be served from.  Note that the web root is the static/html directory, not static itself, as Tome was configured above to write files to static/html.\n9. Update routes\nOpen .platform/routes.yaml in your editor.  Update the route definitions to be as follows:\n\"https://drupal.{default}/\":\n    type: upstream\n    upstream: \"app:http\"\n    cache:\n        enabled: true\n\n        # Base the cache on the session cookie and custom Drupal cookies. Ignore all other cookies.\n        cookies: ['/^SS?ESS/', '/^Drupal.visitor/']\n\n\"https://{default}/\":\n    type: upstream\n    upstream: \"static:http\"\n\n(You can also include a www redirect route if you want, but that is unnecessary.)  This configuration creates two routes: The drupal. subdomain will be where the Drupal site lives, and it will run as any other Drupal site.  The main domain (and/or www. subdomain if desired) will be served by the static application.\nOnce the configuration is complete and you are happy with the result, you will most likely want to come back and add HTTP caching to the static route, including a default_ttl.\n10. Commit and push\nCommit all of the files you just created to Git:\ngit add .\ngit commit -m \"Setting up Tome\"\n\nNow add a remote for your empty Platform.sh project.  The Git URL can be found in your Management Console in the browser.  The command will be something along the lines of:\ngit remote add platform bzh2mp6iabike@git.eu-3.platform.sh:bzh2mp6iabike.git\n\nAnd then push all of the code to the platform remote:\ngit push -u platform master\n\nIf everything is setup correctly it will push and deploy a two-application cluster, containing the Drupal container, static container, and the MariaDB and Redis services used by Drupal itself.\n11. Install Drupal and Tome\nOnce deployment is finished it will show you the domain names that are served.  Go to the drupal. domain in your browser.  Complete the Drupal installation process as normal.\nOnce Drupal is installed, select \u201cExtend\u201d in the menu and enable the \u201cTome\u201d module.  That will also enable several sub-modules.  You don\u2019t need to create any content at this point, but if you do it will make the demonstration of Tome\u2019s functionality more interesting.\n12. Export the site\nGo to /admin/config/tome/static/generate in your Drupal site.  The generation form will ask you for the domain to generate for; give it the unprefixed domain (which could be a dev domain or your production domain, depending on whether or not you\u2019ve gone live yet).  Click \u201cSubmit\u201d.\nTome will generate a static version of your site as it is seen by an anonymous user.  (Which means you must allow anonymous user to see the site.)  The process takes anywhere from a few seconds to a few minutes depending on how much content you have.  As the site was only just created it should be quite fast.\nNow go to the unprefixed version of your site (the domain without drupal.) in your favorite browser.  You should see the anonymous version of your site, now served entirely as static files.\nConclusion\nIn this tutorial, you have seen how to:\n\nCreate a multi-application project on Platform.sh.\nUse network-storage to share content between sites.\nConfigure an application to serve static files.\n\nAll of which can be applied to other configurations if needed.  Note that in the case of Tome the generation process does delete files first, so it is recommended to configure caching at the router level for the static container to minimize any disruption to the site as it is being regenerated.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Can I have root permissions?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/can-i-have-root-permissions/248", "documentId": "f5fa85f4745479405644d1d7bd3bf8b4f72f2b2c", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Can I have root permissions?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            credentials\n          \n        \n    \n\n\n\n\n  \n      \n        \n          julien.khamis\n          \n        \n\n        \n            \n            \n              May 3, 2019,  3:14pm\n            \n        #1\n        \n      \n      \n        Can I have root permissions on my Platform.sh projects ?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              May 3, 2019,  9:07pm\n            \n        #2\n        \n      \n      \n        Root access is not available on Platform.sh.  Platform.sh is a fully managed PaaS, which means most system-level configuration and package management is handled in an automated fashion by our team.\nMost of each container is a read-only file system anyway, so even the root user would not be able to do much.  The only writeable parts of the system are your file mounts, which you define in .platform.app.yaml and have full access to, and selected configuration files that are auto-generated on deploy based on your .platform.app.yaml file.  That supports both repeatable deployments and tighter security.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "All Time", "section": "Platform.sh Community", "url": "https://community.platform.sh/c/questions-answers?page=1&per_page=50", "documentId": "8e3086045bce484af94215ccc5b21ac3d319cb54", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n\n\n\n  \n\n    \n      Questions &amp; Answers\n  \n  \n\n\n\n  \n\n    \n      \n        Topic\n        Replies\n        Activity\n      \n    \n\n    \n      \n        \n          \n            \n            \n            \n            \n              How can I use nutch to index my site?\n            \n          \n          \n            2\n          \n          \n            July 25, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Is there a way to fail a build when one of the build hooks throws an error?\n            \n          \n          \n            3\n          \n          \n            July 24, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              What is a best way to sync files from `develop` to `master`?\n            \n          \n          \n            2\n          \n          \n            July 26, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How do I change my project name?\n            \n          \n          \n            2\n          \n          \n            May 6, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I identify MySQL slow queries on the PaaS\n            \n          \n          \n            2\n          \n          \n            September 10, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How much disk space is available during the build hook for application code?\n            \n          \n          \n            2\n          \n          \n            March 25, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              What databases can I use in my project?\n            \n          \n          \n            2\n          \n          \n            April 23, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Why is my site slow?\n            \n          \n          \n            2\n          \n          \n            May 3, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I force a PDF download with Platform.sh?\n            \n          \n          \n            2\n          \n          \n            July 25, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Do redirects in `routes.yaml` file also show up in `PLATFORM_ROUTES`?\n            \n          \n          \n            2\n          \n          \n            June 11, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              When does a variable requires a JSON formatting?\n            \n          \n          \n            2\n          \n          \n            April 11, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I connect to my database from my local workstation?\n            \n          \n          \n            2\n          \n          \n            April 16, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Is it possible to increase Redis `maxmemory` configuration option?\n            \n          \n          \n            2\n          \n          \n            July 18, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Use the same root domain across multiple projects\n            \n          \n          \n            2\n          \n          \n            April 18, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to get ssh connection details from the commandline?\n            \n          \n          \n            2\n          \n          \n            May 17, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Odoo 13 + python\n            \n          \n          \n            3\n          \n          \n            February 16, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to build and deploy Angular Universal app?\n            \n          \n          \n            5\n          \n          \n            April 16, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How do I monitor my application outgoing emails?\n            \n          \n          \n            2\n          \n          \n            February 7, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How do I share files between multiple applications?\n            \n          \n          \n            2\n          \n          \n            June 11, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I access the live site using the original Platform-provided URLs?\n            \n          \n          \n            2\n          \n          \n            May 14, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              MongoDB configuration at Platform.sh\n            \n          \n          \n            2\n          \n          \n            February 7, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Can I serve custom error pages (4xx, 5xx)?\n            \n          \n          \n            2\n          \n          \n            July 25, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I get information on the various Platform.sh regions?\n            \n          \n          \n            2\n          \n          \n            July 11, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              For Ruby on Rails, what's the best way to delete the database records?\n            \n          \n          \n            3\n          \n          \n            February 7, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              If I add a service, can I still restore a snapshot from before that service existed?\n            \n          \n          \n            2\n          \n          \n            July 26, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              The environment \"master\" is not currently active\n            \n          \n          \n            2\n          \n          \n            May 16, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Given a project that there are five microservices, is there any way to make four private and just one public?\n            \n          \n          \n            2\n          \n          \n            July 25, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Will removing the account that created an integration break the integration?\n            \n          \n          \n            2\n          \n          \n            April 15, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Link to communicate multiple applications as web services in a form\n            \n          \n          \n            2\n          \n          \n            July 25, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Can I set a project variable to run different build scripts among several environments?\n            \n          \n          \n            2\n          \n          \n            May 6, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              (Solved) Pyodbc install fails\n            \n          \n          \n            2\n          \n          \n            February 5, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Is it possible to run X-Debug on Platform.sh?\n            \n          \n          \n            2\n          \n          \n            July 19, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Is it possible to open direct access to a db service?\n            \n          \n          \n            2\n          \n          \n            July 23, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How do I fix `fatal: the remote end hung up unexpectedly` while pushing from a GitLab pipeline to Platform.sh?\n            \n          \n          \n            2\n          \n          \n            March 12, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Is there a build dependencies cache on Platform.sh?\n            \n          \n          \n            2\n          \n          \n            February 14, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Is there a way to mount a network storage on the service instance, but not the app?\n            \n          \n          \n            2\n          \n          \n            July 12, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              The connection link to several projects\n            \n          \n          \n            2\n          \n          \n            July 25, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How do I fix `fatal: the remote end hung up unexpectedly` while pushing from a Bitbucket pipeline to Platform.sh?\n            \n          \n          \n            3\n          \n          \n            March 12, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Can these old TLS ciphers be deactivated?\n            \n          \n          \n            2\n          \n          \n            February 13, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              What's the correct route conf for a websocket?\n            \n          \n          \n            3\n          \n          \n            March 19, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Is it possible to upsize my project plan using the CLI?\n            \n          \n          \n            2\n          \n          \n            August 19, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Why are my Let's Encrypt certificates failing to provision on my development environments?\n            \n          \n          \n            2\n          \n          \n            February 12, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Is there a way to change the parent environment?\n            \n          \n          \n            2\n          \n          \n            June 1, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to git push without rebuilding?\n            \n          \n          \n            3\n          \n          \n            April 14, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I reset or empty a service?\n            \n          \n          \n            2\n          \n          \n            August 26, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Reverse Proxy rules in router\n            \n          \n          \n            2\n          \n          \n            March 2, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Is it possible to set a password on a MariaDB/MySQL service?\n            \n          \n          \n            2\n          \n          \n            December 13, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              If I have a custom certificate installed on my project and it expires, will there be an automatic switch to a LetsEncrypt cert?\n            \n          \n          \n            2\n          \n          \n            January 6, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Is it possible to post a test results somewhere?\n            \n          \n          \n            2\n          \n          \n            August 26, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How do I serve some requests from a different PHP front controller?\n            \n          \n          \n            2\n          \n          \n            March 10, 2020\n          \n        \n    \n\n  \n\n\n  \n      \u2190 previous page \u00a0\n    next page \u2192\n  \n\n\n \n\n\n\n  \n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How do the queues in my project work? Is it only possible to have one thing building/deploying at a time?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-do-the-queues-in-my-project-work-is-it-only-possible-to-have-one-thing-building-deploying-at-a-time/165", "documentId": "738922885c7c49addad318c2b086fd7b99c257ea", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How do the queues in my project work? Is it only possible to have one thing building/deploying at a time?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              August 13, 2019, 10:59pm\n            \n        #1\n        \n      \n      \n        For example, if a developer pushes something on the stage branch, and it takes 10 minutes to build, can I deploy a hotfix on master in that time?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              April 11, 2019,  4:04pm\n            \n        #2\n        \n      \n      \n        Environment builds occur in the order that they are received. If you push an update to two active environments, the build on the environment pushed first will have to complete before the second environment can be built.\nUntil that time, the second build will continue to show a state of either \u2018In Progress\u2019 or \u2018Pending\u2019 depending on the state of that first build.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Can I get a dedicated FTP/SFTP account for access to a specific directory?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/can-i-get-a-dedicated-ftp-sftp-account-for-access-to-a-specific-directory/452", "documentId": "3481086c6138ed1d3ba3ed3eec2bb6dc7d57f756", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Can I get a dedicated FTP/SFTP account for access to a specific directory?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            sftp\n          \n        \n        \n          \n            files\n          \n        \n        \n          \n            user-management\n          \n        \n        \n          \n            ssh\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              February 7, 2020,  9:04pm\n            \n        #1\n        \n      \n      \n        Can I create an SFTP account for one of my team that only allows access to one folder, not to the whole site?\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          dman\n          \n        \n\n        \n            \n            \n              February 7, 2020,  9:03pm\n            \n        #2\n        \n      \n      \n        A common requirement is to provide some sort of upload or download folder within your site, that an external tool or service may want to read or write to. This may be automated uploads of product catalogs or CSVs, or automated downloads of exported reports or backups. Generally it\u2019s a good idea to provide these automated tools with the minimum necessary privileges for their task, so a dedicated account just for the robot, with limited access, is a good way to do this.\nPlatform.sh does not allow unencrypted FTP access, you have to use SFTP.\nOn Platform Grid (Standard) you only get one login to your environment. Even when you have multiple developers with access, they all connect as the same user there. That account has visibility of your whole project, and write-access to all your writable file mounts. It\u2019s not possible to add additional users with limited access within that. You cannot \u201cchroot\u201d an account.\nYou can however add additional \u2018user\u2019 accounts to your project, and even manage access for them on a per-branch level. So adding a new \u2018user\u2019 account to your project, granting it access to a specific branch, and uploading its public ssh key will achieve most of what you need. You just need to provide it with the full directory path for its target. This account will have ssh access to upload and download files on Platform.sh as needed.\nThe SFTP credentials are the ones shown as \u201cSSH\u201d info on your project-branch console page, or can be retrieved with the  platform ssh --pipe command.\nYou must use ssh key authentication. Password only authentication is prohibited.\nRemember, your deployed environment is read-only, so the risk of allowing a daemon account access to your uploaded files is limited to those mounts that you have already designated as writeable anyway.\nFor Platform Dedicated hosting, more flexibility is possible. If needed, please raise a ticket with Platform.sh Support with your requirements.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Do you support other version control system?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/do-you-support-other-version-control-system/255", "documentId": "669ceedc6c1eb691a6075652ecb643047c73b160", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Do you support other version control system?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          mrkschan\n          \n        \n\n        \n            \n              May 6, 2019,  2:05am\n            \n        #1\n        \n      \n      \n        Do you support SVN, CVS, Perforce, etc to upload my website?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              May 6, 2019, 10:59pm\n            \n        #2\n        \n      \n      \n        Platform.sh\u2019s API is fundamentally build upon Git, so at this time it is the only version control system that we support.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to migrate a PostgreSQL database from Heroku to Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-migrate-a-postgresql-database-from-heroku-to-platform-sh/301", "documentId": "5a0b3d3bca23421bafc466c639be70a29d99569d", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to migrate a PostgreSQL database from Heroku to Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            postgresql\n          \n        \n        \n          \n            heroku\n          \n        \n        \n          \n            databases\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          anya-zhang\n          \n        \n\n        \n            \n            \n              June 5, 2019,  1:03pm\n            \n        #1\n        \n      \n      \n        How to migrate a PostgreSQL database from Heroku to Platform.sh\n\nGoal\nMigrate data stored in a Heroku PostgreSQL resource to a Platform.sh service.\nAssumptions\nYou will need:\n\nan active application on Platform.sh configured to an empty database\nan active application on Heroku configured to the target database\n\nPlatform.sh Postgres database credentials\n\nA local repository with the Platform.sh project as git remote\nThe Platform.sh CLI installed locally\n\nProblems\nWhen migrating an existing PostgreSQL project from Heroku to Platform.sh, the corresponding resources must be migrated as well. Heroku and Platform.sh use different db_dump formats, as well as different styles of configuration settings.\nSteps\n1. Download database dump from Heroku.\nFind the Resources tab of the Heroku App Dashboard and click on the name of the desired database add-on, for example Heroku Postgres. From the datastore dashboard, visit the Durability tab, create a manual backup of the data, and download the backup file. For the purposes of this guide, the location of the dump will be assumed to be ~/Downloads/db.dump.\n2. Add extensions to Platform.sh configuration.\nNext, issue the following command to filter the list of SQL commands in the dump by the word \u201cextension\u201d, giving all Postgres extensions loaded into the database:\n$ pg_restore -l  ~/Downloads/db.dump | grep -o -P '(?&lt;=EXTENSION \\\").*(?=\\\")'\n\nFor example, this might output\nplpgsql\nhstore\n\nFor each extension, consult the PostgreSQL docs to determine whether it is supported by Platform. If so, add it to the app\u2019s platform.app.yaml as follows:\nruntime:\n    extensions:\n        - plpgsql\n        - hstore\n\n\n3. Convert Heroku dump to a filtered SQL file.\nNext, create a list of the contents of the database dump again, this time filtered to remove all extension-related commands, by the following:\npg_restore -l  ~/Downloads/db.dump  | grep -v 'EXTENSION' &gt; db.list\n\nFinally, use this list to generate a new, filtered SQL file from the original dump file:\npg_restore --no-owner -L db.list ~/Downloads/db.dump  &gt; db.sql\n\nThis creates an intermediary file db.list, which may be removed.\n4. Import database to Platform.sh\n\n\nnote  Importing a database snapshot is a destructive operation, which will overwrite data already in your database. Backing up data before completing this step is strongly recommended.\n\nThe final step is importing the SQL file to the Platform database instance. The simplest way to do so is via the following command in the project directory:\nplatform sql &lt; db.sql\n\nTo specify a database or environment, add the following flags:\nplatform sql --relationship database -e master &lt; my_database_snapshot.sql\n\nIf prompted for a password, supply the password from the Postgres database credentials.\nConclusion\nThe steps for migrating PostgreSQL data from Heroku to Platform.sh involve downloading the data from Heroku, configuring extensions and converting the dump format, then importing it to the project, making sure nothing important is being overwritten.\n      \n\n      \n\n      \n         \n         \n         2 Likes\n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    How to migrate your Java Application from Heroku to Platform.sh\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Can I just have my whole project read / write and serve my PHP website from here?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/can-i-just-have-my-whole-project-read-write-and-serve-my-php-website-from-here/245", "documentId": "a05ed36dedfada7f2c7f650d2ff76f147ce19513", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Can I just have my whole project read / write and serve my PHP website from here?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            storage\n          \n        \n    \n\n\n\n\n  \n      \n        \n          lucas\n          \n        \n\n        \n            \n              May 3, 2019,  3:05pm\n            \n        #1\n        \n      \n      \n        Hello,\nI feel that having everything read-only by default prevents me from working fast enough - can I just make a mount to / and rsync then serve my PHP website from here, so I can open an editor and make my changes directly there?\nThanks!\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          royall\n          \n        \n\n        \n            \n              May 3, 2019,  3:25pm\n            \n        #2\n        \n      \n      \n        The read-only disk for application code is a key facet of Platform\u2019s security and developer experience. It prevents security flaws from allowing code to be overwritten and provides a trail of changes so every developer knows when any change was made to the code. Good commit messages might even explain why a change occurred!\nAlthough we do not recommend this as a development practice, it is possible to work this way. Add a mount and location to .platform.app.yaml:\n# set the application root as a mount (this will overwrite any code from git at deploy time)\nmounts:\n    '/':\n        source: local\n        source_path: uploads\n\nweb:\n    locations:\n        # Allow scripts to run from the mounted writable directory\n        '/':\n            scripts: true\n            allow: true\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "What does it mean when my environment has a \"dirty\" status?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/what-does-it-mean-when-my-environment-has-a-dirty-status/175", "documentId": "cf3f1ab6c62df23fb7e4a6b70bdf9d3ff36224e4", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  What does it mean when my environment has a \"dirty\" status?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            dirty\n          \n        \n        \n          \n            active\n          \n        \n        \n          \n            environments\n          \n        \n    \n\n\n\n\n  \n      \n        \n          robert\n          \n        \n\n        \n            \n              March 19, 2019,  7:24pm\n            \n        #1\n        \n      \n      \n        As opposed to \u201cactive\u201d?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              March 26, 2019,  1:59pm\n            \n        #2\n        \n      \n      \n        When you make a change to a project, such as allowing outgoing emails to an environment or allowing indexing by search engines, those changes require that project to be rebuilt and redployed in order to take effect.\nThe project exists in a state between \u201cActive\u201d and \u201cInactive\u201d at this time, and will represent itself as \u201cDirty\u201d/\u201cBuilding\u201d during this process.\nOnce the project has been rebuilt and redeployed with those changes, it will once again be shown as \u201cActive\u201d.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "More production environments on the project", "section": "Questions & Answers", "url": "https://community.platform.sh/t/more-production-environments-on-the-project/250", "documentId": "eff740d2a5c07db5f444ac95fa4415de05ac4999", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  More production environments on the project\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          mouhamadou\n          \n        \n\n        \n            \n              May 3, 2019,  3:29pm\n            \n        #1\n        \n      \n      \n        Is it possible to have different production environments on the same project?\nOr only master branch can go live?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              May 15, 2019,  4:51pm\n            \n        #2\n        \n      \n      \n        At this time, the master branch is synonymous with production.  It is the only branch that can have a domain name attached and use the full resources allocated by the project\u2019s plan size.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "What is the routes.yaml max file size?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/what-is-the-routes-yaml-max-file-size/185", "documentId": "c9e413664c63bea526913388f4036fd4a48af668", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  What is the routes.yaml max file size?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            routes-yaml\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              August 13, 2019, 11:00pm\n            \n        #1\n        \n      \n      \n        Is it a number of routes? Characters? File size?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          robert\n          \n        \n\n        \n            \n              March 28, 2019,  4:54pm\n            \n        #2\n        \n      \n      \n        It\u2019s not a particular size of the yaml file, it\u2019s the length of the PLATFORM_ROUTES environment variable.\n32767 characters of encoded base64 json is the limit.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How much storage can I add to my project?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-much-storage-can-i-add-to-my-project/228", "documentId": "e63dec2d7f278de9e60f3d941626009a42207f54", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How much storage can I add to my project?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          chris.yates\n          \n        \n\n        \n            \n              April 29, 2019,  1:14pm\n            \n        #1\n        \n      \n      \n        How much do I get by default, and how much can I add?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              April 29, 2019, 11:04pm\n            \n        #2\n        \n      \n      \n        A Platform.sh Professional project comes with 5 GB of storage per environment.  You can allocate that space between your application container and each of your services as you like, using the disk property in services.yaml and .platform.app.yaml.\nYou can increase the per-environment disk space yourself through the UI, up to 50 GB per environment.  The price is based on the disk space and number of environments you have on your plan (which you can also adjust yourself.)  If you want more than 50 GB please file a support ticket so we can increase it for you.  It\u2019s not a problem, we just need to make sure the grid host you\u2019re on has sufficient space for it.\nPlatform.sh Enterprise comes with 50 GB of storage for the staging and production environments.  That can be increased (but not decreased) by filing a support ticket.\nCheers.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Can I SSH into my website?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/can-i-ssh-into-my-website/225", "documentId": "0e8edccf307e67e45ad0f14218cf6bc4be54c6ff", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Can I SSH into my website?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            ssh\n          \n        \n    \n\n\n\n\n  \n      \n        \n          juliensalinas\n          \n        \n\n        \n            \n            \n              April 26, 2019, 12:22pm\n            \n        #1\n        \n      \n      \n        Can I SSH into my website? How?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              May 2, 2019,  7:54pm\n            \n        #2\n        \n      \n      \n        Yes you can, either directly or by using the CLI:\n\n\nIf you haven\u2019t already, add your SSH key to your Platform.sh Account\nLog into your account. In the management console, Move to the top right hand corner of the screen and click the dropdown menu to the left of the settings gear box icon. In the menu, click on Account, then on Account Settings at the top of the page.\nLastly, click the SSH keys tab to the left of your account information. Name your SSH key in the first field and paste your public key in the second. When you are finished, click Save to save the key.\n\n\nDirectly SSH into the project\nWhile you\u2019re still in the management console, click on the environment you want to SSH into. At the top right hand corner of the console there will be a dropdown button labeled SSH. When you click it it will expose the command to SSH into your environment.\nFor example, to access the dev environment of the project myapp\nssh 32ldnujngz2hk-dev-54ta5gq--app@ssh.us-2.platform.sh\n\nYou can see that this command can be generalized to\nssh &lt;project id&gt;-&lt;environment name&gt;&lt;env name hash&gt;--&lt;project name&gt;@ssh.&lt;region&gt;.platform.sh\n\n\n\nUsing the CLI\nIn your terminal run the command\nplatform ssh\n\nwhich will execute the above command based on the branch you are currently checked out as in your local repository. If you are not in a local repository where Platform.sh has been set as remote, the CLI will ask you to select the environment and project you want to SSH into.\nYou can bypass this selection with\nplatform ssh -p &lt;project id&gt; -e &lt;environment name&gt;\n\n\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Latest How-to Guides topics", "section": "Platform.sh Community", "url": "https://community.platform.sh/c/how-to?page=2", "documentId": "bad5528ada3b1365559341b8d9e6b8a58c21f6e7", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n\n\n\n  \n\n    \n      How-to Guides\n  \n  \n\n\n\n  \n\n    \n      \n        Topic\n        Replies\n        Activity\n      \n    \n\n    \n      \n        \n          \n            \n            \n            \n            \n              How to access MySQL/MariaDB credentials on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 14, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to access MongoDB credentials on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 14, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to access PostgreSQL credentials on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 14, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to access Redis credentials on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 14, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to add a webhook to one or more projects\n            \n          \n          \n            1\n          \n          \n            March 14, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to use Redis for caching a Drupal 8 site\n            \n          \n          \n            1\n          \n          \n            April 3, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to connect to services on Platform.sh from your local system\n            \n          \n          \n            1\n          \n          \n            April 3, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to upgrade Wordpress core and dependencies with Composer\n            \n          \n          \n            1\n          \n          \n            March 19, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to blacklist abusive IP addresses on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 18, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to migrate database changes between environments\n            \n          \n          \n            1\n          \n          \n            March 12, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to perform a database dump via Platform.sh CLI\n            \n          \n          \n            1\n          \n          \n            March 14, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to make internal requests between two applications of a project\n            \n          \n          \n            1\n          \n          \n            March 11, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to add or remove users from projects using the command line\n            \n          \n          \n            1\n          \n          \n            March 11, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to configure low-disk health notifications on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 12, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to interactively debug Node.js applications on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 19, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to see your Nginx configuration file\n            \n          \n          \n            1\n          \n          \n            March 16, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to utilize the CLI to modify already existing Git integrations\n            \n          \n          \n            1\n          \n          \n            March 14, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to run Minio on Platform.sh\n            \n          \n          \n            2\n          \n          \n            March 14, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to rely on a PKI (Public Key Infrastructure) on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 11, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to use the Platform.sh CLI from the web container\n            \n          \n          \n            1\n          \n          \n            March 13, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to run a Rust web application on Platform.sh\n            \n          \n          \n            1\n          \n          \n            March 12, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to configure HTTP Strict Transport Security (HSTS) on your project\n            \n          \n          \n            1\n          \n          \n            March 9, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How to upload and download files to your application (SFTP/RSYNC)\n            \n          \n          \n            1\n          \n          \n            March 11, 2019\n          \n        \n    \n\n  \n\n\n  \n      \u2190 previous page \u00a0\n    next page \u2192\n  \n\n\n \n\n\n\n  \n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to run an Anaconda/Miniconda Python stack on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-run-an-anaconda-miniconda-python-stack-on-platform-sh/230", "documentId": "9c61eee73444bc915c7ec567a24fafbe823695d0", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to run an Anaconda/Miniconda Python stack on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            conda\n          \n        \n        \n          \n            python\n          \n        \n        \n          \n            pycon2019\n          \n        \n    \n\n\n\n\n  \n      \n        \n          nick\n          \n        \n\n        \n            \n            \n              April 30, 2019,  8:14pm\n            \n        #1\n        \n      \n      \n        Goal\nTo run Anaconda (the full data science Python stack) or Miniconda (just the Python package manager) on Platform.sh.\nAssumptions\nYou will need:\n\nAn SSH key configured on your Platform.sh account\nAn empty Platform.sh project\n\nProblems\nPlatform.sh offers several different versions of Python by default, but some applications require different environments, such as data science applications running on the Anaconda stack or packages installed with Miniconda. Running the Anaconda/Miniconda installer in the build hook of a Platform.sh application allows for the activation of conda virtual environments for script execution.\nSteps\n1. Set git remote to Platform.sh project\n$ git init\n$ platform project:set-remote &lt;project id&gt;\n\n2. Create an installation script file\nThe Platform.sh build hook runs Dash, not Bash, so the installation script is executed separately in install_conda.sh:\n#!/bin/bash\n\n# Download an Anaconda3 release and name the file `conda.sh`\n\ncurl https://repo.anaconda.com/archive/Anaconda3-2019.03-Linux-x86_64.sh -o conda.sh\n\n# If you wish to install Miniconda3 instead, comment out the line above and uncomment the line below:\n# curl https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -o conda.sh\n\n# Run the downloaded `conda.sh` script using bash\n# \u2014 Use the `-b` flag to run the installer in batch mode\n# \u2014 Use the `-p` flag to specify where the package manager will actually be installed\nbash conda.sh -b -p $PLATFORM_APP_DIR/conda\n\n# Source the following `conda.sh` file to put the `conda` command in our path for the duration of this script\n. /app/conda/etc/profile.d/conda.sh\n\n# Add the above command to `.bash_profile` so that it is available during SSH sessions\necho \". /app/conda/etc/profile.d/conda.sh\" &gt;&gt; ~/.bash_profile\necho \"conda activate\" &gt;&gt; ~/.bash_profile\n\n# Enter the base conda environment and prepare to configure it\nconda activate base\n\n# Update conda itself\nconda update -n base -c defaults conda\n\n# OPTIONAL: Print out debugging information in the build hook\nconda info\n\n3. Add a start script for running scripts with Anaconda\nstart_command.sh:\n#!/bin/bash\n\n# Source the `conda.sh` file to make this particular shell session able to run the `conda` command\n. /app/conda/etc/profile.d/conda.sh\n\n# Activate the conda environment that was created in the build hook\nconda activate base\n\n# Put any commands needed to run a web app here\n\nMake sure to put any commands needed to run a web app at the end of this file.\n4. Add .platform.app.yaml\nCreate the .platform.app.yaml configuration file:\n# The name of this app. Must be unique within a project.\nname: app\n\n# The runtime the application uses.\ntype: \"python:3.7\"\n\n# The hooks executed at various points in the lifecycle of the application.\nhooks:\n    build: |\n      set -e\n\n      # The build hook uses `dash` rather than `bash`.\n      # Thus, the installation occurs in separate script that runs with `bash`.\n      bash install_conda.sh\n\n    deploy: |\n      set -e\n\n      # Make the start script executable\n      chmod +x start_command.sh\n\n# The size of the persistent disk of the application (in MB).\ndisk: 1024\n\n# The configuration of app when it is exposed to the web.\nweb:\n    commands:\n        start: bash ./start_command.sh\n    upstream:\n        socket_family: tcp\n        protocol: http\n    locations:\n        \"/\":\n            passthru: true\n\n5. Define routes\n./.platform/routes.yaml\nhttps://{default}/:\n    type: upstream\n    upstream: app:http\n\n6. Add empty services\n./.platform/services.yaml\n# empty\n\n7. Add, commit, and push these files to your Platform.sh project\ngit add .\ngit commit -m \"Adding configuration to install conda environment\"\ngit push platform master\n\nConclusion\nBy executing the Anaconda or Miniconda installation Bash scripts in the build hook, a project is able to install an Conda-based execution environment on Platform.sh.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          nick\n          \n            unlisted \n        \n\n        \n            \n              April 30, 2019, 12:41am\n            \n        #2\n        \n      \n      \n        \n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          nick\n          \n            listed \n        \n\n        \n            \n              April 30, 2019,  8:14pm\n            \n        #3\n        \n      \n      \n        \n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Platform.sh Community", "section": "Platform.sh Community", "url": "https://community.platform.sh/c/how-to.json", "documentId": "f04ac169f5f865bcadd3157c092cdc7184ce8605", "text": "", "rank": 3},
{"site": "community", "title": "How to access Memcached credentials on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-access-memcached-credentials-on-platform-sh/147", "documentId": "c6d73d9472559c037456fad6f2e3f2822184941c", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to access Memcached credentials on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            config-reader-nodejs\n          \n        \n        \n          \n            memcached\n          \n        \n        \n          \n            object-cache\n          \n        \n        \n          \n            credentials\n          \n        \n        \n          \n            nodejs\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              April 16, 2019,  6:16pm\n            \n        #1\n        \n      \n      \n        Goal\nAccess credentials for Memcached from within a Platform.sh application using Node.js.\nAssumptions\n\nan active Platform.sh project\nproperly configured .platform/services.yaml for the given service\n\nSSH key configured on account if developing locally\nMemcached installed if developing locally\nproperly configured Memcached relationship like so, in .platform.app.yaml:\n\nrelationships:\n    memcached: 'memcached:memcached'\n\nIf developing locally, remember to first open a tunnel to the project environment using the Platform CLI.\n$ platform tunnel:open &amp;&amp; export PLATFORM_RELATIONSHIPS=\"$(platform tunnel:info --encode)\"\n\nThis will open an SSH tunnel to your current Platform.sh environment and expose a local environment variable that mimics the relationships array on Platform.sh. Check the Platform.sh documentation and How to develop locally on Platform.sh with a tethered connection for more information.\nProblems\nPlatform.sh service credentials are made available to applications as the PLATFORM_RELATIONSHIPS environment variable, which is a base64-encoded JSON string that has to be decoded before it can be used.\nThere are two primary options for accessing service credentials on Platform.sh that can be used within an application:\n\nUsing the Platform.sh Config Reader library\n\nAccessing environment variables directly\n\nSteps (Config Reader)\n1. Install the library\nInstall the configuration library. See the documentation for minimum requirements.\n$ npm install platformsh-config --save\n\n2. Create a Config object\nCreating a Config object provides access to the Platform.sh environment.\nconst config = require(\"platformsh-config\").config();\n\n3. Read the credentials\n// Get the credentials to connect to the Memcached service.\nconst credentials = config.credentials('memcached');\n\nSteps (Manual)\n1. Load the environment variable\nrelationships = JSON.parse(new Buffer(process.env['PLATFORM_RELATIONSHIPS'], 'base64').toString());\n\n2. Read the credentials\ncredentials = relationships['memcached'];\n\nUse\nIn most cases, you will need only the host and port properties to connect to Memcached. Pass those to your Memecached library\u2019s setup routine in your application. Most of the time the other values may be ignored.\nIn either case, credentials is a an object matching the relationship JSON object, which includes the appropriate user, password, host, database name, and other pertinent information.\n{\n  \"service\": \"memcached\",\n  \"ip\": \"169.254.192.212\",\n  \"hostname\": \"tmimatsnz2dv26qlpuespenf3u.memcached.service._.eu-3.platformsh.site\",\n  \"cluster\": \"rjify4yjcwxaa-master-7rqtwti\",\n  \"host\": \"memcached.internal\",\n  \"rel\": \"memcached\",\n  \"scheme\": \"memcached\",\n  \"type\": \"memcached:1.4\",\n  \"port\": 11211\n}\n\nConclusions:\nUsing either the language-specific Platform.sh Configuration library or direct access methods for environment variables, an application can get Memcached credentials in Node.js.\nPlatform.sh supports configuration libraries for multiple languages. The Node.js configuration library can be useful for inspecting the project environment:\n// Checks whether the code is running in a build environment\nconfig.inBuild()\n// Checks whether the code is running in a runtime environment\nconfig.inRuntime()\n\nand for reading environment variables as attributes of config:\n// Available in Build and at Runtime\nconfig.appDir;\n// Available at Runtime only\nconfig.branch;\nconfig.smtpHost;\n\nThe APIs for each language are written to be as consistent as possible, but seek out each library\u2019s documentation for specific differences.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "All Time", "section": "Platform.sh Community", "url": "https://community.platform.sh/c/questions-answers?page=2&per_page=50", "documentId": "6a0af9584ef4792a7793d9e79503f2449c7f72bd", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n\n\n\n  \n\n    \n      Questions &amp; Answers\n  \n  \n\n\n\n  \n\n    \n      \n        Topic\n        Replies\n        Activity\n      \n    \n\n    \n      \n        \n          \n            \n            \n            \n            \n              Where is my database storage going to?\n            \n          \n          \n            1\n          \n          \n            February 19, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Expose Elasticsearch over HTTP\n            \n          \n          \n            1\n          \n          \n            March 27, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              For persistent Redis, what persistence methods does Platform.sh employs? RDB, AOF, or both?\n            \n          \n          \n            2\n          \n          \n            April 13, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Connecting to MongoDB with GUI tool like Robo 3T or Mongo Compass\n            \n          \n          \n            1\n          \n          \n            April 26, 2020\n          \n        \n    \n\n  \n\n\n  \n      \u2190 previous page \u00a0\n    next page \u2192\n  \n\n\n \n\n\n\n  \n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to upgrade Wordpress core and dependencies with Composer", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-upgrade-wordpress-core-and-dependencies-with-composer/173", "documentId": "d80ea348021e99a4748b78c3b91b51dc018edbba", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to upgrade Wordpress core and dependencies with Composer\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            composer\n          \n        \n        \n          \n            wordpress\n          \n        \n        \n          \n            php\n          \n        \n    \n\n\n\n\n  \n      \n        \n          robert\n          \n        \n\n        \n            \n            \n              March 20, 2019,  6:59pm\n            \n        #1\n        \n      \n      \n        Goal\nUpdate WordPress to the latest version using Composer.\nAssumptions\n\nA WordPress installation on Platform.sh that uses Composer, for example one that uses the WordPress Template.\nThe Platform.sh CLI tool installed locally\nAn SSH key configured on the project account\n\nComposer installed locally\n\nProblems\nKeeping WordPress up to date is essential for security as well as for bug fixes and new features. Updating WordPress with one command lowers the burden of maintenance. Since WordPress doesn\u2019t provide native Composer support, the template provided by Platform.sh depends on a community maintained package.\nSteps\n1. Make a branch for updating WordPress:\n$ platform checkout wordpress-update\n\n2. Update composer.json\n\nCheck that composer.json is set to track the latest WordPress version. It should have something like ^5.1 listed for wordpress-core.\n  \"require\": {\n    \"php\": \"&gt;=5.3.2\",\n    \"johnpbloch/wordpress-core-installer\": \"^1.0\",\n    \"johnpbloch/wordpress-core\": \"^5.1\"\n  },\n\n3. Run composer update.\ncomposer update --with-dependencies\nLoading composer repositories with package information\nUpdating dependencies (including require-dev)\nPackage operations: 2 installs, 0 updates, 0 removals\n  - Installing johnpbloch/wordpress-core-installer (1.0.2): Loading from cache\n  - Installing johnpbloch/wordpress-core (5.1.1): Downloading (100%)         \nWriting lock file\nGenerating autoload files\n\n\n4. Check changes\nRun git status to see which files have changed:\ngit status\nOn branch wordpress-update\nYour branch is up to date with 'platform/wordpress-update'.\n\nChanges not staged for commit:\n  (use \"git add &lt;file&gt;...\" to update what will be committed)\n  (use \"git checkout -- &lt;file&gt;...\" to discard changes in working directory)\n\n\tmodified:   composer.json\n\tmodified:   composer.lock\n\nno changes added to commit (use \"git add\" and/or \"git commit -a\")\n\n5. Push changes\nNow the project can be built properly by Platform.sh to provide the latest WordPress version.\nAdd, commit, and push.\ngit add composer.json \ngit add composer.lock \ngit commit -m \"Updating WordPress\"\ngit push platform wordpress-update\n\n6. Update the Wordpress database\nUpdate the WordPress database using the platform tool:\nplatform ssh 'wp core update-db'\n\nAlternately, log into the admin area of the site an you will be prompted by WordPress to update the database.\n\nNote that you will have to re-run the database update when you merge your code changes into other branches, e.g. into master when you deploy these changes to your live site.\nConclusion\nRelying on a package manager such as Composer greatly simplifies the maintenance and security of WordPress sites.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Is it possible to post a test results somewhere?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/is-it-possible-to-post-a-test-results-somewhere/379", "documentId": "f496610dd66b189e11ace5ebf472d932f2080c30", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Is it possible to post a test results somewhere?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          ygerasimov\n          \n        \n\n        \n            \n              August 22, 2019,  7:25pm\n            \n        #1\n        \n      \n      \n        Is it possible to place some artifacts from the testing somewhere publicly available after build is done?\nFor example scenario:\n\nbuild is completed\nvisual testing job triggered with Diffy (https://diffy.website)\ntest is completed and would like to post them somewhere\n\nI am thinking about a place where test artifacts can be stored. In our case this could be simple description and a link to actual report.\nThanks\nYuriy\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              August 26, 2019,  4:29pm\n            \n        #2\n        \n      \n      \n        That depends in large part on where you\u2019re running the tests.\nIf you\u2019re running tests in build (good for PHPUnit and similar), then you can leave whatever artifacts you want on disk as it is still writeable at that point.\nIf you\u2019re running the tests on a complete site, which I presume is the case if you mention Diffy, you\u2019ll want to run them in a post_deploy hook so that the site is live.  At that point the only writeable areas are the mounts you\u2019ve defined; you\u2019re free to make a web-accessible mount for just that purpose, though, and write your output to there.  Or a non-web-accessible mount and put a tiny PHP script in front of it to control access.\nThere\u2019s also nothing on the Platform.sh side that would block you from uploading test artifacts to an S3 bucket or similar if you wanted to.\nBasically, you can write the test output to any number of places.  Which places you want to write it to depends on your use case and the tools you\u2019re using.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How do I serve some requests from a different PHP front controller?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-do-i-serve-some-requests-from-a-different-php-front-controller/487", "documentId": "c23135d17b4bc31f19794481d40f73a83a38464f", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How do I serve some requests from a different PHP front controller?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            platformappyaml\n          \n        \n        \n          \n            locations\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              March 10, 2020,  2:05pm\n            \n        #1\n        \n      \n      \n        Most of the requests for my app are served from public/index.php, but I want to serve requests to /api from public/sites/api/api.php. Is this possible on platform.sh?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          adam-mahar\n          \n        \n\n        \n            \n              March 10, 2020,  1:53pm\n            \n        #2\n        \n      \n      \n        Yes! In your .platform.app.yaml, you\u2019ll want to declare an additional location block for /api, and include the directory that it should reference in the root key and the front controller for the site in the index key:\n    locations:\n        '/':\n            root: 'public'\n            passthru: '/index.php'\n            rules:\n                # Allow access to common static files.\n                '\\.(jpe?g|png|gif|svgz?|css|hbs|js|map|ico|bmp|eot|woff|woff2?|tiff?|jng|wbmp|otf|ttf|pdf)$':\n                    allow: true\n        '/api':\n            root: 'public/sites/api'\n            index: ['api.php']\n            allow: true\n            scripts: true\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Is it possible to set a password on a MariaDB/MySQL service?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/is-it-possible-to-set-a-password-on-a-mariadb-mysql-service/432", "documentId": "f5016a10ee3c39659c2a56d987cb532752d89c37", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Is it possible to set a password on a MariaDB/MySQL service?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              December 13, 2019,  4:15pm\n            \n        #1\n        \n      \n      \n        I have an application that throws an error if I don\u2019t give it a password for a MySQL endpoint, but the default configuration for MySQL on Platform.sh has an empty string in the password field of the relationships variable. How can I manually add a password to this service?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          nick\n          \n        \n\n        \n            \n              December 13, 2019,  4:15pm\n            \n        #2\n        \n      \n      \n        Although it is not possible to manually set a password for a MySQL or MariaDB service, it is possible to cause Platform.sh to provide a generated password for the database endpoint. If you follow the instructions for defining multiple databases, but you only define a single endpoint, that non-default endpoint will still include a generated password.\nFor example:\ndb:\n    type: \"mariadb:10.4\"\n    disk: 512\n    configuration:\n        schemas:\n          - maindb\n        endpoints:\n            maindb:\n                default_schema: maindb\n                privileges:\n                    maindb: admin\n\nIn the above example, a database is manually defined almost identically to the default configuration block, but it will expose a generated password in the $PLATFORM_RELATIONSHIPS environment variable. To use these credentials in your application, you might want to use one of our configuration reader libraries.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "All Time", "section": "Platform.sh Community", "url": "https://community.platform.sh/c/questions-answers?per_page=50", "documentId": "bdd227f9992e29bba41a1d2f143b9be5c7a2e7fb", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n\n\n\n  \n\n    \n      Questions &amp; Answers\n  \n  \n\n\n\n  \n\n    \n      \n        Topic\n        Replies\n        Activity\n      \n    \n\n    \n      \n        \n          \n            \n            \n            \n            \n              Is it possible to kill a build or deploy?\n            \n          \n          \n            2\n          \n          \n            March 26, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              What does \"WARNING: [pool web] server reached max_children setting (2), consider raising it\" mean?\n            \n          \n          \n            2\n          \n          \n            May 7, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I forward my logs to Splunk or Logz.io?\n            \n          \n          \n            2\n          \n          \n            April 8, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Using a custom certificate and LetsEncrypt certificates on the same project?\n            \n          \n          \n            2\n          \n          \n            July 24, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Can I use Platform.sh for a different language?\n            \n          \n          \n            2\n          \n          \n            May 6, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Does Platform.sh support subdomains and Let's Encrypt for them?\n            \n          \n          \n            3\n          \n          \n            April 18, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              My plan has 10GB of storage. How can I see precisely how much I am using?\n            \n          \n          \n            4\n          \n          \n            April 16, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Using platform.sh environments for continuous integration / functional tests\n            \n          \n          \n            2\n          \n          \n            February 7, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              How to use FTP to upload files?\n            \n          \n          \n            2\n          \n          \n            May 15, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Log location? dblog or syslog?\n            \n          \n          \n            2\n          \n          \n            April 16, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How do I access my .git directory from within my app?\n            \n          \n          \n            4\n          \n          \n            February 18, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Transferring backups from P.sh to S3\n            \n          \n          \n            4\n          \n          \n            May 29, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              My project has exceeded its cpu limit. What do I do?\n            \n          \n          \n            2\n          \n          \n            May 22, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I access to an environment variable in Javascript?\n            \n          \n          \n            2\n          \n          \n            May 6, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              My project looks to be out of storage. How do I add more?\n            \n          \n          \n            2\n          \n          \n            May 6, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I move a Wordpress site to Platform.sh?\n            \n          \n          \n            3\n          \n          \n            May 29, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Is it possible to run a docker container on Platform.sh?\n            \n          \n          \n            2\n          \n          \n            July 11, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              What is the different between Platform.sh and Terraform?\n            \n          \n          \n            2\n          \n          \n            August 1, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I connect an external tool to my database?\n            \n          \n          \n            2\n          \n          \n            May 2, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I refresh my projects list in Platform CLI?\n            \n          \n          \n            5\n          \n          \n            July 12, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              I need to connect to a VPN endpoint. What are my options?\n            \n          \n          \n            2\n          \n          \n            February 7, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Is there a way to do the equivalent of \"screen\" on platform.sh?\n            \n          \n          \n            2\n          \n          \n            February 7, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Can I point my apex (naked) domain to Platform.sh if I'm using Amazon Route 53 to manage DNS?\n            \n          \n          \n            2\n          \n          \n            June 7, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              What is the difference between a rebuild and a redeploy?\n            \n          \n          \n            2\n          \n          \n            July 11, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I make custom 404 pages?\n            \n          \n          \n            2\n          \n          \n            April 11, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I receive a notification if one of my services (eg. MariaDB) dies?\n            \n          \n          \n            2\n          \n          \n            March 27, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              (How) Can I change the \"Code base template\" after purchasing a plan?\n            \n          \n          \n            3\n          \n          \n            May 7, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Where do I submit bug reports?\n            \n          \n          \n            4\n          \n          \n            May 20, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              What is the right way to run multiple processes from my start command?\n            \n          \n          \n            3\n          \n          \n            March 17, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Why is the .platform.app.yaml file separate from the .platform folder?\n            \n          \n          \n            3\n          \n          \n            May 15, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I remove the \"sent via platform.sh\" in my emails\n            \n          \n          \n            2\n          \n          \n            May 8, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              What is Git? How to use it?\n            \n          \n          \n            2\n          \n          \n            May 6, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How are mounts in .platform.app.yaml sized?\n            \n          \n          \n            2\n          \n          \n            March 26, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I expose non-80/443 TCP port to the Internet?\n            \n          \n          \n            2\n          \n          \n            May 17, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Is there a public product roadmap?\n            \n          \n          \n            2\n          \n          \n            May 17, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Why should I use Platform.sh over AWS?\n            \n          \n          \n            2\n          \n          \n            June 20, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How can I see the status of a bug?\n            \n          \n          \n            2\n          \n          \n            May 20, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Where could I submit feature request?\n            \n          \n          \n            2\n          \n          \n            May 17, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Is my built code counted against my global plan storage?\n            \n          \n          \n            2\n          \n          \n            April 12, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Can I SSH into my website?\n            \n          \n          \n            2\n          \n          \n            May 2, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How much storage can I add to my project?\n            \n          \n          \n            2\n          \n          \n            April 29, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              What is the routes.yaml max file size?\n            \n          \n          \n            2\n          \n          \n            March 28, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              More production environments on the project\n            \n          \n          \n            2\n          \n          \n            May 15, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              What does it mean when my environment has a \"dirty\" status?\n            \n          \n          \n            2\n          \n          \n            March 26, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Can I just have my whole project read / write and serve my PHP website from here?\n            \n          \n          \n            2\n          \n          \n            May 3, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Do you support other version control system?\n            \n          \n          \n            2\n          \n          \n            May 6, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              How do the queues in my project work? Is it only possible to have one thing building/deploying at a time?\n            \n          \n          \n            2\n          \n          \n            April 11, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Can I get a dedicated FTP/SFTP account for access to a specific directory?\n            \n          \n          \n            2\n          \n          \n            February 7, 2020\n          \n        \n        \n          \n            \n            \n            \n            \n              Can I have root permissions?\n            \n          \n          \n            2\n          \n          \n            May 3, 2019\n          \n        \n        \n          \n            \n            \n            \n            \n              Can I get FTP access to change my html pages?\n            \n          \n          \n            2\n          \n          \n            May 15, 2019\n          \n        \n    \n\n  \n\n\n  \n    next page \u2192\n  \n\n\n \n\n\n\n  \n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "If I have a custom certificate installed on my project and it expires, will there be an automatic switch to a LetsEncrypt cert?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/if-i-have-a-custom-certificate-installed-on-my-project-and-it-expires-will-there-be-an-automatic-switch-to-a-letsencrypt-cert/440", "documentId": "b217b4455547f32ccd4c67ea12543cf0d2dc1926", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  If I have a custom certificate installed on my project and it expires, will there be an automatic switch to a LetsEncrypt cert?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            letsencrypt\n          \n        \n        \n          \n            certificates\n          \n        \n        \n          \n            tls\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              January 6, 2020, 10:08am\n            \n        #1\n        \n      \n      \n        I have a custom certificate on my site. If it expires what happens?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          robert\n          \n        \n\n        \n            \n            \n              January 6, 2020, 10:07am\n            \n        #2\n        \n      \n      \n        Yes. If you do not actively replace your custom certificate, Platform.sh will replace it with a LetsEncrypt certificate.\nIn the case of a customer certificate, if you deploy within 7 days prior to its expiration, Platform.sh will deploy a new LetsEncrypt certificate to prevent certificate expiry.\nIf you want to replace your expiring custom certificate with another custom certificate, you\u2019re advised to do this earlier than 7 days prior to the current cert\u2019s expiry.\nIf you\u2019re already using a LetsEncrypt certificate, redeploying in the 30 days before expiry will refresh the LetsEncrypt certificate.\nIn all cases, site owners need to make plans for redeploying  to keep their certificates fresh.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Reverse Proxy rules in router", "section": "Questions & Answers", "url": "https://community.platform.sh/t/reverse-proxy-rules-in-router/479", "documentId": "16641cf3a82869ba95d31be420856dcb580a5aa0", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Reverse Proxy rules in router\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            routes-yaml\n          \n        \n    \n\n\n\n\n  \n      \n        \n          DanEEStar\n          \n        \n\n        \n            \n            \n              February 29, 2020,  3:23pm\n            \n        #1\n        \n      \n      \n        Is it possible to make Reverse Proxy rules in the routes.\nI would like to Reverse Proxy to a legacy application for some parts which cannot be migrates easily to platform sh\nAs far as I saw I can only add \u201credirect\u201d rules.\nIn the Netlify documentation I found that there you can configure something that they call \u201crewrite\u201d rules:  https://docs.netlify.com/routing/redirects/rewrites-proxies/\nThis is exactly the thing that I imagine having in platform sh\nFor other purposes it would be great to have Reverse Proxy rules which can proxy to a WebSocket endpoint: https://www.nginx.com/blog/websocket-nginx/\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              March 2, 2020,  9:33pm\n            \n        #2\n        \n      \n      \n        At this time the router only supports redirects.  You can do rewrites o the application container in .platform.app.yaml.  See:\nhttps://docs.platform.sh/configuration/app/web.html#how-can-i-rewrite-an-incoming-request-without-a-redirect\nThat cannot forward to an external server directly, however.\nAnother option would be to use a Varnish service, which you can configure to do whatever kind of request fiddling you want:\nhttps://docs.platform.sh/configuration/services/varnish.html\nAssuming your legacy application is on a 3rd party host, I think Varnish is probably your best option at the moment.\nIf your project is a multi-app setup with new and old applications both present in separate applications, you can do path-based routing to map some requests to the old app container and some to the new app container.  See:\nhttps://docs.platform.sh/configuration/routes/redirects.html\nCheers.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to git push without rebuilding?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-to-git-push-without-rebuilding/516", "documentId": "bf2ce447dce4b1e79b568605f14f83dacfd6ab50", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to git push without rebuilding?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          miklosmatyas\n          \n        \n\n        \n            \n              April 11, 2020,  2:13pm\n            \n        #1\n        \n      \n      \n        How can I push a commit without rebuilding the app? It takes long time.\nNo config change just css.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              April 13, 2020,  2:10pm\n            \n        #2\n        \n      \n      \n        Any change to the files on disk will result in a new build if pushed to an active branch.  That\u2019s to ensure all changes are \u201cclean\u201d, that is, the deployed application is always in a predictable state.\nWe automatically cache most language package managers so that re-installing those should be as fast as possible.\nIf you have custom build tasks that are slower than you\u2019d like, you can cache those manually using the build cache directory.  See https://docs.platform.sh/configuration/app/build.html#build-hook for the docs, and https://docs.platform.sh/languages/php/redis.html for an example script.\nIf what you want is to minimize the time that your local terminal is blocked, you can run platform push -W.  The -W is short for --no-wait, and does just that; it kicks off the push and build process but then disconnects so that it doesn\u2019t block your shell.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          miklosmatyas\n          \n        \n\n        \n            \n              April 14, 2020,  1:03pm\n            \n        #3\n        \n      \n      \n        Thank you, Crell.\nI see now.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to access PostgreSQL credentials on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-access-postgresql-credentials-on-platform-sh/150", "documentId": "feaf516e20298ab8982e162b31592a32be1df575", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to access PostgreSQL credentials on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            credentials\n          \n        \n        \n          \n            config-reader-php\n          \n        \n        \n          \n            postgresql\n          \n        \n        \n          \n            databases\n          \n        \n        \n          \n            php\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              April 16, 2019,  6:14pm\n            \n        #1\n        \n      \n      \n        Goal:\nAccess credentials for PostgreSQL from within a Platform.sh application using PHP.\nAssumptions:\n\nan active Platform.sh project\nproperly configured .platform/services.yaml for the given service\n\nSSH key configured on account if developing locally\nPostgreSQL installed if developing locally\nproperly configured PostgreSQL relationship like so, in .platform.app.yaml:\n\nrelationships:\n    postgresql: 'postgresql:postgresql'\n\nIf developing locally, remember to first open a tunnel to the project environment using the Platform CLI.\n$ platform tunnel:open &amp;&amp; export PLATFORM_RELATIONSHIPS=\"$(platform tunnel:info --encode)\"\n\nThis will open an SSH tunnel to your current Platform.sh environment and expose a local environment variable that mimics the relationships array on Platform.sh. Check the Platform.sh documentation and How to develop locally on Platform.sh with a tethered connection for more information.\nProblems\nPlatform.sh service credentials are made available to applications as the PLATFORM_RELATIONSHIPS environment variable, which is a base64-encoded JSON string that has to be decoded before it can be used.\nThere are two primary options for accessing service credentials on Platform.sh that can be used within an application:\n\nUsing the Platform.sh Config Reader library\n\nAccessing environment variables directly\n\nSteps (Config Reader)\n1. Install the library\nInstall the configuration library. See the documentation for minimum requirements.\n$ composer install platformsh/config-reader\n\n2. Create a Config object\nCreating a Config object provides access to the Platform.sh environment.\nuse Platformsh\\ConfigReader\\Config;\n\n$config = new Config();\n\n3. Read the credentials\n// Get the credentials to connect to the PostgreSQL service.\n$credentials = $config-&gt;credentials('postgresql');\n\nSteps (Manual)\n1. Load and decode the environment variable\n$relationships = json_decode(base64_decode(getenv('PLATFORM_RELATIONSHIPS')), TRUE);\n\n2. Read the credentials\n$credentials = $relationships['postgresql'];\n\nUse:\npath is the database name that will be needed to connect. Pass the needed properties to your PostgreSQL library\u2019s setup routine in your application. Most of the time the other values may be ignored.\nIn either case, credentials is now an object matching the relationship JSON object.\n{\n  \"username\": \"main\",\n  \"scheme\": \"pgsql\",\n  \"service\": \"postgresql\",\n  \"ip\": \"169.254.231.161\",\n  \"hostname\": \"tkydopuhmksuhglz7ox4x4de6m.postgresql.service._.eu-3.platformsh.site\",\n  \"cluster\": \"rjify4yjcwxaa-master-7rqtwti\",\n  \"host\": \"postgresql.internal\",\n  \"rel\": \"postgresql\",\n  \"path\": \"main\",\n  \"query\": {\n    \"is_master\": true\n  },\n  \"password\": \"main\",\n  \"type\": \"postgresql:11\",\n  \"port\": 5432\n}\n\nConclusions:\nUsing either the language-specific Platform.sh Configuration library or direct access methods for environment variables, an application can get PostgreSQL credentials in PHP.\nPlatform.sh supports configuration libraries for multiple languages. The PHP configuration library can be useful for connecting to PostgreSQL without creating the full DSN string using FormattedCredentials:\n// Define formatted credentials\n$formatted = $config-&gt;FormattedCredentials(\"postgresql\", \"pdo_pgsql\")\n\nThe APIs for each language are written to be as consistent as possible, but seek out each library\u2019s documentation for specific differences.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    How to migrate a PostgreSQL database from Heroku to Platform.sh\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Is there a way to change the parent environment?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/is-there-a-way-to-change-the-parent-environment/295", "documentId": "aee1f3d85d9a5884af90c8afe960fb6c14c2a8a4", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Is there a way to change the parent environment?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              June 1, 2019,  6:01pm\n            \n        #1\n        \n      \n      \n        And, if I do so, will I lose data?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          robert\n          \n        \n\n        \n            \n              June 1, 2019,  5:53pm\n            \n        #2\n        \n      \n      \n        Using the CLI:\nplatform environment:info parent NEW_PARENT\nNo data will be lost.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I reset or empty a service?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-reset-or-empty-a-service/381", "documentId": "d6b4e6cf8a8606cf5d57c740d1115e6c24ae709f", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I reset or empty a service?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              August 26, 2019,  5:20pm\n            \n        #1\n        \n      \n      \n        I have totally messed up my database\u2019s data and schema.  Can I just drop it and start fresh?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              August 26, 2019,  5:48pm\n            \n        #2\n        \n      \n      \n        Some services offer a native way to run \u201cdelete all\u201d on data, in which case that is the preferred method.\nIf that is difficult or not viable for some reason (for instance, on an SQL database where the schema itself cannot be dropped on Platform.sh), it\u2019s possible to create a new service and use that instead.\nThe storage for any service or application on Platform.sh is keyed to the service\u2019s name.  Changing the service or application name creates a new service with a new, empty storage allocation.  By the same token, removing a name will result in the data partition for that service being deleted.  Do not change the name of a service unless you really intend to wipe all of its data, because that is exactly what will happen.\nApplication containers\nTo wipe all data from an application, change the name key in .platform.app.yaml.  For example, change\n# .platform.app.yaml\n\nname: app\n\nto\n# .platform.app.yaml\n\nname: myapp\n\nThat will result in a new app container being created, with a new disk, that has all the same code but new data.  Note that you will also need to update the upstream in routes.yaml:\nhttps://{default}/:\n    type: upstream\n    upstream: myapp\n\nService containers\nTo wipe data from a service container, change the name of the service in services.yaml.  For example, change\nmydb:\n  type: mariadb:10.2\n  disk: 2048\n\nto\nmydb2:\n  type: mariadb:10.2\n  disk: 2048\n\nThat will result in a brand new empty MariaDB service named mydb2, and the old mydb service will be deleted entirely.\nYou will then need to also update the relationships in .platform.app.yaml to point to the new service name, but you do not need to change the relationship name.\n# .platform.app.yaml\n\nrelationships:\n    database: 'mydb2:mysql'\n\nAfter you commit and push your changes, the project will have deleted the mydb service and created a new, empty mydb2 service.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Why are my Let's Encrypt certificates failing to provision on my development environments?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/why-are-my-lets-encrypt-certificates-failing-to-provision-on-my-development-environments/459", "documentId": "1e7cc51d340e8d2f5764f5b798f786bd75d0e551", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Why are my Let's Encrypt certificates failing to provision on my development environments?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            letsencrypt\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              February 12, 2020,  3:11pm\n            \n        #1\n        \n      \n      \n        I\u2019ve noticed that occasionally Let\u2019s Encrypt certificates will fail to provision on some of my development environments.\nThe most recent example I have of this is when I\u2019ve been working on the adding-emphemeral-redis branch of my project. They fail to provision on that branch, but not on any of my other environments.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              February 12, 2020,  4:06pm\n            \n        #2\n        \n      \n      \n        In your case, I believe the issue is due to the length of the URLs that are being generated by Platform.sh based on the name of the branch.\nLet\u2019s Encrypt can only handle a maximum of 64 characters, and the full URL of your project PLATFORM_ENVIRONMENT-PLATFORM_PROJECT.REGION.platformsh.site probably puts you at 67 characters.\n\n\nPLATFORM_ENVIRONMENT = PLATFORM_BRANCH + 7\n\nPLATFORM_PROJECT = 13\n\nREGION = 2-4\n\nplatformsh.site = 15\nextra characters (. &amp; -) = 4\n\nKeep your branch names to under 20 characters going forwards and you should no longer have this issue.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Is it possible to upsize my project plan using the CLI?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/is-it-possible-to-upsize-my-project-plan-using-the-cli/376", "documentId": "196007c8b956aab3959ad91aa3b1d5a09a347a48", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Is it possible to upsize my project plan using the CLI?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            upsize\n          \n        \n        \n          \n            billing\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              August 19, 2019,  6:42am\n            \n        #1\n        \n      \n      \n        I\u2019d like to automate my plan size changes so that I can trigger upsizes and downsizes. Can this be done with the CLI?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          robert\n          \n        \n\n        \n            \n            \n              August 19, 2019,  6:45am\n            \n        #2\n        \n      \n      \n        Yes, you can do this with the platform subscription:info command. The shortcut for that command is platform s:info, and you can use it like this: platform s:info plan 2xlarge. If you add the -p flag you can specify the project ID. Here are the full details of the command:\nplatform help subscription:info\nCommand: subscription:info\nDescription: Read or modify subscription properties\n\nUsage:\n platform subscription:info [-s|--id ID] [--date-fmt DATE-FMT] \\\n[--format FORMAT] [--columns COLUMNS] [--no-header] \\\n[-p|--project PROJECT] [--host HOST] [--] [&lt;property&gt;] [&lt;value&gt;]\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "What's the correct route conf for a websocket?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/whats-the-correct-route-conf-for-a-websocket/472", "documentId": "034ce7c2e2242033cae986043c6be27b8dbd03f9", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  What's the correct route conf for a websocket?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          benc\n          \n        \n\n        \n            \n              February 24, 2020, 11:10am\n            \n        #1\n        \n      \n      \n        Hi,\nI\u2019m trying to run a django/channels/daphne websocket. I believe I\u2019ve got the backend set up correctly - at least, it works locally.\nI\u2019m trying to connect from the front end via JS:\nvar voteSocket = new WebSocket('wss://' + window.location.host + '/sync/votes/');\n\u2026which gives me a 404, presumably because the URI isn\u2019t declared in routes.yaml\nIf I add that route though, I get a deploy error:\nroutes.key: 'wss://{default}/sync/votes/' scheme is not one of http, https\nAnd if I change the frontend JS to use a https URL, the browser complains that:\n\nThe URL\u2019s scheme must be either \u2018ws\u2019 or \u2018wss\u2019. \u2018https\u2019 is not allowed.\n\nSo\u2026 how do I resolve that conflict? How do I declare a route that can be used as a websocket?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          alassier\n          \n        \n\n        \n            \n              March 18, 2020,  9:27pm\n            \n        #2\n        \n      \n      \n        I\u2019m having the same issue, is there any news on that ?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          alassier\n          \n        \n\n        \n            \n              March 19, 2020,  1:58pm\n            \n        #3\n        \n      \n      \n        The support told me that\n\nWe convert that for you. wss:// is not a valid path in our configurations.\n\nI also had a 404 error and that meant that the request hit the server but I had not well configured the locations. Now everything is working fine. (Also with django / channels back and nuxt / vuejs front)\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to rely on a PKI (Public Key Infrastructure) on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-rely-on-a-pki-public-key-infrastructure-on-platform-sh/80", "documentId": "0942089cb54bdb3a63f87e21692cb0ee6ceb0234", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to rely on a PKI (Public Key Infrastructure) on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            csr\n          \n        \n        \n          \n            authentication\n          \n        \n        \n          \n            openssl\n          \n        \n        \n          \n            routes-yaml\n          \n        \n    \n\n\n\n\n  \n      \n        \n          ralt\n          \n        \n\n        \n            \n            \n              March 14, 2019,  9:06am\n            \n        #1\n        \n      \n      \n        Goal\nUsing public key infrastructure (PKI) on your Platform.sh project for authentication.\nBackground\nPKI is used to:\n\ncentralize the authentication process\nautomatically provide new accounts for authentication\navoid a dependency on a centralized authentication server which might not be available at all times\nautomatically expire accounts for authentication after a given period (unless they refresh)\n\nPKI starts with the root certificate authority who keeps a private key and a certificate. The certificate is public, and can be used to verify users\u2019 certificates.\nWhen a new user (automated or not) needs a new certificate, they:\n\ngenerate a private key\ngenerate a Certificate Signing Request (CSR) that is sent to the root certificate authority\n\nThe root certificate authority receives the CSR, validates that the user is valid, and returns a signed certificate to the user. The user can then use this signed certificate to authenticate.\nWhen a server wants to authenticate a certificate, it uses the root certificate authority\u2019s certificate to verify the signature in the user\u2019s certificate. This verification can be done on Platform.sh, which is what this How-To will show.\nAssumptions\nYou will need:\n\nA local git repository that has the Platform.sh project as a git remote\nA working application setup on the Platform.sh project\nopenssl\n\nSteps\n1. Create a PKI\nCreate the certificate authority private key and certificate\nCreate the private key that the certificate authority must keep private.\n$ openssl genrsa -out /tmp/rootCA.key 4096\nGenerating RSA private key, 4096 bit long modulus\n.....++\n.................++\n$\n\nThe key will look similar to this:\n$ head -n2 /tmp/rootCA.key \n-----BEGIN RSA PRIVATE KEY-----\nMIIJJwIBAAKCAgEAyxCraEAvZUnGZ1OVAynDVCjp0qGZvI0nHPwHBxYH5eJ96pB6\n$ \n\nBased on this, create the public certificate:\n$ openssl req -x509 -new -nodes -key /tmp/rootCA.key -sha256 -days 365 -out /tmp/rootCA.crt\n\nPass the previously-created key.\nopenssl will ask a few questions, they\u2019re not important for the purpose of this How-To.\nThe public certificate will look similar to this:\n$ head -n2 /tmp/rootCA.crt \n-----BEGIN CERTIFICATE-----\nMIIFXTCCA0WgAwIBAgIJAPs0rURM8vWtMA0GCSqGSIb3DQEBCwUAMEUxCzAJBgNV\n$\n\nCreate the first user\u2019s private key and CSR\nNow that the certificate authority is setup, create a user\u2019s private key and CSR.\nThis creates the private key:\n$ openssl genrsa -out /tmp/user.key 4096\nGenerating RSA private key, 4096 bit long modulus\n...........................++\n.++\n$\n\nAnd this creates the CSR:\n$ openssl req -new -key /tmp/user.key -out /tmp/user.csr\n\nopenssl will ask again some questions that are not important for the purpose of this How-To.\nCreate the first user\u2019s public certificate\nBased on the explanation above, use the root certificate authority\u2019s private key to sign the CSR, which creates a new public certificate for the user.\n$ openssl x509 -req -in /tmp/user.csr -CA /tmp/rootCA.crt -CAkey /tmp/rootCA.key \\\n-CAcreateserial -out /tmp/user.crt -days 30 -sha256\n\nThis creates a public certificate that the user can use, valid for 30 days.\nNote that only the user can use this certificate to authenticate, because it needs the private key (\u201cuser.key\u201d above).\nEt voila! We now have a PKI with one user.\n2. Authenticate users of the PKI on Platform.sh\n\nWe\u2019re now getting to the easy part of this How-To: we\u2019re going to authenticate our user on Platform.sh using TLS client certificates.\nFor this test, we\u2019re going to need 3 things:\n\nThe root certificate authority\u2019s public certificate (rootCA.crt above)\nThe user\u2019s private key (user.key above)\nThe user\u2019s public certificate (user.crt above)\n\nThe first step is configuring your Platform.sh project to authenticate users by providing the root certificate authority\u2019s public certificate, as such in the .platform/routes.yaml:\nhttps://{default}/:\n    type: upstream\n    upstream: app:http\n    tls:\n        client_authentication: \"require\"\n        client_certificate_authorities:\n            - !include\n                type: string\n                path: rootCA.crt\n\nPut the rootCA.crt file in the .platform/ folder.\nCommit and push these changes:\n$ git add .platform/routes.yaml .platform/rootCA.crt\n$ git commit -m \"Enable TLS client certificates authentication\"\n$ git push platform master\n\nAnd that\u2019s it!\nTest the changes:\n$ curl https://my-project.com\ncurl: (35) error:14094412:SSL routines:ssl3_read_bytes:sslv3 alert bad certificate\n$ curl --key user.key --cert user.crt https://my-project.com\nIt's working!\n\nConclusion\nSetting up a Platform.sh project to authenticate users using PKI requires only a few lines of code added to the .platform/routes.yaml file.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Latest How-to Guides topics", "section": "Platform.sh Community", "url": "https://community.platform.sh/c/how-to?page=3", "documentId": "cd72ab5b5fdbfaf93a0805e30aadd08d0add3f0a", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n\n\n\n  \n\n    \n      How-to Guides\n  \n  \n\n\n\n  \n\n    \n      \n        Topic\n        Replies\n        Activity\n      \n    \n\n    \n      \n    \n\n  \n\n\n\n \n\n\n\n  \n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "All Time", "section": "Platform.sh Community", "url": "https://community.platform.sh/c/questions-answers?page=3&per_page=50", "documentId": "3014619798e24b78c2f3f723b1fcb8790afbc3f8", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n\n\n\n  \n\n    \n      Questions &amp; Answers\n  \n  \n\n\n\n  \n\n    \n      \n        Topic\n        Replies\n        Activity\n      \n    \n\n    \n      \n    \n\n  \n\n\n\n \n\n\n\n  \n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Connecting to MongoDB with GUI tool like Robo 3T or Mongo Compass", "section": "Questions & Answers", "url": "https://community.platform.sh/t/connecting-to-mongodb-with-gui-tool-like-robo-3t-or-mongo-compass/544", "documentId": "bca1c5c8018db2e0d328df7b851868cbb8679cdf", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Connecting to MongoDB with GUI tool like Robo 3T or Mongo Compass\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          miketamis\n          \n        \n\n        \n            \n            \n              April 26, 2020,  1:57am\n            \n        #1\n        \n      \n      \n        Hey,\nIm wondering how I can connect via a GUI tool like Robo 3T or Mongo Compass to have a look in the database.\nIm able to tunnel into the database and use the mongo cli like so:\n% platform tunnel:open\n% mongo mongodb://main:main@localhost:30000/main\n\n^ this works\n% mongodump --port 30000 -u main -p main --authenticationDatabase main --db main\n\n2020-04-26T13:02:47.152+1200    writing main.startrek to \n2020-04-26T13:02:47.302+1200    done dumping main.startrek (108 documents)\n\n^ this also works\nbut if I try to connect via a GUI tool it doesn\u2019t, I\u2019m unsure what I\u2019m doing wrong because the tunnel is working because I can dump the database through it, as well as query it through mongo cli, just not through a GUI tool.\n\nScreen Shot 2020-04-26 at 1.56.46 PM.png1640\u00d71420 434 KB\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "For persistent Redis, what persistence methods does Platform.sh employs? RDB, AOF, or both?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/for-persistent-redis-what-persistence-methods-does-platform-sh-employs-rdb-aof-or-both/517", "documentId": "842de7e01ad5a28e61a33d4546d77eba5fd3b0ef", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  For persistent Redis, what persistence methods does Platform.sh employs? RDB, AOF, or both?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              April 13, 2020, 12:03pm\n            \n        #1\n        \n      \n      \n        https://redis.io/topics/persistence\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          damz\n          \n        \n\n        \n            \n            \n              April 13, 2020, 12:03pm\n            \n        #2\n        \n      \n      \n        AOF, with a background rewrite at 50%\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to upload and download files to your application (SFTP/RSYNC)", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-upload-and-download-files-to-your-application-sftp-rsync/72", "documentId": "1f15be96d7c39020a3eaf2f2beaec03365346cb7", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to upload and download files to your application (SFTP/RSYNC)\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            rsync\n          \n        \n        \n          \n            transfer\n          \n        \n        \n          \n            sftp\n          \n        \n        \n          \n            files\n          \n        \n        \n          \n            ssh\n          \n        \n    \n\n\n\n\n  \n      \n        \n          nls\n          \n        \n\n        \n            \n            \n              March 11, 2019,  3:50pm\n            \n        #1\n        \n      \n      \n        Goal\nThis guide shows how to upload and download files to your application using sftp and rsync.\nAssumptions\nTo complete this, you will need:\n\nA working application setup on a Platform.sh project\nThe Platform.sh CLI tool installed\nYour ssh key loaded in your ssh agent and configured in the Platform.sh dashboard\n\n\nrsync installed on your system\nor scp installed on your system\nor an sftp GUI client like FileZilla\n\n\nProblems\nPlatform.sh provides upload and download mechanisms through the CLI but it can be handy to use native tools instead.\nSteps\n\n\nAdd a mount point to your application\nBy default, all files deployed to Platform.sh through git are read-only. Only the folders defined as mounts are writeable.\nOpen ./.platform.app.yaml and add a mount:\nmounts:\n 'web/uploads':\n     source: local\n     source_path: uploads\n\nPlease refer to the mounts documentation if needed.\nPush your configuration change:\ngit add .platform.app.yaml\ngit commit -m \"Add mount\"\ngit push platform master\n\n\n\nCheck the mount point is writeable\nplatform ssh\nweb@&lt;environment id&gt;:~$ touch web/uploads/test.txt\n\nThe command above shouldn\u2019t trigger any error.\n\n\nGet the environment ssh endpoint\nBoth rsync and sftp protocols use ssh as the transfer layer. Each Platform.sh environment inside a project has its own ssh endpoint.\nIf you have the Platform.sh CLI installed, you can run platform ssh --pipe to get the endpoint.\nIf not, log into your project dashboard and click on the SSH button for the environment you want to get the endpoint:\n\nOur endpoint is &lt;project id&gt;-master-7rqtwti--app@ssh.&lt;region&gt;.platform.sh\n\n\nNote: All the next commands will be using platform ssh --pipe as the endpoint. Feel free to replace with the full connection string if needed.\n\n\nCreate test files\nLet\u2019s create some files to play with:\nmkdir -p web/uploads\ntouch web/uploads/test{0001..0010}.txt\n\n\n\nrsync\n\n\nUpload a file or a directory\nTo upload a directory, make sure you don\u2019t specify the source folder (uploads in this case) in the destination. Take a look at man rsync to view all available options.\nrsync -avz web/uploads \"$(platform ssh --pipe)\":web/\n\nThe log should list all files that were uploaded:\nsending incremental file list\nuploads/\nuploads/test0001.txt\n...\nuploads/test0010.txt\n\nsent 603 bytes  received 210 bytes  325.20 bytes/sec\ntotal size is 0  speedup is 0.00\n\nWe could have synced only the files with the following command:\nrsync -avz web/uploads/* rsync -avz web/uploads \"$(platform ssh --pipe)\":web/uploads/\n\nAs rsync is transferring only the differences between the source and destination, relaunching the same command will end up in an empty transfer.\n\n\nDownload a file or a directory\nRemove your local files:\nrm web/uploads/*\n\nWe can now download them from Platform.sh:\nrsync -avz \"$(platform ssh --pipe)\":web/uploads web/\n\nYou can see in the output that all files are transferred back to our host.\n\n\nscp\nRemove the files on Platform.sh if you have followed the rsync steps:\nplatform ssh \"rm web/uploads/*\"\n\n\n\nUpload a file or a directory\nTo upload a file, specify the full path:\nscp web/uploads/test0001.txt \"$(platform ssh --pipe)\":web/uploads\nTo upload a directory, add the -r argument:\nscp -r web/uploads \"$(platform ssh --pipe)\":web/\nThe output should list the 10 files being transferred. Note that scp is not using incremental transfer. All 10 files are being transferred even if they already exist at the destination.\n\n\nDownload a file or a directory\nRemove a local file first:\nrm web/uploads/test0001.txt\n\nTo download a file:\nscp \"$(platform ssh --pipe)\":web/uploads/test0001.txt web/uploads/\nTo download a directory:\nscp -r \"$(platform ssh --pipe)\":web/uploads web/\n\n\nsftp\nRemove the files on Platform.sh if you have followed the previous steps:\nplatform ssh \"rm web/uploads/*\"\n\n\n\nConfigure your client\nAdd a new bookmark to your client with the following configuration (based on our endpoint):\nhostname: ssh.eu-3.platform.sh\nport: 22\nprotocol: SFTP\nuser: &lt;project id&gt;-master-7rqtwti--app\nkey/identity file: `/path/to/your/key\n\nFilezilla needs to have a .pem key file to list it.\n\nConnect to the site. You should be presented with the content of the root folder of your app.\n\n\n\nUpload a file or a directory\nDrag and drop files and folders from your computer to the mount:\n\n\n\nDownload a file or a directory\nDrag and drop files and folders from the mount to your computer. Easy enough.\n\n\nConclusion\nTransferring and managing files on your Platform.sh environments can be done using native tools that use ssh, scp, rsync, or sftp.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Expose Elasticsearch over HTTP", "section": "Questions & Answers", "url": "https://community.platform.sh/t/expose-elasticsearch-over-http/510", "documentId": "ea66e734a478c60c3f9403db0cfc9785b122737d", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Expose Elasticsearch over HTTP\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            elasticsearch\n          \n        \n    \n\n\n\n\n  \n      \n        \n          mglaman\n          \n        \n\n        \n            \n              March 27, 2020,  7:45pm\n            \n        #1\n        \n      \n      \n        Is there a way to expose the Elasticsearch service for READ over HTTP through a route?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Where is my database storage going to?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/where-is-my-database-storage-going-to/467", "documentId": "281b3326485c6b8307296f985348a158e2cb5b81", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Where is my database storage going to?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            import\n          \n        \n        \n          \n            disk\n          \n        \n        \n          \n            db\n          \n        \n        \n          \n            usage\n          \n        \n        \n          \n            size\n          \n        \n    \n\n\n\n\n  \n      \n        \n          matthias-van-woensel\n          \n        \n\n        \n            \n            \n              February 20, 2020,  5:59pm\n            \n        #1\n        \n      \n      \n        Question\nI\u2019ve followed the following article to check my database storage usage:\n\n  \n    \n    \n    How to determine database usage of an environment How-to Guides\n  \n  \n    Goal\nDetermine approximate database usage of a Platform.sh project using the Platform.sh CLI tool. \nAssumptions\n\nOne or more Platform.sh projects\n\nPlatform.sh CLI tool installed locally\n\nSSH key configured with the project account(s)\n\nProblems\nAs a general rule, the database service should have at least 15% of disk space available on a Platform.sh project environment, so it is useful to be able to approximate the current disk usage of a project\u2019s database(s). \nSteps\n1. Log in to Platform CLI\n$ p\u2026\n  \n\n\nBut the size it reports seems wrong to me.\nI\u2019ve imported a 3GB sized database backup. But when I check platform db:size it is reporting 9GB.\nChecking database service db...\n\n+----------------+-----------------+--------+\n| Allocated disk | Estimated usage | % used |\n+----------------+-----------------+--------+\n| 14.6 GiB       | 9.4 GiB         | ~ 64%  |\n+----------------+-----------------+--------+\n\nWhy the big difference?\nAnswer\n\nThere is some overhead in operating databases so that accounts for some disk space. (e.g. on mysql information_schema/mysql, etc\u2026)\nIf you just measured the file that you import, be aware that the space used in the file is always smaller than when it is unpacked into the database. Databases are faster and more flexible than a flat file. But they create additional data to be able to do this.\nThe platform db:size makes a good estimate on how much is used, but it can deviate by a few percentages.\nInnoDB does not reclaim removed space. So everything you once inserted and removed, is still there. This is especially true for cache tables (which get a lot of insert/deletes).\n\ndb:size actually has a trick to help you identify wasted space and clean those up.\nplatform db:size --cleanup -p YOUR_PROJECT_ID -e master\n\nChecking database service db...\n\n+----------------+-----------------+--------+\n| Allocated disk | Estimated usage | % used |\n+----------------+-----------------+--------+\n| 14.6 GiB       | 9.4 GiB         | ~ 64%  |\n+----------------+-----------------+--------+\n\nWarning\nThis is an estimate of the database's disk usage. It does not represent its real size on disk.\n\nYou can save space by running the following commands during a maintenance window:\n\nALTER TABLE `main`.`cache_page` ENGINE=\"InnoDB\";\nALTER TABLE `main`.`xmlsitemap` ENGINE=\"InnoDB\";\nALTER TABLE `main`.`cache_block` ENGINE=\"InnoDB\";\nALTER TABLE `main`.`queue` ENGINE=\"InnoDB\";\nALTER TABLE `main`.`cache_advagg_aggregates` ENGINE=\"InnoDB\";\nALTER TABLE `main`.`sessions` ENGINE=\"InnoDB\";\nALTER TABLE `main`.`batch` ENGINE=\"InnoDB\";\nALTER TABLE `main`.`field_revision_field_address_line_3` ENGINE=\"InnoDB\";\nALTER TABLE `main`.`field_data_field_paragraph_background` ENGINE=\"InnoDB\";\nALTER TABLE `main`.`field_data_field_bs_comms` ENGINE=\"InnoDB\";\n\nWarning: Running these may lock up your database for several minutes.\nOnly run these when you know what you're doing.\n\nThat should clean up some storage, and you can even run those queries in a cron once a week to keep it nice and clean (Sunday early morning for example).\nRecommendations\n\nMove cache tables to a dedicated Redis instance that can take the load off your database.\nMake sure you have less than 80% disk used on databases. Databases don\u2019t work well with little disk space.\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to configure HTTP Strict Transport Security (HSTS) on your project", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-configure-http-strict-transport-security-hsts-on-your-project/70", "documentId": "26490348082b2a5b21667ba433c64e70a8d1c119", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to configure HTTP Strict Transport Security (HSTS) on your project\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            hsts\n          \n        \n        \n          \n            https\n          \n        \n        \n          \n            security\n          \n        \n    \n\n\n\n\n  \n      \n        \n          nls\n          \n        \n\n        \n            \n            \n              March 11, 2019,  5:31pm\n            \n        #1\n        \n      \n      \n        Goal\nEnable HSTS on your Platform.sh project. Read more about HSTS on Wikipedia.\nAssumptions\nYou will need:\n\nA local git repository that has the Platform.sh project as a git remote\nA working application setup on the Platform.sh project\n\nThis how-to works whether you use the auto-generated domains on platformsh.site or your own custom domain.\nSteps\n1. Check https is enabled\nThe ./.platform/routes.yaml should contain only the https directive:\nhttps://{default}/:\n    type: upstream\n    upstream: app:http\n\n2. Add the strict_transport_security configuration item to your route file:\n./.platform/routes.yaml\nhttps://{default}/:\n    type: upstream\n    upstream: app:http\n    tls:\n        strict_transport_security:\n            enabled: true\n            include_subdomains: true\n            preload: true\n\nPlease refer to the Platform.sh documentation for details about the different parameters.\n3. Commit and deploy the change\ngit add .platform/routes.yaml\ngit commit -m \"Enable HSTS\"\ngit push platform master\n\n4. Check HSTS is enabled\nCheck the response headers being sent by the server. This can checked with the browser console or curl:\n$ curl -I https://master-7rqtwti-&lt;project id&gt;.&lt;region&gt;.platformsh.site\nHTTP/2 200\n...\nstrict-transport-security: max-age=31536000; includeSubDomains; preload\n...\n\nAny request to the http endpoint will be upgraded to https:\n$ curl -I http://master-7rqtwti-&lt;project id&gt;.&lt;region&gt;.platformsh.site\nHTTP/1.1 301 Moved Permanently\n...\nLocation: https://master-7rqtwti-&lt;project id&gt;.&lt;region&gt;.platformsh.site/\nStrict-Transport-Security: max-age=0\n...\n\nConclusion\nAs Platform.sh configuration already includes the strict_transport_security parameter, enabling HSTS was a simple configuration change without the need to customize the response directly in your application.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to run a Rust web application on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-run-a-rust-web-application-on-platform-sh/119", "documentId": "a8cf5d14b167a95bdcbede44dde95523e2e5c2a7", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to run a Rust web application on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            rust\n          \n        \n        \n          \n            app-yaml\n          \n        \n        \n          \n            routes-yaml\n          \n        \n    \n\n\n\n\n  \n      \n        \n          ludoge\n          \n        \n\n        \n            \n            \n              March 12, 2019,  2:45pm\n            \n        #1\n        \n      \n      \n        Goal\nThis guide shows how to deploy a simple Rust web app on Platform.sh.\nAssumptions\nTo complete this, you will need:\n\nAn empty Platform.sh project\nThe Platform.sh CLI tool installed\nYour ssh key loaded in your ssh agent and configured in the Platform.sh dashboard\n\nThe Rust environment installed\n\nProblems\nPlatform.sh does not provide a dedicated Rust runtime container. It will thus be necessary to install Rust as the project is built.\nSteps\n1. Create a Rust application\nCreate a new Rust project:\ncargo new platform_howto &amp;&amp; cd platform_howto\n\nSet the platform remote:\nplatform project:set-remote &lt;project id&gt;\n\nAdd the following under [dependencies] in Cargo.toml:\nwarp = \"0.1\"\nclap = \"2.32.0\"\n\nReplace src/main.rs with:\n#[macro_use]\nextern crate clap;\nuse clap::{Arg, App};\n\nuse warp::Filter;\n\nfn main() {\n    let args = App::new(\"HOWTO\")\n        .version(\"1.0\")\n        .author(\"Platform.sh &lt;sayhello@platform.sh&gt;\")\n        .about(\"How to run a Rust app on Platform.sh\")\n        .arg(Arg::with_name(\"port\")\n             .short(\"p\")\n             .long(\"port\")\n             .value_name(\"PORT\")\n             .help(\"Sets a custom port\")\n             .takes_value(true)\n             .required(true))\n        .get_matches();\n\n\n    // Get port from command-line arguments\n    let port = value_t!(args, \"port\", u16).unwrap_or_else(|e| e.exit());\n\n    // Match any request and return hello world!\n    let routes = warp::any().map(|| \"Hello, World!\");\n\n    warp::serve(routes)\n        .run(([127, 0, 0, 1], port));\n}\n\n\n2. Configure the application to run on Platform.sh:\nAdd the following to .platform.app.yaml:\nname: app\n\n# Any type will work here\ntype: \"php:7.3\"\n\nhooks:\n    build: |\n      set -e\n      curl https://sh.rustup.rs &gt; rustup.sh\n      sh rustup.sh -y --default-toolchain stable\n      rm rustup.sh\n      . \"$HOME/.cargo/env\"\n      cargo build --release\n\nweb:\n    upstream:\n        socket_family: tcp\n        protocol: http\n\n    commands:\n        start: |\n          target/release/platform_howto --port $PORT\n\ndisk: 1024\n\nDefine a route in .platform/routes.yaml:\n\"https://{default}/\":\n    type: upstream\n    upstream: \"app:http\"\n\nAdd an empty .platform/services.yaml file:\ntouch .platform/services.yaml\n\n3.  Add, commit and push:\ngit add .\ngit commit -m \"Rust on Platform.sh\"\ngit push platform master\n\n4. Test by visiting the URL of your project:\nplatform url\n\nWhich should open a browser tab showing Hello, World!\nConclusion\nEven without a dedicated runtime, running a Rust application on Platform.sh can be done by leveraging the build hook and the PORT variable.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    Can I use Platform.sh for a different language?\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to see your Nginx configuration file", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-see-your-nginx-configuration-file/168", "documentId": "e335c15154c295a0c25825bcd4884fdac498da77", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to see your Nginx configuration file\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            nginx\n          \n        \n        \n          \n            app-yaml\n          \n        \n        \n          \n            ssh-tunnel\n          \n        \n        \n          \n            ssh\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          robert\n          \n        \n\n        \n            \n            \n              March 18, 2019,  1:16pm\n            \n        #1\n        \n      \n      \n        Goal\nThe web directive of .platform.app.yaml is the developer\u2019s chance to configure the Nginx server for the application. Sometimes it is helpful to see exactly what is in the Nginx configuration file as a result of the values in web. This guide shows how to read the Nginx config file using the Platform.sh CLI tool.\nAssumptions\nThis guide assumes:\n\nan active application on Platform.sh\n\nA local repository with the Platform.sh project as git remote\nThe Platform.sh CLI installed locally\n\nProblems\nReading the Nginx config file is a matter of being able to make an SSH connection to your environment and then knowing where the file is.\nSteps\nThe nginx.conf file can be read with this command:\nplatform ssh 'less /etc/nginx/nginx.conf'\nConclusion\nNginx configuration is abstracted into the web directive of .platform.app.yaml, but you can still see how that gets expressed by looking at the resultant file directly.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to use the Platform.sh CLI from the web container", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-use-the-platform-sh-cli-from-the-web-container/126", "documentId": "abdf3af01a0fec72729705c62eba0fdc8dd76927", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to use the Platform.sh CLI from the web container\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            api-tokens\n          \n        \n        \n          \n            build-hook\n          \n        \n        \n          \n            env-variables\n          \n        \n        \n          \n            ssh\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          bogdan-vasilescu\n          \n        \n\n        \n            \n            \n              March 13, 2019,  2:33pm\n            \n        #1\n        \n      \n      \n        Goal\nHave the Platform.SH CLI installed and authenticated in the web container.\nAssumptions\n\nAccess to a project hosted on Platform.sh\n\nYour project account has administrator rights\nKnowledge on using the project web interface or Platform.sh CLI\n\n\nProblems\nUsing the Platform.sh CLI directly from the web (application) container can be required to automate certain tasks, like renewing the SSL certificate or triggering a snapshot based on a cron schedule.\nDue to the non-interactive deployment flow, using a regular username and password authentication is not possible. We will use token-based authentication to have the CLI installed and configured on each deployment.\nSteps\n1. Create an API token\nLog into the accounts page and navigate to Account settings &gt; API tokens page, available here. Click on Create API token. You will be prompted to enter your account password, then asked for the token name - enter a name to easily identify your token in the future, in case of multiple tokens (CLI_automated is one example).\n\nOnce done, the newly created token will be displayed at the top of the page and can be viewed later using the View link next to the token to retrieve the &lt;token string&gt;.\n\n2. Add the token as an environment variable in the project\nOnce the API token is added as an environment variable in the project, it will be automatically detected and used by the CLI tool. After the installation is done, you should see the PLATFORMSH_CLI_TOKEN variable when running env.\n\n\nOption 1: Using the web interface\nOpen the project web interface and navigate to the environment in which you want to use the CLI, then click on Configure environment and go to the Variables tab. Add a variable named env:PLATFORMSH_CLI_TOKEN and set its value to the previously created token.\n\n\n\nOption 2: Using the CLI\nIf you have the CLI tool installed and configured, you can add the variable from the command line:\nplatform variable:create -e &lt;environment name&gt; --level environment --name env:PLATFORMSH_CLI_TOKEN --sensitive true --value &lt;token string&gt;\n\nReplace the &lt;environment name&gt; and &lt;token string&gt; with the correct values for your use case.\n\n\n3. Install the CLI tool in the application container\nOnce the variable has been added to the environment, it is required to download and install the CLI tool in a build hook.\nModify .platform.app.yaml in the project to include:\nhooks:\n    build: |\n        curl -sS https://platform.sh/cli/installer | php\n\nThis will download the CLI to a known directory,  .platformsh/bin , which will be added to the PATH at runtime (via the .environment file). Redeploy your environment and log into the application container with SSH, then run platform. You should see the welcome prompt and a list of your current projects.\nConclusion\nHaving the CLI tool set up in an environment opens up further automation possibilities - renewing the SSL certificate, triggering snapshots, etc.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    How to transfer files between two different projects\n                  \n                \n                \n                  \n                    \n                    \n                    How to forward Platform.sh logs to Logz.io\n                  \n                \n                \n                  \n                    \n                    \n                    How to forward Platform.sh logs to a Splunk Indexer\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to run Minio on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-run-minio-on-platform-sh/128", "documentId": "084fe8f7da1a7c377951973385a3d8d780971ad4", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to run Minio on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            minio\n          \n        \n        \n          \n            aws-s3\n          \n        \n        \n          \n            storage\n          \n        \n        \n          \n            mounts\n          \n        \n    \n\n\n\n\n  \n      \n        \n          praburaj-dravidamani\n          \n        \n\n        \n            \n            \n              April 24, 2020,  1:07pm\n            \n        #1\n        \n      \n      \n        Goal\nMinio offers cloud file storage with an S3 compatible API. This guide shows how to deploy  it on Platform.sh.\nAssumptions\nTo complete this, you will need:\n\nAn empty Platform.sh project\nThe Platform.sh CLI tool installed\nYour  ssh  key loaded in your ssh agent and configured in the Platform.sh dashboard\n\n\nSteps\n1. Create the application directory\nCreate an empty directory and cd into it.\nmkdir minio\ncd minio\n\nInitialize git and set the  platform  Git remote:\ngit init\nplatform project:set-remote &lt;project id&gt;\n\n2. Configure the application\nMinio will be configured to store its configuration and files in mounts. Edit .platform/app.yaml to have the following contents:\nname: app\n\n# Any type will work here\ntype: \"nodejs:10\"\n\nhooks:\n    build: |\n      set -e      \n      wget https://dl.minio.io/server/minio/release/linux-amd64/minio\n      chmod +x minio\n\nmounts:\n    'minio_data':\n        source: local\n        source_path: minio_data_dir\n    'minio_config':\n        source: local\n        source_path: minio_config_dir\n\nweb:\n    upstream:\n        socket_family: tcp\n        protocol: http\n\n    commands:\n        start: |\n          ./minio server /app/minio_data --address localhost:$PORT --config-dir /app/minio_config --certs-dir /app/minio_config/certs\n\nvariables:\n    env:\n        MINIO_ACCESS_KEY: access\n        MINIO_SECRET_KEY: changeme\n\ndisk: 2048\n\nChange the MINIO_ACCESS_KEY and MINIO_SECRET_KEY values as required. Modify the disk value based on storage requirements, it should be at least 2048.\nDefine a route in  .platform/routes.yaml :\n\"https://{default}/\":\n    type: upstream\n    upstream: \"app:http\"\n\nAdd an empty  .platform/services.yaml  file:\ntouch .platform/services.yaml\n\n3. Add, commit and push:\ngit add .\ngit commit -m \"Minio configured\"\ngit push platform master\n\n4. Test by visiting the URL of your project:\nplatform url\n\nThe Minio web UI page will be displayed and can be logged in with the MINIO_ACCESS_KEY and MINIO_SECRET_KEY values specified in .platform.app.yaml previously.\n\nminio_login.jpg1436\u00d7780 26 KB\n\nConclusion\nThe Minio server and web UI are running and ready to handle file requests.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          oripekelman\n          \n        \n\n        \n            \n              March 14, 2019, 10:37am\n            \n        #2\n        \n      \n      \n        Another approach would be to compile minio from source\u2026 an even shorter :\nname: minio\ntype: golang:1.11\nhooks:\n    build:  go get -u github.com/minio/minio\ncommands:\n    start: ~/go/bin/minio server /app/minio_data --address localhost:$PORT --config-dir /app/minio_config --certs-dir /app/minio_config/certs\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to configure low-disk health notifications on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-configure-low-disk-health-notifications-on-platform-sh/121", "documentId": "83a0572422fb24f9e072814c489499a9f22904b5", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to configure low-disk health notifications on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            monitoring\n          \n        \n        \n          \n            pagerduty\n          \n        \n        \n          \n            storage\n          \n        \n        \n          \n            email\n          \n        \n        \n          \n            slack\n          \n        \n    \n\n\n\n\n  \n      \n        \n          adam-mahar\n          \n        \n\n        \n            \n            \n              March 20, 2019,  5:14pm\n            \n        #1\n        \n      \n      \n        Goal\nSet up health notifications for low-disks on project containers. These will notify when free disk space drops below 20% and below 10%, and will issue an all-clear notification when the free disk space returns above 20%.\nAssumptions\n\nYou have a project on Platform.sh\n\nYou are an admin on the project\nYou have the Platform.sh CLI tool installed\n\nProblems\nContainer storage can silently fill due to any number of reasons. This will often cause an application to experience erratic errors or cease to function entirely.\nSteps\n1. Email Notifications\n\nAdd the integration for email using the Platform CLI:\n\nplatform integration:add --type health.email --from-address you@example.com --recipients them@example.com --recipients others@example.com\n\nNote that the --from-address can be any email address you like (including one of the recipients), and you can define one or more recipients by optionally adding more recipient flags.\n2. Slack Notifications\n\nCreate a custom bot user for your Slack group, configure it for the appropriate channels, and note the API Token.\nAdd the integration for slack using the Platform CLI:\n\nplatform integration:add --type health.slack --token YOUR_API_TOKEN --channel '#channelname'\n\nThe bot will then post the notification to the channel specified by the --channel flag.\n3. PagerDuty Notifications\n\nCreate a PagerDuty integration using the Events API v2. Copy the Integration Key to use as the --routing-key flag in step (2).\nAdd the integration for PagerDuty using the Platform CLI:\n\nplatform integration:add --type health.pagerduty --routing-key YOUR_ROUTING_KEY\n\n4. What to do when you get a low-disk notification\nThere are several different options for resolving low-disk situations. For a database, depending on the application set up, you may be able to truncate a table in MySQL that is performing a logging or caching function. For an application container, you can use du -sh &lt;path&gt; to work your way through your filesystem to find if there are any particular files that are taking a lot of space that can be removed.\nAlternatively, if the space used is necessary and will continue to grow, you can change the size of your disk to resolve the low-disk situation. For the application disk, you can change this with the disk: key in your .platform.app.yaml file. For any other services, their disk sizes can be adjusted from the relevant disk: key in your .platform/services.yaml file.\nConclusion\nUsing low-disk health notification with your Platform.sh environment can help you catch outages before they happen, and can be a red flag if they do lead to an outage.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to utilize the CLI to modify already existing Git integrations", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-utilize-the-cli-to-modify-already-existing-git-integrations/144", "documentId": "4b312a549f9f07dbbd1c9a5122b68e845b7f2a88", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to utilize the CLI to modify already existing Git integrations\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            integration\n          \n        \n        \n          \n            git\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          adamb\n          \n        \n\n        \n            \n              March 14, 2019,  5:24pm\n            \n        #1\n        \n      \n      \n        Goal\nTo learn how to use the CLI for getting more information on a Git integration, also how to modify certain configuration options.\nAssumptions\n\nAccess to a project hosted on Platform.sh\n\nYour project account has administrator rights\nKnowledge on using the Platform.sh CLI\n\n\nProblems\nNone in particular. This How to is about raising awareness to the usefulness of the CLI tool.\nSteps\n1. Check what \u201cintegration\u201d commands are available\nplatform list | grep integration  \n\nintegration\n  integration:add                                Add an integration to the project\n  integration:delete                             Delete an integration from a project\n  integration:get                                View details of an integration\n  integration:list (integrations)                View a list of project integration(s)\n  integration:update                             Update an integration\n  integration:validate                           Validate an existing integration\n\n2. List the integrations added to your project\nplatform integration:list\n\n+------------------+--------+-----------------------------------------------------------------------------------------------------+\n| ID               | Type   | Summary                                                                                             |\n+------------------+--------+-----------------------------------------------------------------------------------------------------+\n| &lt;integration id&gt; | github | Repository: ...                                                                                     |\n|                  |        | Hook URL: https://&lt;region&gt;.platform.sh/api/projects/&lt;project id&gt;/integrations/&lt;integration id&gt;/hook |\n+------------------+--------+-----------------------------------------------------------------------------------------------------+\n\nView integration details with: platform integration:get [id]\n\nAdd a new integration with: platform integration:add\nDelete an integration with: platform integration:delete [id]\n\n3. Get the integration details\nplatform integration:get &lt;integration id&gt;\n\n+---------------------------------+-------------------------------------------------------------------------------------------+\n| Property                        | Value                                                                                     |\n+---------------------------------+-------------------------------------------------------------------------------------------+\n| id                              | &lt;integration id&gt;                                                                          |\n| type                            | github                                                                                    |\n| token                           | ******                                                                                    |\n| repository                      | ...                                                                                       |\n| fetch_branches                  | true                                                                                      |\n| prune_branches                  | true                                                                                      |\n| build_pull_requests             | true                                                                                      |\n| build_pull_requests_post_merge  | false                                                                                     |\n| pull_requests_clone_parent_data | true                                                                                      |\n| hook_url                        | https://&lt;region&gt;.platform.sh/api/projects/&lt;project id&gt;/integrations/&lt;integration id&gt;/hook |\n+---------------------------------+-------------------------------------------------------------------------------------------+\n\n4. Check the options and select which ones to modify\nplatform integration:update --help\n\nCommand: integration:update\nDescription: Update an integration\n\nUsage:\n platform integration:update [--type TYPE] [--token TOKEN] [--key KEY] [--secret SECRET] [--base-url BASE-URL] [--gitlab-project GITLAB-PROJECT] [--repository REPOSITORY] [--build-merge-requests BUILD-MERGE-REQUESTS] [--build-pu&gt;\n\nArguments:\n  id                                                                       The ID of the integration to update\n\nOptions:\n      --type=TYPE                                                          The integration type ('bitbucket', 'github', 'gitlab', 'hipchat', 'webhook', 'health.email', 'health.pagerduty', 'health.slack')\n      --token=TOKEN                                                        An OAuth token for the integration\n      --key=KEY                                                            A Bitbucket OAuth consumer key\n      --secret=SECRET                                                      A Bitbucket OAuth consumer secret\n      --base-url=BASE-URL                                                  The base URL of the GitLab installation\n      --gitlab-project=GITLAB-PROJECT                                      The GitLab project (e.g. 'namespace/repo')\n      --repository=REPOSITORY                                              The repository to track (e.g. 'user/repo')\n      --build-merge-requests=BUILD-MERGE-REQUESTS                          GitLab: build merge requests as environments [default: true]\n      --build-pull-requests=BUILD-PULL-REQUESTS                            Build every pull request as an environment [default: true]\n      --build-pull-requests-post-merge=BUILD-PULL-REQUESTS-POST-MERGE      Build pull requests based on their post-merge state [default: false]\n      --merge-requests-clone-parent-data=MERGE-REQUESTS-CLONE-PARENT-DATA  GitLab: clone data for merge requests [default: true]\n      --pull-requests-clone-parent-data=PULL-REQUESTS-CLONE-PARENT-DATA    Clone the parent environment's data for pull requests [default: true]\n      --resync-pull-requests=RESYNC-PULL-REQUESTS                          Re-sync pull request environment data on every build [default: false]\n      --fetch-branches=FETCH-BRANCHES                                      Fetch all branches from the remote (as inactive environments) [default: true]\n      --prune-branches=PRUNE-BRANCHES                                      Delete branches that do not exist on the remote [default: true]\n      --room=ROOM                                                          HipChat room ID\n      --url=URL                                                            Generic webhook: a URL to receive JSON data\n      --events=EVENTS                                                      A list of events to report, e.g. environment.push [default: [\"*\"]] (multiple values allowed)\n      --states=STATES                                                      A list of states to report, e.g. pending, in_progress, complete [default: [\"complete\"]] (multiple values allowed)\n      --environments=ENVIRONMENTS                                          The environment IDs to include [default: [\"*\"]] (multiple values allowed)\n      --excluded-environments=EXCLUDED-ENVIRONMENTS                        The environment IDs to exclude (multiple values allowed)\n      --from-address=FROM-ADDRESS                                          The From address for alert emails [default: \"noreply@platform.sh\"]\n      --recipients=RECIPIENTS                                              The recipient email address(es) (multiple values allowed)\n      --channel=CHANNEL                                                    The Slack channel\n      --routing-key=ROUTING-KEY                                            The PagerDuty routing key\n  -p, --project=PROJECT                                                    The project ID or URL\n      --host=HOST                                                          The project's API hostname\n  -W, --no-wait                                                            Do not wait for the operation to complete\n      --wait                                                               Wait for the operation to complete (default)\n  -h, --help                                                               Display this help message\n  -q, --quiet                                                              Do not output any message\n  -V, --version                                                            Display this application version\n  -y, --yes                                                                Answer \"yes\" to all prompts; disable interaction\n  -n, --no                                                                 Answer \"no\" to all prompts\n  -v|vv|vvv, --verbose                                                     Increase the verbosity of messages\n\nExamples:\n Switch on the \"fetch branches\" option for a specific integration:\n   platform integration:update ZXhhbXBsZSB --fetch-branches 1\n\nConclusion\nThe CLI is a very handy tool for listing information about integrations, also for adding new ones (or modifying those already existing).\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to add or remove users from projects using the command line", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-add-or-remove-users-from-projects-using-the-command-line/91", "documentId": "4d892e24a369917eb165b983e3e1406b34ffd1e4", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to add or remove users from projects using the command line\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            command-line\n          \n        \n        \n          \n            user-management\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          robert\n          \n        \n\n        \n            \n            \n              March 20, 2019,  6:27pm\n            \n        #1\n        \n      \n      \n        Goal\nAdd or remove a user to one or more Platform.sh projects using the platform CLI tool.\nAssumptions\nYou have one or more Platform.sh projects and you have installed the platform CLI tool.\nYou will need to know the project IDs. You will need the email address for each user you wish to add or remove.\nProblems\nSometimes it is necessary to automate user access to projects, especially when managing fleets of sites. This is a case for using the CLI.\nSteps\n1. Single projects\nAdd user user1@example.com with the project-wide role of viewer. Confirm the change with Y.\nplatform user:add -p &lt;project id&gt; -r viewer user1@example.com\nAdding the user user1@example.com to &lt;project name&gt; (&lt;project id&gt;):\n  Project role: viewer\n\nAdding users can result in additional charges.\n\nAre you sure you want to add this user? [Y/n] Y\n\nAdd user user1@example.com to the staging branch as a contributor:\nplatform user:add -p &lt;project id&gt; -r staging:contributor user1@example.com\nAdding the user user1@example.com to &lt;project name&gt; (&lt;project id&gt;):\n  Project role: viewer\n    Role on staging: contributor\n\nAdding users can result in additional charges.\n\nAre you sure you want to add this user? [Y/n] Y\n\n2. Multiple projects\nRemove a user (user1@example.com) from multiple projects:\nplatform multi --projects &lt;project1 id&gt;,&lt;project2 id&gt; \\ \n'user:delete user1@example.com'\n\nThis is the output:\nRunning command 'user:delete user1@example.com' on 2 projects.\n\n* Project: &lt;project1 name&gt; (&lt;project1 id&gt;)\nAre you sure you want to delete the user user1@example.com? [Y/n] y\nUser user1@example.com deleted\n\n* Project: &lt;project2 name&gt; (&lt;project2 id&gt;)\nAre you sure you want to delete the user user1@example.com? [Y/n] y\nUser user1@example.com deleted\n\nConclusion\nUser management, including adding, deleting, and role assignment, can be done from the command line using the Platform.sh CLI. Applying the platform multi command allows you to make changes on multiple projects at once.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to interactively debug Node.js applications on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-interactively-debug-node-js-applications-on-platform-sh/172", "documentId": "033bf02e5155c07f56afd5fbe5eab11abe078c53", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to interactively debug Node.js applications on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            nodejs\n          \n        \n        \n          \n            debugging\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          oripekelman\n          \n        \n\n        \n            \n            \n              March 19, 2019,  7:28pm\n            \n        #1\n        \n      \n      \n        Goal\nInteractively debug nodejs applications running on Platform.sh,\nAssumptions\n\nA Node.js application that is running on Platform.sh\n\nAn issue that requires interactive debugging, possibly because it can\u2019t be reproduced locally\nThe platform.sh CLI\n\nProblems\nEffectively debugging web applications isn\u2019t trivial, especially when an HTTP request goes through multiple layers until it reaches the web app, which is usually the case in cloud platforms.\nDebugging in a local environment is easier, but the bug might only trigger when interacting with the data that are present on production.\nSteps\nThe debugging procedure should only be performed on a non-production environment. So, if this is a production issue, first clone the production environment. Platform.sh creates byte-for-byte clones of an environment including the data so there basically is a reproducibility guarantee.\n1. Clone  production\nUsing the CLI:\nplatform branch debug-weird-production-issue master\n\nThis will create a new environment debug-weird-production-issue, based on the master branch which is the production environment. It will also checkout the branch locally.\n2. Restart the application daemon in debug mode\nSSH into this environment with the command:\nplatform ssh\n\nBy default it will connect the current environment branch, in this case debug-weird-production-issue\nStop the running process with the command:\nsv stop app\n\nRun the application in debug mode:\nnode inspect server.js\n\n\nNote: server.js is the entry point to the application as specified in the platform.app.yaml in the web.start key, so modify this command for the entry point used.\n\nIt will output something similar to:\nDebugger listening on ws://127.0.0.1:9229/663e3d85-31b0-4f2c-aeb4-94e2fae886cf\n\nCopy the path at the end of the outputted URL (i.e., 663e3d85-31b0-4f2c-aeb4-94e2fae886cf)\n3. Forward the debugger port locally\nIn a second terminal window, create an SSH tunnel that forwards the 9229 port:\nssh -N -L9229:127.0.0.1:9229  $(platform  ssh --pipe)\n\n4. Profit! Chrome Dev tools can be used\nOpen the Chrome web browser and visit the url:\nchrome-devtools://devtools/bundled/js_app.html?experiments=true&amp;v8only=true&amp;ws=127.0.0.1:9229/{path}\n\nReplace {path} with the path that was copied earlier.\nFor example:\nchrome-devtools://devtools/bundled/js_app.html?experiments=true&amp;v8only=true&amp;ws=127.0.0.1:9229/663e3d85-31b0-4f2c-aeb4-94e2fae886cf\n\nConclusion\nDebugging complex bugs that are only reproduced with production data present is non-trivial.\nUsing a clone of the production data, plus the dynamic nature of Node.js and the fabulous Chrome Dev tools, any bug can be properly investigated.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to make internal requests between two applications of a project", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-make-internal-requests-between-two-applications-of-a-project/77", "documentId": "0c31366ecbd93e25d158fa8da5321a616de275e6", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to make internal requests between two applications of a project\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            http\n          \n        \n        \n          \n            multiapp\n          \n        \n    \n\n\n\n\n  \n      \n        \n          nls\n          \n        \n\n        \n            \n            \n              March 20, 2019,  6:43pm\n            \n        #1\n        \n      \n      \n        Goal\nThis guide shows how make an internal request to a different application in the same project. The goal is to display a message sent by a backend API on our frontend.\nAssumptions\nTo complete this, you will need:\n\nAn empty Platform.sh project\nThe Platform.sh CLI tool installed\nYour ssh key loaded in your ssh agent and configured in the Platform.sh dashboard\n\n\nSteps\nIn order to implement this, setup two different applications in your project: frontend and backend. Please refer to the multi-app documentation.\nPHP will be used for both applications.\nThe steps below will create the following project structure:\nmultiapp/\n    .platform/\n        routes.yaml\n        services.yaml\n    backend/\n        .platform.app.yaml\n        index.php\n    frontend/\n        .platform.app.yaml\n        index.php\n\n1. Setup the base project\nCreate an empty directory, initialize git and add the Platform.sh remote:\nmkdir multiapp\ncd !$\ngit init .\nplatform project:set https://&lt;region&gt;.platform.sh/projects/&lt;project id&gt;\n\nThe git remotes should now be:\ngit remote -v\nplatform\t&lt;project id&gt;@git.&lt;region&gt;.platform.sh:&lt;project id&gt;.git (fetch)\nplatform\t&lt;project id&gt;@git.&lt;region&gt;.platform.sh:&lt;project id&gt;.git (push)\n\nCreate the two required Platform.sh configuration files:\ntouch ./.platform/routes.yaml\ntouch ./.platform/services.yaml\n\n2. Create the backend application\nCreate a subfolder (mkdir backend) and add the following files:\n./backend/index.php\n&lt;?php\n\nheader('Content-type: application/json');\necho json_encode([\n\t'message' =&gt; 'I come from the backend'\n]);\n\n./backend/.platform.app.yaml\nname: backend\n\ntype: \"php:7.3\"\ndisk: 256\n\nweb:\n  locations:\n    '/':\n      root: ''\n      passthru: '/index.php'\n\nEdit ./.platform/routes.yaml and add the configuration for the backend application:\n\"https://backend.{default}/\":\n  type: upstream\n  upstream: \"backend:http\"\n\nAny request going to https://backend.{default}/ will be dispatched to the backend application.\nCommit the changes and deploy on the Platform.sh environment:\ngit add .\ngit commit -m \"Add backend app\"\ngit push platform master\n\nThe backend application can be accessed at: https://backend.master-7rqtwti-&lt;project id&gt;.&lt;region&gt;.platformsh.site/\nVerify that the application returns the message:\ncurl https://backend.master-7rqtwti-&lt;project id&gt;.&lt;region&gt;.platformsh.site/ | json_pp\n{\n   \"message\" : \"I come from the backend\"\n}\n\n3. Create the frontend application\nCreate the frontend folder:\nmkdir frontend\n\nAdd the configuration file ./frontend/.platform.app.yaml:\nname: frontend\n\ntype: \"php:7.3\"\ndisk: 256\n\nweb:\n  locations:\n    '/':\n      root: ''\n      passthru: '/index.php'\n\n./frontend/index.php\n&lt;h1&gt;I am the frontend application&lt;/h1&gt;\n\nAdd the following configuration in ./routes.yaml:\n\"https://{default}/\":\n  type: upstream\n  upstream: \"frontend:http\"\n\nThe configuration will make any incoming request to the default domain sent to our frontend application.\nCommit and deploy the applications:\ngit add .\ngit commit -m \"Add frontend application\"\ngit push platform master\n\nThe frontend is now working:\ncurl https://master-7rqtwti-&lt;project id&gt;.&lt;region&gt;.platformsh.site/ \n&lt;h1&gt;I am the frontend application&lt;/h1&gt;\n\n4. Making an internal request\nThe public route to the backend could be used but using an internal request is way more efficient and secure.\nThe first step is to add the relationship. Like any other data service, this will be added in ./frontend/.platform.app.yaml\nrelationships:\n  backend: 'backend:http'\n\nThe key of the relationship will be the one used in the $PLATFORM_RELATIONSHIPS array. The first parameter is the name of our second application and http is used as the protocol there.\nRead more on our relationships system in our documentation.\nCommit and deploy the configuration change:\ngit add .\ngit commit -m \"Add relationship\"\ngit push platform master\n\nTest the relationship by connecting to the frontend application:\nplatform ssh\nEnter a number to choose an app:\n  [0] frontend\n  [1] backend\n &gt; 0\n\nThe relationships are exposed through the $PLATFORM_RELATIONSHIPS environment variable:\nweb@&lt;environment id&gt;:~$ base64 -d &lt;&lt;&lt; $PLATFORM_RELATIONSHIPS | json_pp\n{\n   \"backend\" : [\n      {\n         \"password\" : null,\n         \"cluster\" : \"hp5wjyxpgl32m-master-7rqtwti\",\n         \"type\" : \"php:7.2\",\n         \"path\" : null,\n         \"port\" : 80,\n         \"ip\" : \"169.254.43.25\",\n         \"rel\" : \"http\",\n         \"username\" : null,\n         \"hostname\" : \"eccmt3xjhxsfijzhus545wttki.backend.service._.eu-3.platformsh.site\",\n         \"query\" : {},\n         \"service\" : \"backend\",\n         \"public\" : false,\n         \"scheme\" : \"http\",\n         \"host\" : \"backend.internal\",\n         \"fragment\" : null\n      }\n   ]\n}\n\nThe backend application can be accessed from the frontend using the host value: backend.internal\nA curl request confirms it is working:\nweb@&lt;environment id&gt;:~$ curl http://backend.internal\n{\"message\":\"I come from the backend\"}\n\n5. Load the message from the frontend\nReplace ./frontend/index.php with the following content:\n&lt;?php\n\n$backend = null;\n$message = \"I am the frontend application\";\nif (getenv('PLATFORM_RELATIONSHIPS')) {\n    $relationshipName = 'backend';\n    $relationships = json_decode(base64_decode(getenv('PLATFORM_RELATIONSHIPS')), true);\n    foreach ($relationships[$relationshipName] as $endpoint) {\n       $backend = $endpoint['host'];\n       break;\n    }\n}\n\nif ($backend) {\n  $result = file_get_contents('http://'.$backend.'/');\n  $response = json_decode($result, true);\n  $message = $response['message'];\n}\n\necho '&lt;h1&gt;'.$message.'&lt;/h1&gt;';\n\nOur PHP client implements a lot of other features automatically in a project to avoid fetching configuration settings manually.\nAnd redeploy your project:\ngit add .\ngit commit -m \"Add backend call on frontend\"\ngit push platform master\n\nThe message from the backend is now displayed on our frontend application:\ncurl https://master-7rqtwti-&lt;project id&gt;.&lt;region id&gt;.platformsh.site/\n&lt;h1&gt;I come from the backend&lt;/h1&gt;\n\nConclusion\nMaking internal requests on different applications inside the same project is possible by leveraging the relationships mechanism implemented by Platform.sh.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to perform a database dump via Platform.sh CLI", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-perform-a-database-dump-via-platform-sh-cli/143", "documentId": "c9fe37751e08254de27dd04face4694aed3da9a9", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to perform a database dump via Platform.sh CLI\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            local-development\n          \n        \n        \n          \n            db-dump\n          \n        \n        \n          \n            backups\n          \n        \n        \n          \n            databases\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          olga-linek\n          \n        \n\n        \n            \n            \n              March 20, 2019,  6:45pm\n            \n        #1\n        \n      \n      \n        Goal\nPerform a database dump  using the  platform  CLI tool.\n\nOne or more active Platform.sh projects\nThe Platform.sh CLI tool installed locally\nAn SSH key configured on the project account\nKnown project IDs. (Use platform project:list)\n\nProblems\nSometimes it is necessary to do a database dump of a project. This can be especially useful when doing some testing, planning a migration or for recovery purposes.\nPlatform CLI can be used to backup the database with a single command.\nSteps\nIn general, the following command will be used to perform a database dump using the Platform CLI:\nUsage: platform db:dump [-f|--file FILE] [-t|--timestamp] [--stdout] [-p|--project PROJECT] [--host HOST] [-e|--environment ENVIRONMENT] [-A|--app APP]\n\n1. Single Database\nFor a single configured database, use the command below:\n$ platform db:dump\nCreating SQL dump file:/Users/my_user/platformsh-enterprise/hiera/mysqldb--main--dump.sql\n\n2. Multiple Databases\nRunning the previous command with multiple databases, choosing a relationship will be prompted by the CLI:\n$ platform db:dump\nEnter a number to choose a relationship:\n  [0] postgresql (main@postgresql.internal)\n  [1] database (user@database.internal)\n\nDumping the MySQL database (database, in this case) can be chosen by selecting 1. database can be chosen directly ahead of time with the CLI with the --relationship flag:\n$ platform db:dump --relationship database\n\nFurther options can be specified, as per the example below:\n$ platform db:dump --relationship database -p project_id -e environment_name -A app\n\nTo find the platform relationship details, SSS into the environment and run:\n$ echo $PLATFORM_RELATIONSHIPS | base64 --decode | json_pp\n\n3. Compression\nBy default the dump file will be uncompressed. To compress it, use the  --gzip  ( -z ) option:\nplatform db:dump --gzip\n\n4. Troubleshooting\nError output: Permission denied (publickey).\nThis error can sometimes show up, after running  the db dump command. If this happens, try the following:\n\n\nRedeploy the environment the user is trying to access.\nThe SSH key may be improperly configured. Check with platform ssh-key:list and platform ssh-key:add if necessary.\nRemove the user from the project, then add them back and redeploy the environment.\n\nConclusion\nDatabase dumps can be easily done by using  Platform.sh CLI.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to migrate database changes between environments", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-migrate-database-changes-between-environments/124", "documentId": "1948b50ed514368494be98ff17d708271ab5726c", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to migrate database changes between environments\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            db-dump\n          \n        \n        \n          \n            postgresql\n          \n        \n        \n          \n            databases\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              March 20, 2019,  6:51pm\n            \n        #1\n        \n      \n      \n        Goal\nImport changes to a database in a child environment to its parent using the Platform.sh CLI.\nAssumptions\nThis guide assumes:\n\nan active application on Platform.sh configured to a database\nA local repository with the Platform.sh project as git remote\nThe Platform.sh CLI installed locally\nAn SSH key configured on the project account\n\nadmin  role granted for the project\n\nProblems\nChanges to a database in master will be visible to its child environments when they are synchronized, however changes made to a development environment - such as adding an admin user (alan) to a PostgreSQL database - do not run in the opposite direction and will not be available in master.\nIn a Django application, admin user alan is visible from the dev branch.\n$ platform db:sql\npsql (11.1 (Debian 11.1-3.pgdg90+1), server 9.6.11)\nType \"help\" for help.\n\nmain=&gt; SELECT * FROM auth_user;\n id |          password         |          last_login           | is_superuser | username | first_name | last_name | email | is_staff | is_active |          date_joined          \n----+---------------------------+-------------------------------+--------------+----------+------------+-----------+-------+----------+-----------+-------------------------------\n  2 |      &lt;password hash&gt;      | 2019-03-12 15:52:38.379839+00 | t            | chad     |            |           |       | t        | t         | 2019-03-07 16:02:26.583956+00\n  6 |      &lt;password hash&gt;      | 2019-03-12 15:48:02+00        | t            | alan     |            |           |       | t        | t         | 2019-03-12 15:47:19+00\n(2 rows)\n\nalan is not visible in master, however.\n$ platform db:sql\npsql (11.1 (Debian 11.1-3.pgdg90+1), server 9.6.11)\nType \"help\" for help.\n\nmain=&gt; SELECT * FROM auth_user; \nid |          password         |          last_login           | is_superuser | username | first_name | last_name | email | is_staff | is_active |          date_joined          \n----+---------------------------+-------------------------------+--------------+----------+------------+-----------+-------+----------+-----------+-------------------------------\n 2 |      &lt;password hash&gt;      | 2019-03-11 14:40:56.401026+00 | t            | chad     |            |           |       | t        | t         | 2019-03-07 16:02:26.583956+00\n(1 row)\n\n\nNote: Importing a database into an active environment is a destructive operation.\nThis guide assumes that the only change made between master and dev is the addition of a new admin user in dev. Synchronize dev if there is data in master you do not want to be overwritten.\n$ git checkout dev    \n$ platform environment:synchronize    \n\nPlatform.sh also strongly recommends that you take a snapshot of the target environment before executing.\n$ git checkout master\n$ platform snapshot:create\n\n\nMigrating changes between environments can be done in two ways:\n\nRestoring a snapshot to the target environment\nManually dumping and importing the database to the target environment\n\nSteps (Restoring a snapshot to the target environment)\n1. Create a snapshot\nCreate a snapshot of the** dev **environment that contains the database changes\n$ git checkout dev   \nSwitched to branch 'dev'    \n$ platform snapshot:create    \nCreating a snapshot of dev   \nWaiting for the snapshot to complete...   \nWaiting for the activity m3qerwnkyblje (User created a backup of dev):\n    Backing up dev\n    Backup name is &lt;snapshot name&gt;   \n[============================] 14 secs (complete)   \nA snapshot of environment dev has been created   \nSnapshot name: &lt;snapshot name&gt;    \n\n2. Restore the snapshot from dev to master\n\nWhile still checked out as dev and using the &lt;snapshot name&gt; from above:\n$ platform snapshot:restore --target=master &lt;snapshot name&gt;\n\nAdditional information about creating and restoring snapshots can be found in the Platform.sh documentation and in How to create and restore snapshots using the CLI.\nSteps (Manually dump to the target environment)\n1. Dump the database\nFor this example, the relationship database was defined in .platform.app.yaml with:\nrelationships:\n     database: \"postgresqldb:postgresql\"    \n\nFrom dev dump the PostrgreSQL database according to its relationship name (database). The --relationship tag is useful if there are multiple database relationships present, but if only one is used platform db:dump will work without it.\nSee the documentation for more information.\n$ git checkout dev    \n$ platform db:dump --relationship database    \nCreating SQL dump file: &lt;local directory&gt;/&lt;project id&gt;--dev-54ta5gq--postgresqldb--main--dump.sql    \n\n2. Pipe the SQL dump to the target environment\n```bash\n$ git checkout master\n$ platform sql --relationship database -e master &lt; &lt;project id&gt;--dev-54ta5gq--postgresqldb--main--dump.sql\n```\n\nVerify\nVerify that the new admin user alan is now visible from master.\n$ platform db:sql\npsql (11.1 (Debian 11.1-3.pgdg90+1), server 9.6.11)\nType \"help\" for help.\n   \nmain=&gt; SELECT * FROM auth_user;\nid |          password         |          last_login           | is_superuser | username | first_name | last_name | email | is_staff | is_active |          date_joined          \n----+---------------------------+-------------------------------+--------------+----------+------------+-----------+-------+----------+-----------+-------------------------------\n 2 |      &lt;password hash&gt;      | 2019-03-12 15:52:38.379839+00 | t            | chad     |            |           |       | t        | t         | 2019-03-07 16:02:26.583956+00\n 6 |      &lt;password hash&gt;      | 2019-03-12 15:48:02+00        | t            | alan     |            |           |       | t        | t         | 2019-03-12 15:47:19+00\n(2 rows)\n\nConclusion\nChild environments inherit service visibility from their parents, but to ensure that development changes to not affect a production environment, updates and synchronizations do not occur in the opposite direction.\nIf a change is made in a development environment that is desired on master, the Platform CLI can be used to migrate those changes by either creating and restoring a snapshot to the target environment or by manually dumping a database piping the dump file into the target environment.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to blacklist abusive IP addresses on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-blacklist-abusive-ip-addresses-on-platform-sh/169", "documentId": "746284ff34d433e8a96452b635b780e334ea3998", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to blacklist abusive IP addresses on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            ui\n          \n        \n        \n          \n            ip-blacklist\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          nils.ottermann\n          \n        \n\n        \n            \n            \n              March 20, 2019,  6:57pm\n            \n        #1\n        \n      \n      \n        Goal\nTo block a certain set of abusive IP addresses before they hit the application layer. This can be IPs identified to cause high load or otherwise harm the system, e.g. crawlers / bots, malicious scripts, hacking attempts, or IPs that should be blocked for any other operational reason.\nAssumptions\n\nAccess to a project hosted on Platform.sh\n\nAdministrator rights on the project\nKnowledge on using the Platform.sh CLI and the web UI\n\nProblems\nSometimes a website can be stressed by traffic originating from IP addresses that are causing high load or any other negative impact on the application environment. In some cases it makes sense for those IP addresses to be added to a blacklist in order to stabilize system resource usage. In other cases certain IP ranges might need to be blocked for a different operational reason.\nPlatform.sh allows for such a blacklist to be configured either through the CLI, or through the project\u2019s web UI.\nDepending on personal taste or technical familiarity level, there are 2 ways to go about configuring IP blacklists on the project.\nSteps (Via the CLI)\nIf the Platform CLI is preferred, these are the steps to take in order to block IP addresses.\n1. Log in to Platform CLI\n$ platform login\n\n2. Find the project ID\nNote the project ID of the project to enable the blacklist for:\n$ platform project:list\n\n3. Find the environment ID\nNote the environment ID for the environment on the project that needs securing:\n$ platform environment:list -p &lt;project-ID&gt;\n\n4. Create the blacklist\nRun the following command to create the blacklist and include the IP that needs to be blocked:\nplatform httpaccess --access deny:&lt;the-IP-to-be-blocked&gt; -p &lt;project-ID&gt; -e &lt;environment-ID&gt; (optional: --no-wait)\n\n\nNote:\n\n\nIf multiple IPs are meant to be blacklisted this entire block has to be repeated:\n--access deny:&lt;the-IP-to-be-blocked&gt;\n\n\nExample:\nplatform httpaccess --access deny:&lt;the-IP-to-be-blocked&gt; --access deny:&lt;another-IP-here&gt; -p &lt;project-ID&gt; -e &lt;environment-ID&gt; (optional: --no-wait)\n\n\nIf multiple IPs of the same subnet need to be blacklisted, it\u2019s also possible to add the whole subnet to the blacklist in CIDR notation. For example: --access deny:69.63.176.0/20\n\n\nTo clear the whole list and whitelist all traffic from any IP:\nplatform httpaccess - - access allow:any -p &lt;project-ID&gt; -e &lt;environment-ID&gt; (optional: --no-wait)\n\n\nIf there are already IPs on the blacklist, another platform httpaccess --access deny:&lt;new-IP-to-be-blocked&gt; -p &lt;project-ID&gt; -e &lt;environment-ID&gt; (optional: --no-wait) will not add the new IP to the blacklist. Instead, it will redefine the entire blacklist and therefore delete all previously listed IPs unless they\u2019re included again in the statement.\n\n\n\nSteps (Via the web UI)\nSince the CLI and the web UI are both connecting to the same API in the background, they both provide the same set of commands around its functionality. If the UI is preferred over the CLI, the same settings can be activated through the browser.\n1. Browse to the general settings tab on the project\u2019s environment:\n\n2. Add IP address or subnets\nExpand the HTTP access control tab via Edit and add IP addresses or subnets as shown, then save:\n\nFor the duration of the propagation, environments will be in status Dirty but resolve quickly back to Active.\n\nCaveats:\n\n\nIP restriction is per environment / branch.\n\n\nBlacklists are not inherited on already existing environments.\n\n\nHowever, it is inherited on newly created environments. These new environments inherit from their respective parent environment.\n\n\nThe UI is probably the safer choice to manage blacklists due to its ability to easier add any IP to an already existing blacklist.\n\n\nBe careful with adding IPs to the blacklist via CLI as the command overwrites the existing blacklist. Any IPs not included in the command will be deleted from the blacklist.\n\n\n\nConclusion\nPlatform.sh makes it easy to manage IP blacklists on a per-environment basis. A choice can be made between using the CLI for blacklist management, or clicking through the UI in the browser.\nOnce IPs are added to the blacklist and the change is deployed to the environment, any traffic coming from those IPs will be filtered out on Platform\u2019s infrastructure before the request can hit the application layer and cause any harm.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to add a webhook to one or more projects", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-add-a-webhook-to-one-or-more-projects/139", "documentId": "86f5b587db54ff38acbefef4c8beadd58de81724", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to add a webhook to one or more projects\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            webhooks\n          \n        \n        \n          \n            integrations\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          oripekelman\n          \n        \n\n        \n            \n            \n              April 5, 2019, 11:09am\n            \n        #1\n        \n      \n      \n        Goal\nAdd a webhook to a single project, or to all of your Platform.sh projects.\nAssumptions\n\nOne or more active projects on Platform.sh\n\nThe Platform.sh CLI installed locally\n\nProblems\nYou can use webhooks to integrate Platform.sh into your automation chain to trigger actions somewhere else. They can be configured to fire on all events, or specific events that happen on specific environments.\nMore information about Webhooks on Platform.sh is available in the public documentation.\nSteps (Adding a webhook to a single project)\n1. Get the project ID\nIf the local repository already has the remote project set, navigate to that directory. Otherwise, retrieve the project ID using platform project:list\n2. Set up the webhook\nAdd the webhook for the desired URL that can receive posted JSON:\n$ platform integration:add --type=webhook --project=&lt;project ID&gt; --url=A-URL-THAT-CAN-RECEIVE-THE-POSTED-JSON\n\nThen specify the desired webhook properties:\nEvents to report (--events)\nA list of events to report, e.g. environment.push\nDefault: *\nEnter comma-separated values (or leave this blank)\n&gt; environment.push\n\nStates to report (--states)\nA list of states to report, e.g. pending, in_progress, complete\nDefault: complete\nEnter comma-separated values (or leave this blank)\n&gt; complete\n\nIncluded environments (--environments)\nThe environment IDs to include\nDefault: *\nEnter comma-separated values (or leave this blank)\n&gt; *\n\nExcluded environments (--excluded-environments)\nThe environment IDs to exclude\nEnter comma-separated values (or leave this blank)\n&gt; \n\nCreated integration wuw76ebyhb5ni (type: webhook)\n+----------------------+-------------------------------------------------------+\n| Property             | Value                                                 |\n+----------------------+-------------------------------------------------------+\n| id                   | wuw76ebyhb5ni                                         |\n| type                 | webhook                                               |\n| events               | - environment.push                                    |\n| environments         | - '*'                                                 |\n| excluded_environment | {  }                                                  |\n| s                    |                                                       |\n| states               | - complete                                            |\n| url                  | &lt;url&gt;                                                 |\n+----------------------+-------------------------------------------------------+\n\n\nYou can also, evidently pass all the arguments on the command line, so this step itself can be automated.\nSteps (Adding a webhook to all projects)\n1. Add the webhooks in a single command\n$ platform multi -p$(platform projects --my --columns id --pipe | paste -sd \",\" -) \"integration:add --type webhook --url https://example.com/receiver  --events * --states complete --environments * --excluded-environments ''\"\n\nThe CLI command can be broken down into the following parts:\n\n\nplatform multi  runs CLI command on multiple projects\n\nplatform projects --my --columns id --pipe  outputs the list of projects with only their IDs separated by newline\n\npaste -sd \",\" -  joins that array of project IDs with a comma\n\nintegration:add --type webhook --url https://example.com/receiver --events * --states complete --environments * --excluded-environments '' adds a webhook for all events and all environments\n\n2. Bonus - add the integration to all projects that do not have one configured.\nAnd what if you only want to add the integration if it does not already exist?\nplatform multi -p$(platform multi -p$(platform projects --my --columns id --pipe | paste -sd \",\" -) \"integration:list --format=csv --no-header\" 2&gt;&amp;1 | grep -B1 \"No integrations found\" |grep -o \"\\(([[:alnum:]]*)\\)$\" | cut -c2-14| paste -sd \",\" -) \"integration:add --type webhook --url https://example.com  --events * --states complete --environments * --excluded-environments ''\"\n\nBut then again, bash one liners\u2026 you\u2019d be better off at this point using the API directly rather then relying on my bash-foo.\nConclusions\n\nUsing the Platform.sh CLI, webhook integrations can easily be added to single projects or even to every project.\nBash is cool.\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to connect to services on Platform.sh from your local system", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-connect-to-services-on-platform-sh-from-your-local-system/189", "documentId": "8e12f14343b8f721cca0862b47b7ba74dab0ac74", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to connect to services on Platform.sh from your local system\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            databases\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              April 3, 2019,  8:48pm\n            \n        #1\n        \n      \n      \n        Goal\nAccess Platform.sh-hosted services from a local computer, over a secure SSH tunnel.\nAssumptions\n\nThe Platform.sh CLI is installed locally.\nWhatever additional software is needed (local web server, local mysql client, etc.) is already installed locally.\n\nProblems\nBy default the Platform.sh CLI will use the current environment.  However, when using a 3rd party integration from GitHub or GitLab the desired environment will likely be a PR environment, not the environment that the user is working on directly.  That will require extra commands as shown below.\nSteps\n1. Open an SSH tunnel\nRun the following command locally:\nplatform tunnel:open\n\nThat will open an SSH tunnel to the current environment and map all services defined on the application to local ports.  Accessing those ports locally with the appropriate tool (mysql command line, Redis CLI client, etc.) will connect to the service on the environment.\n2. Export relationships\nRun the following command locally:\nexport PLATFORM_RELATIONSHIPS=\"$(platform tunnel:info --encode)\"\n\nThat will create a PLATFORM_RELATIONSHIPS environment variable locally that provides user/password/host/port credentials to connect to the current environment.  A local application that checks that environment variable in order to connect to services on Platform.sh will work just the same as if it were on Platform.sh.  (It will not, however, make any other environment variables available.)\nIt is also possible to combine both commands into a single line, like so:\nplatform tunnel:open &amp;&amp; export PLATFORM_RELATIONSHIPS=\"$(platform tunnel:info --encode)\"\n\n3. Disconnect from the tunnel\nWhen done, clean up the open connections by running:\nplatform tunnel:close\n\nAlternative: Connect to a Pull Request environment\nBoth commands above will, by default, use the current branch name/environment.  However, the environment created by a Pull Request from GitHub, Bitbucket, or GitLab will be different and thus the above commands will not connect to them.  To access a Pull Request environment modify both commands to specify the environment name.\nFor example, a GitHub Pull Request #42 will have an environment name on Platform.sh of pr-42, so run:\nplatform tunnel:open -e pr-42 &amp;&amp; export PLATFORM_RELATIONSHIPS=\"$(platform tunnel:info --encode -e pr-42)\"\n\nThe -e pr-42 (or equivalently --environment pr-42) tells the CLI to connect to the pr-42 environment rather than the environment that corresponds to the branch currently checked out.\nConclusion\nWith access to the remote services, customers can take whatever action they need.  That includes running code locally against a remote service, accessing the service using a management tool appropriate for that service, or any other task.  Just remember the caveat about Pull Request environments.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to use Redis for caching a Drupal 8 site", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-use-redis-for-caching-a-drupal-8-site/190", "documentId": "85e5b64c32262afdaae3d74616c62514abe911b1", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to use Redis for caching a Drupal 8 site\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            drupal\n          \n        \n        \n          \n            redis\n          \n        \n        \n          \n            cache\n          \n        \n    \n\n\n\n\n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              April 3, 2019, 10:35pm\n            \n        #1\n        \n      \n      \n        Goal\nDrupal 8 functions best with a non-database cache, and particularly well with Redis.  This guide shows how to set up a Drupal 8 site to use Redis caching.\nAssumptions\n\nYou already have a working Drupal 8 site on Platform.sh, built with Composer.\nThe project\u2019s plan size has room for an additional Redis service.\n\nA Standard plan should have room for a Drupal 8 site with Redis and one search server, although if the site has a lot of authenticated traffic it may be a good idea to increase it to a Medium plan to allow for more resources for each container.  Add Redis first, then benchmark the site to determine if that\u2019s necessary.\nProblems\nDrupal 8 contains a bug that causes it to fail if the cache backend changes between installation (which always uses the database) and the first page load (which uses the configured cache).  Therefore Redis caching cannot be configured out of the box.  It can and should be enabled immediately after installation, however.\nSteps\n1. Add a Redis service\nAdd the following to the .platform/services.yaml file to create a Redis service in the application:\nrediscache:\n    type: redis:5.0\n\nThat will create a service named rediscache, of type redis, specifically version 5.0.\n2. Expose the Redis service to your application\nIn the .platform.app.yaml file under the relationships section, add the following:\nrelationships:\n    redis: \"rediscache:redis\"\n\n3. Add the Redis PHP extension\nIn the .platform.app.yaml file, add the following right after the type block:\n# Additional extensions\nruntime:\n    extensions:\n        - redis\n\n4. Add the Drupal module\nAdd the Drupal Redis module.  If using Composer (recommended), a single command will add it:\ncomposer require drupal/redis\n\nThen commit the resulting changes to the composer.json and composer.lock files.\nThe Redis module may be enabled after the setup below is completed, but should not be enabled until it is.\n5. Configure Drupal\nPlace the following at the end of settings.platformsh.php. Note the inline comments, which allow for further customization.  Also review the README.txt file that comes with the redis module, as it has a great deal more information on possible configuration options.\nThe example below is intended as a \u201cmost common case\u201d, so may need adjustment to be optimal for a particular site.\n\nnote\nIf you do not already have the Platform.sh Config Reader library installed and referenced at the top of the file, you will need to install it with composer require platformsh/config-reader and then add the following code before the block below:\n$platformsh = new \\Platformsh\\ConfigReader\\Config();\nif (!$platformsh-&gt;inRuntime()) {\n  return;\n}\n\n\n// Set redis configuration.\nif ($platformsh-&gt;hasRelationship('redis') &amp;&amp; !drupal_installation_attempted() &amp;&amp; extension_loaded('redis')) {\n  $redis = $platformsh-&gt;credentials('redis');\n\n  // Set Redis as the default backend for any cache bin not otherwise specified.\n  $settings['cache']['default'] = 'cache.backend.redis';\n  $settings['redis.connection']['host'] = $redis['host'];\n  $settings['redis.connection']['port'] = $redis['port'];\n\n  // Apply changes to the container configuration to better leverage Redis.\n  // This includes using Redis for the lock and flood control systems, as well\n  // as the cache tag checksum. Alternatively, copy the contents of that file\n  // to your project-specific services.yml file, modify as appropriate, and\n  // remove this line.\n  $settings['container_yamls'][] = 'modules/contrib/redis/example.services.yml';\n\n  // Allow the services to work before the Redis module itself is enabled.\n  $settings['container_yamls'][] = 'modules/contrib/redis/redis.services.yml';\n\n  // Manually add the classloader path, this is required for the container cache bin definition below\n  // and allows to use it without the redis module being enabled.\n  $class_loader-&gt;addPsr4('Drupal\\\\redis\\\\', 'modules/contrib/redis/src');\n\n  // Use redis for container cache.\n  // The container cache is used to load the container definition itself, and\n  // thus any configuration stored in the container itself is not available\n  // yet. These lines force the container cache to use Redis rather than the\n  // default SQL cache.\n  $settings['bootstrap_container_definition'] = [\n    'parameters' =&gt; [],\n    'services' =&gt; [\n      'redis.factory' =&gt; [\n        'class' =&gt; 'Drupal\\redis\\ClientFactory',\n      ],\n      'cache.backend.redis' =&gt; [\n        'class' =&gt; 'Drupal\\redis\\Cache\\CacheBackendFactory',\n        'arguments' =&gt; ['@redis.factory', '@cache_tags_provider.container', '@serialization.phpserialize'],\n      ],\n      'cache.container' =&gt; [\n        'class' =&gt; '\\Drupal\\redis\\Cache\\PhpRedis',\n        'factory' =&gt; ['@cache.backend.redis', 'get'],\n        'arguments' =&gt; ['container'],\n      ],\n      'cache_tags_provider.container' =&gt; [\n        'class' =&gt; 'Drupal\\redis\\Cache\\RedisCacheTagsChecksum',\n        'arguments' =&gt; ['@redis.factory'],\n      ],\n      'serialization.phpserialize' =&gt; [\n        'class' =&gt; 'Drupal\\Component\\Serialization\\PhpSerialize',\n      ],\n    ],\n  ];\n}\n\nThe example.services.yml file noted above will also use Redis for the lock and flood control systems.\n6. Deploy and Verify Redis\nCommit the changes to settings.platformsh.php, composer.*, .platform.app.yaml, and .platform/services.yaml.  Then git push.\nOnce the deploy is finished, run:\nplatform ssh \"redis-cli -h redis.internal info\"\n\nThat will show the Redis status information.  Toward the top of the output is the memory allocation.  If that amount changes as the site is used it means Drupal is correctly connecting to Redis and writing cache values to it.\n7. Clear SQL cache tables\nOnce Redis is confirmed running and in use, clear out the remaining, vestigial values in the SQL database cache as they are no longer valid.  To do that, connect to the database:\nplatform sql\n\nAnd run TRUNCATE cache_* for every table that begins with cache_, except for cache_form.  Despite its name cache_form is not part of the cache system proper and thus should not be moved out of SQL.\nTo see all the cache tables, run:\nshow tables like 'cache_%';\n\nThat will list tables like cache_bootstrap, cache_config, cache_container, etc.  Then run:\nTRUNCATE cache_bootstrap;\nTRUNCATE cache_config;\nTRUNCATE cache_container;\n\nAnd so on.\nConclusion\nUsing Redis for Drupal caching can improve performance, and more importantly free up valuable database disk space.  That helps avoid out-of-disk lockups on the database that can impact site availability.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to access Redis credentials on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-access-redis-credentials-on-platform-sh/152", "documentId": "8ebb6310db0bf95ae87cc86b679ccbe2d81c62dd", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to access Redis credentials on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            object-cache\n          \n        \n        \n          \n            credentials\n          \n        \n        \n          \n            config-reader-php\n          \n        \n        \n          \n            redis\n          \n        \n        \n          \n            php\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              April 16, 2019,  6:17pm\n            \n        #1\n        \n      \n      \n        Goal\nAccess credentials for Redis from within a Platform.sh application using PHP.\nAssumptions\n\nan active Platform.sh project\nproperly configured .platform/services.yaml for the given service\n\nSSH key configured on account if developing locally\nRedis installed if developing locally\nproperly configured Redis relationship like so, in .platform.app.yaml:\n\nrelationships:\n    redis: 'redis:redis'\n\nIf developing locally, remember to first open a tunnel to the project environment using the Platform CLI.\n$ platform tunnel:open &amp;&amp; export PLATFORM_RELATIONSHIPS=\"$(platform tunnel:info --encode)\"\n\nThis will open an SSH tunnel to your current Platform.sh environment and expose a local environment variable that mimics the relationships array on Platform.sh. Check the Platform.sh documentation and How to develop locally on Platform.sh with a tethered connection for more information.\nProblems\nPlatform.sh service credentials are made available to applications as the PLATFORM_RELATIONSHIPS environment variable, which is a base64-encoded JSON string that has to be decoded before it can be used.\nThere are two primary options for accessing service credentials on Platform.sh that can be used within an application:\n\nUsing the Platform.sh Config Reader library\n\nAccessing environment variables directly\n\nSteps (Config Reader)\n1. Install the library\nInstall the configuration library. See the documentation for minimum requirements.\n$ composer install platformsh/config-reader\n\n2. Create a Config object\nCreating a Config object provides access to the Platform.sh environment.\nuse Platformsh\\ConfigReader\\Config;\n\n$config = new Config();\n\n3. Read the credentials\n// Get the credentials to connect to the Redis service.\n$credentials = $config-&gt;credentials('redis');\n\nSteps (Manual)\n1. Load the environment variable\n$relationships = json_decode(base64_decode(getenv('PLATFORM_RELATIONSHIPS')), TRUE);\n\n2. Read the credentials\n$credentials = $relationships['redis'];\n\nUse\nIn most cases, you will need only the  host  and  port  properties to connect to Redis. Pass those to your Redis library\u2019s setup routine in your application. Most of the time the other values may be ignored.\nIn either case, credentials is now an array matching the relationship JSON object.\n{\n  \"username\": null,\n  \"scheme\": \"redis\",\n  \"service\": \"redis\",\n  \"fragment\": null,\n  \"ip\": \"169.254.22.205\",\n  \"hostname\": \"2wye4dawv22vhvozyec3o5hxfm.redis.service._.eu-3.platformsh.site\",\n  \"public\": false,\n  \"cluster\": \"rjify4yjcwxaa-master-7rqtwti\",\n  \"host\": \"redis.internal\",\n  \"rel\": \"redis\",\n  \"query\": [\n    \n  ],\n  \"path\": null,\n  \"password\": null,\n  \"type\": \"redis:5.0\",\n  \"port\": 6379\n}\n\nConclusions\nUsing either the language-specific Platform.sh Configuration library or direct access methods for environment variables, an application can get Redis credentials in PHP.\nPlatform.sh supports configuration libraries for multiple languages. The PHP configuration library can be useful for inspecting the project environment:\n// Checks whether the code is running in a build environment\n$config-&gt;inBuild();\n// Checks whether the code is running in a runtime environment\n$config-&gt;inRuntime();\n\nand for reading environment variables as attributes of config:\n// Available in Build and at Runtime\n$config-&gt;appDir;\n// Available at Runtime only\n$config-&gt;branch;\n$config-&gt;smtpHost;\n\nThe APIs for each language are written to be as consistent as possible, but seek out each library\u2019s documentation for specific differences.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Can I use Platform.sh for a different language?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/can-i-use-platform-sh-for-a-different-language/237/2", "documentId": "1d7137dbe837095b570ab672ced2caedf8040f45", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Can I use Platform.sh for a different language?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          matthias-van-woensel\n          \n        \n\n        \n            \n              May 2, 2019,  1:59pm\n            \n        #1\n        \n      \n      \n        We can use PHP, NodeJS, Go, and more.\nBut my favorite language is not there. How do I add a new language (e.g. Erlang, Elixir, \u2026) ?\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              May 6, 2019, 10:04pm\n            \n        #2\n        \n      \n      \n        If Platform.sh does not currently a runtime container for your language, you will have to install it during the build hook inside your .platform.app.yaml file.\nA good example of how you can do this has been published as a How-to for deploying a Rust application on Platform.sh. Pay special attention to the build hook Step 2 and modify accordingly for your language.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to access MongoDB credentials on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-access-mongodb-credentials-on-platform-sh/145", "documentId": "6e812d75dfefa13af2a391020ab0ee331e30839b", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to access MongoDB credentials on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            config-reader-nodejs\n          \n        \n        \n          \n            mongodb\n          \n        \n        \n          \n            credentials\n          \n        \n        \n          \n            nodejs\n          \n        \n        \n          \n            databases\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              April 16, 2019,  6:14pm\n            \n        #1\n        \n      \n      \n        Goal\nAccess credentials for MongoDB from within a Platform.sh application using Node.js.\nAssumptions\n\nan active Platform.sh project\nproperly configured .platform/services.yaml for the given service\n\nSSH key configured on account if developing locally\nMongoDB installed if developing locally\nproperly configured MongoDB relationship like so, in .platform.app.yaml:\n\nrelationships:\n    mongodb: 'mongodb:mongodb'\n\nIf developing locally, remember to first open a tunnel to the project environment using the Platform CLI.\n$ platform tunnel:open &amp;&amp; export PLATFORM_RELATIONSHIPS=\"$(platform tunnel:info --encode)\"\n\nThis will open an SSH tunnel to your current Platform.sh environment and expose a local environment variable that mimics the relationships array on Platform.sh. Check the Platform.sh documentation and How to develop locally on Platform.sh with a tethered connection for more information.\nProblems\nPlatform.sh service credentials are made available to applications as the PLATFORM_RELATIONSHIPS environment variable, which is a base64-encoded JSON string that has to be decoded before it can be used.\nThere are two primary options for accessing service credentials on Platform.sh that can be used within an application:\n\nUsing the Platform.sh Config Reader library\n\nAccessing environment variables directly\n\nSteps (Config Reader)\n1. Install the library\nInstall the configuration library. See the documentation for minimum requirements.\n$ npm install platformsh-config --save    \n\n2. Create a Config object\nCreating a Config object provides access to the Platform.sh environment.\nconst config = require(\"platformsh-config\").config();   \n\n3. Read the credentials\n// Get the credentials to connect to the MongoDB service.    \nconst credentials = config.credentials('mongodb');    \n\nSteps (Manual)\n1. Load and decode the environment variable\nrelationships = JSON.parse(new Buffer(process.env['PLATFORM_RELATIONSHIPS'], 'base64').toString());    \n\n2. Read the credentials\ncredentials = relationships['mongodb'];   \n\nUse\nIn most cases, you will need only the host and port properties to connect to MongoDB. Pass those to your MongoDB library\u2019s setup routine in your application. Most of the time the other values may be ignored.\nIn either case, credentials is a an object matching the relationship JSON object.\n{\n  \"username\": \"main\",\n  \"scheme\": \"mongodb\",\n  \"service\": \"mongodb\",\n  \"ip\": \"169.254.78.213\",\n  \"hostname\": \"okqb7mbggt4wbyiszla2zy4boq.mongodb.service._.eu-3.platformsh.site\",\n  \"cluster\": \"rjify4yjcwxaa-master-7rqtwti\",\n  \"host\": \"mongodb.internal\",\n  \"rel\": \"mongodb\",\n  \"path\": \"main\",\n  \"query\": {\n    \"is_master\": true\n  },\n  \"password\": \"main\",\n  \"type\": \"mongodb:3.6\",\n  \"port\": 27017\n}        \n\nConclusions\nUsing either the language-specific Platform.sh Configuration library or direct access methods for environment variables, an application can get MongoDB credentials in Node.js.\nPlatform.sh supports configuration libraries for multiple languages. The Node.js configuration library can be useful for connecting to MongoDB without creating the full DSN string using formattedCredentials:\n// Define formatted credentials\nvar client = await MongoClient.connect(config.formattedCredentials('mongodb', 'mongodb'));\n\nThe APIs for each language are written to be as consistent as possible, but seek out each library\u2019s documentation for specific differences.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Can these old TLS ciphers be deactivated?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/can-these-old-tls-ciphers-be-deactivated/463", "documentId": "f268c3d52ffcb7438a169cd72948a68bbb80b8ec", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Can these old TLS ciphers be deactivated?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            ssl\n          \n        \n        \n          \n            tls\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              February 13, 2020,  2:41pm\n            \n        #1\n        \n      \n      \n        When testing the encryption ciphers served by Platform.sh with my security scanner, some of them appear to be older/deprecated (like TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA, TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA and TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256). Can these be disabled ?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          bogdan-vasilescu\n          \n        \n\n        \n            \n              February 13, 2020,  9:06am\n            \n        #2\n        \n      \n      \n        Those deprecated cipher suites are still required for TLS 1.2 compatibility and cannot be disabled yet.\nOnce TLS 1.3 is ready to roll out, the possibility to remove them will be implemented similar to what is described here.\nOur blog post: Tightening TLS also provides more information on future security related changes.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "The connection link to several projects", "section": "Questions & Answers", "url": "https://community.platform.sh/t/the-connection-link-to-several-projects/339", "documentId": "2a124ef99cff52ab19f723c417cd1377cc549fd1", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  The connection link to several projects\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            microservices\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n            \n              July 25, 2019,  8:35pm\n            \n        #1\n        \n      \n      \n        How can I make HTTP request to each other?\nE.g:\nFrom my project application A, how can I do a request into a Project application B? Such as HTTP GET on http://somehost/projectB\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              July 25, 2019,  8:35pm\n            \n        #2\n        \n      \n      \n        Two separate Platform.sh projects are, from an application point of view, entirely independent.  You can send HTTP requests from one project to another using whatever HTTP client you prefer; the fact that both are hosted on Platform.sh is an implementation detail.\nNote that means that only requests that are routable HTTP(S) as defined by the target project\u2019s routes.yaml will go through.  There is no way to directly access a backend service (database or similar) in another project, unless it speaks HTTP and is exposed in routes.yaml.\n(Exposing backend services directly on the web is strongly discouraged for security reasons, as such applications often do not have any strong security protocols in place and depend on being not-public.)\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to access MySQL/MariaDB credentials on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-access-mysql-mariadb-credentials-on-platform-sh/149", "documentId": "5c1abbbcf5b73f3ff9c31d5ce173407100c18a62", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to access MySQL/MariaDB credentials on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            config-reader-nodejs\n          \n        \n        \n          \n            credentials\n          \n        \n        \n          \n            mysql-mariadb\n          \n        \n        \n          \n            nodejs\n          \n        \n        \n          \n            databases\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              April 16, 2019,  6:16pm\n            \n        #1\n        \n      \n      \n        Goal\nAccess credentials for MySQL/MariaDB from within a Platform.sh application using Node.js.\nAssumptions\n\nan active Platform.sh project\nproperly configured .platform/services.yaml for the given service\n\nSSH key configured on account if developing locally\nMySQL installed if developing locally\nproperly configured MySQL/MariaDB relationship like so, in .platform.app.yaml:\n\nrelationships:\n    database: 'mysql:mysql'\n\nIf developing locally, remember to first open a tunnel to the project environment using the Platform CLI.\n$ platform tunnel:open &amp;&amp; export PLATFORM_RELATIONSHIPS=\"$(platform tunnel:info --encode)\"\n\nThis will open an SSH tunnel to your current Platform.sh environment and expose a local environment variable that mimics the relationships array on Platform.sh. Check the Platform.sh documentation and How to develop locally on Platform.sh with a tethered connection for more information.\nProblems\nPlatform.sh service credentials are made available to applications as the PLATFORM_RELATIONSHIPS environment variable, which is a base64-encoded JSON string that has to be decoded before it can be used.\nThere are two primary options for accessing service credentials on Platform.sh that can be used within an application:\n\nUsing the Platform.sh Config Reader library\n\nAccessing environment variables directly\n\nSteps (Config Reader)\n1. Install the library\nInstall the configuration library. See the documentation for minimum requirements.\n$ npm install platformsh-config --save\n\n2. Create a Config object\nCreating a Config object provides access to the Platform.sh environment.\nconst config = require(\"platformsh-config\").config();\n\n3. Read the credentials\n// Get the credentials to connect to the MySQL/MariaDB service.\nconst credentials = config.credentials('database');\n\nSteps (Manual)\n1. Load the environment variable\nrelationships = JSON.parse(new Buffer(process.env['PLATFORM_RELATIONSHIPS'], 'base64').toString());\n\n2. Read the credentials\nconst credentials = relationships['database'];\n\nUse\npath is the database name that will be needed to connect. Pass the needed properties to your MySQL library\u2019s setup routine in your application. Most of the time the other values may be ignored.\nIn either case, credentials is a an object matching the relationship JSON object, which includes the appropriate user, password, host, database name, and other pertinent information.\n{\n  \"username\": \"user\",\n  \"scheme\": \"mysql\",\n  \"service\": \"mysql\",\n  \"fragment\": null,\n  \"ip\": \"169.254.147.122\",\n  \"hostname\": \"czwb2d7zzunu67lh77infwkm6i.mysql.service._.eu-3.platformsh.site\",\n  \"public\": false,\n  \"cluster\": \"rjify4yjcwxaa-master-7rqtwti\",\n  \"host\": \"mysql.internal\",\n  \"rel\": \"mysql\",\n  \"query\": {\n    \"is_master\": true\n  },\n  \"path\": \"main\",\n  \"password\": \"\",\n  \"type\": \"mysql:10.2\",\n  \"port\": 3306\n}\n\nConclusions\nUsing either the language-specific Platform.sh Configuration library or direct access methods for environment variables, an application can get MySQL/MariaDB credentials in Node.js.\nPlatform.sh supports configuration libraries for multiple languages. The Node.js configuration library can be useful for inspecting the project environment:\n// Checks whether the code is running in a build environment\nconfig.inBuild()\n// Checks whether the code is running in a runtime environment\nconfig.inRuntime()\n\nand for reading environment variables as attributes of config:\n// Available in Build and at Runtime\nconfig.appDir;\n// Available at Runtime only\nconfig.branch;\nconfig.smtpHost;\n\nThe APIs for each language are written to be as consistent as possible, but seek out each library\u2019s documentation for specific differences.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Is there a way to mount a network storage on the service instance, but not the app?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/is-there-a-way-to-mount-a-network-storage-on-the-service-instance-but-not-the-app/333", "documentId": "b46266371ac6b8544ec85379a60073e233f5b4e6", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Is there a way to mount a network storage on the service instance, but not the app?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              July 12, 2019,  1:16pm\n            \n        #1\n        \n      \n      \n        For example, to gain access to a backup of the Solr service?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          robert\n          \n        \n\n        \n            \n              July 12, 2019,  1:16pm\n            \n        #2\n        \n      \n      \n        Mounts on services is not supported.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How do I fix `fatal: the remote end hung up unexpectedly` while pushing from a Bitbucket pipeline to Platform.sh?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-do-i-fix-fatal-the-remote-end-hung-up-unexpectedly-while-pushing-from-a-bitbucket-pipeline-to-platform-sh/492", "documentId": "c58b468e9afeed9b0c61b0d3e5cc7503378a7156", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How do I fix `fatal: the remote end hung up unexpectedly` while pushing from a Bitbucket pipeline to Platform.sh?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            bitbucket\n          \n        \n        \n          \n            git\n          \n        \n        \n          \n            fatal\n          \n        \n    \n\n\n\n\n  \n      \n        \n          adam-mahar\n          \n        \n\n        \n            \n            \n              March 12, 2020,  2:19pm\n            \n        #1\n        \n      \n      \n        While pushing to Platform git repository from our Bitbucket runner, the pipeline fails with the following error:  fatal: the remote end hung up unexpectedly .\nHow can I fix that?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          gnufred\n          \n        \n\n        \n            \n              March 12, 2020,  2:16pm\n            \n        #2\n        \n      \n      \n        Bitbucket pipelines support the git clone --depth option which can cause this error.\nThis feature allows Bitbucket pipelines to fetch only a subset of your repository commit history as opposed to the full commit history. Unfortunately, when the pipeline pushes an incomplete history to your Platform repository, the Platform git server hangs and terminates transfer, causing your pipeline to fail with fatal: the remote end hung up unexpectedly.\nUntil we support shallow clones, the solution is to disable them. Setting depth: full in the bitbucket-pipelines.yml as shown in the below YAML block.\nclone:\n  depth: full\n\nSee the following documentation for further information:\n\ngit-clone\nConfigure bitbucket-pipelines.yml\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          bogdan-vasilescu\n          \n        \n\n        \n            \n              March 12, 2020,  2:29pm\n            \n        #3\n        \n      \n      \n        And for Gitlab, you will need to set git depth to 0 as described here.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Is there a build dependencies cache on Platform.sh?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/is-there-a-build-dependencies-cache-on-platform-sh/464", "documentId": "77e35b71e38d409e7132a246e6a3bb79a1682941", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Is there a build dependencies cache on Platform.sh?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            build-hook\n          \n        \n        \n          \n            cache\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              February 14, 2020,  7:24pm\n            \n        #1\n        \n      \n      \n        Are the contents of pip install, npm install, and yarn install cached from build to build?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              February 14, 2020,  7:25pm\n            \n        #2\n        \n      \n      \n        It does on successful builds, but if you want to clear that cache at any time you can do so with the command platform project:clear-build-cache.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Is it possible to open direct access to a db service?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/is-it-possible-to-open-direct-access-to-a-db-service/362", "documentId": "b4e6d174bb55d2dad7788094a4168b1e11685db2", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Is it possible to open direct access to a db service?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            mariadb\n          \n        \n        \n          \n            sql\n          \n        \n        \n          \n            mysql\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              July 23, 2019, 11:11am\n            \n        #1\n        \n      \n      \n        I need to allow auth0 to make queries to it in an incremental user migration. I could firewall it to an IP range for security, but I\u2019m not sure how to do this on Platform.sh?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          robert\n          \n        \n\n        \n            \n              July 23, 2019, 11:13am\n            \n        #2\n        \n      \n      \n        It\u2019s not possible to securely expose your database service directly to the internet using Platform.sh. As routes.yaml only supports http endpoints, you will need to consider putting a web-service in between the database and the internet to controll access.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Is it possible to run X-Debug on Platform.sh?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/is-it-possible-to-run-x-debug-on-platform-sh/357", "documentId": "17c5b97f4cdbff35709230033a384b22a62626a2", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Is it possible to run X-Debug on Platform.sh?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            debugging\n          \n        \n        \n          \n            php\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              July 19, 2019,  5:37pm\n            \n        #1\n        \n      \n      \n        I\u2019d like to do step through debugging on my PHP projects.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          robert\n          \n        \n\n        \n            \n              July 19, 2019,  5:37pm\n            \n        #2\n        \n      \n      \n        Yes. Please see the guide that was published here: https://ghosty.co.uk/2015/09/debugging-on-platform-sh/\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How do I fix `fatal: the remote end hung up unexpectedly` while pushing from a GitLab pipeline to Platform.sh?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-do-i-fix-fatal-the-remote-end-hung-up-unexpectedly-while-pushing-from-a-gitlab-pipeline-to-platform-sh/491", "documentId": "acbcd373287d9798fca8d1fe627541ce26853695", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How do I fix `fatal: the remote end hung up unexpectedly` while pushing from a GitLab pipeline to Platform.sh?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            gitlab\n          \n        \n        \n          \n            git\n          \n        \n        \n          \n            fatal\n          \n        \n    \n\n\n\n\n  \n      \n        \n          adam-mahar\n          \n        \n\n        \n            \n              March 12, 2020,  1:32pm\n            \n        #1\n        \n      \n      \n        While pushing to Platform git repository from our GitLab runner, the pipeline fails with the following error: fatal: the remote end hung up unexpectedly.\nHow can I fix that?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          gnufred\n          \n        \n\n        \n            \n            \n              March 12, 2020,  2:17pm\n            \n        #2\n        \n      \n      \n        The GitLab runner 8.9 introduced a new feature called shallow cloning.\nThis feature allows GitLab runner to fetch only a subset of your repository commit history as opposed to the whole commit history. Unfortunately, when the runner pushes an incomplete history to your Platform repository, the Platform git server hangs and terminates transfer, causing your pipeline to fail with fatal: the remote end hung up unexpectedly.\nUntil we support shallow clones, the solution is to disable them. Setting \u201cGit shallow clone\u201d to 0 as shown in the below screenshot will resolve the issue.\n\ngitlab_pipelines_settings.png725\u00d7561 42.2 KB\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Can I set a project variable to run different build scripts among several environments?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/can-i-set-a-project-variable-to-run-different-build-scripts-among-several-environments/249", "documentId": "c6b0509afded932fd334f1039d782ac31bdb65fc", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Can I set a project variable to run different build scripts among several environments?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          duncan\n          \n        \n\n        \n            \n              May 3, 2019,  3:15pm\n            \n        #1\n        \n      \n      \n        I would like a bash environment variable which would be different on environments at build time in order to build my app with it and configure different api endpoints differently.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              May 6, 2019, 10:54pm\n            \n        #2\n        \n      \n      \n        Only project level variables are available during build time, so you will not be able to create a variable that is different in each environment that will be accessible during builds.\nYou can create a project level variable using the CLI:\n$ platform variable:create --level project --name NAME --value 'some-value' --json false --sensitive false --prefix 'env:' --enabled true --visible-build true --visible-runtime false --project wiqte7at4yg22\n\nEach environment in your project will need to be redeployed in order for the changes to take affect by using the command\n$ platform redeploy &lt;environment name&gt;\n\nfor each environment.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Link to communicate multiple applications as web services in a form", "section": "Questions & Answers", "url": "https://community.platform.sh/t/link-to-communicate-multiple-applications-as-web-services-in-a-form/338", "documentId": "c3024acd7ddf2d7908a2022993590ba47a63f1ee", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Link to communicate multiple applications as web services in a form\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            microservices\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n              July 15, 2019, 12:16pm\n            \n        #1\n        \n      \n      \n        Given four applications into a single project that will work as microservices:\n\"https://{default}/conferences\":\n    id: conference\n    type: upstream\n    upstream: \"conference:http\"\n\n\"https://{default}/sessions\":\n    id: session\n    type: upstream\n    upstream: \"session:http\"\n\n\"https://{default}/speakers\":\n    id: speaker\n    type: upstream\nupstream: \"speaker:http\"\n\nHow can I make HTTP request to each other?\nE.g:\nInto conference application, how can I do a request into a speaker? Such as HTTP GET http://somehost/speakers\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              July 25, 2019,  8:32pm\n            \n        #2\n        \n      \n      \n        To have applications talk to each other add the relationship to the application that wants to initiate the connection.  For example, to have the conference application in the example above talk to the speakers application, add the following to the conference instance\u2019s .platform.app.yaml file:\nrelationships:\n    speaker: speaker:http\n\nThen you can consult the PLATFORM_RELATIONSHIPS environment variable for the domain name to use to send messages to that application.  Omit the speaker application from routes.yaml entirely.\nThat is preferable to exposing each application on its own public URL just so that it can be accessed from another application.\nNote that circular relationships are not supported, so you cannot have two applications that refer to each other in their relationships blocks.  Only the \u201csending\u201d side of the connection needs to have a relationship defined.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "(Solved) Pyodbc install fails", "section": "Questions & Answers", "url": "https://community.platform.sh/t/solved-pyodbc-install-fails/450", "documentId": "f7cc5dfd5ed1286fd234625b596f4dd981ceda92", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  (Solved) Pyodbc install fails\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            django\n          \n        \n        \n          \n            python\n          \n        \n        \n          \n            databases\n          \n        \n    \n\n\n\n\n  \n      \n        \n          georgebglamorise\n          \n        \n\n        \n            \n            \n              February 5, 2020,  7:07pm\n            \n        #1\n        \n      \n      \n        Currently working on setting up a django app that needs a mssql database connection. The mssql library (posted below) operates off of Pyodbc. Pyodbc has a requirement of unixodbc. Unfortunately, Im having issues with getting this requirement installed.\n\n  \n      \n      GitHub\n  \n  \n    \n\nESSolutions/django-mssql-backend\n\nDjango backend for Microsoft SQL Server. Contribute to ESSolutions/django-mssql-backend development by creating an account on GitHub.\n\n\n  \n  \n    \n    \n  \n  \n\n\n\n  \n      \n      GitHub\n  \n  \n    \n\nmkleehammer/pyodbc\n\nPython ODBC bridge. Contribute to mkleehammer/pyodbc development by creating an account on GitHub.\n\n\n  \n  \n    \n    \n  \n  \n\n\nhttp://www.unixodbc.org/\nCurrently trying to following to get the dependency installed.\nexport LD_LIBRARY_PATH=$LIBDIR:/app/unixODBC-2.3.7\n    wget http://www.unixodbc.org/unixODBC-2.3.7.tar.gz\n    gunzip unixODBC*.tar.gz\n    tar xvf unixODBC*.tar\n    cd unixODBC*\n    mkdir /app/unixODBC-2.3.7/etc\n    ./configure --prefix=/app/unixODBC-2.3.7 --sysconfdir=/app/unixODBC-2.3.7\n    make\n    make install\n\nThe last error Im getting is below.\nmake[2]: Nothing to be done for 'install-exec-am'.\n     /bin/mkdir -p '/app/unixODBC-2.3.7/include'\n     /usr/bin/install -c -m 644 odbcinst.h odbcinstext.h sql.h sqlext.h sqltypes.h sqlucode.h sqlspi.h autotest.h uodbc_stats.h uodbc_extras.h '/app/unixODBC-2.3.7/include'\n    W: /usr/bin/install: 'odbcinst.h' and '/app/unixODBC-2.3.7/include/odbcinst.h' are the same file\n    W: /usr/bin/install: 'odbcinstext.h' and '/app/unixODBC-2.3.7/include/odbcinstext.h' are the same file\n    W: /usr/bin/install: 'sql.h' and '/app/unixODBC-2.3.7/include/sql.h' are the same file\n    W: /usr/bin/install: 'sqlext.h' and '/app/unixODBC-2.3.7/include/sqlext.h' are the same file\n    W: /usr/bin/install: 'sqltypes.h' and '/app/unixODBC-2.3.7/include/sqltypes.h' are the same file\n    W: /usr/bin/install: 'sqlucode.h' and '/app/unixODBC-2.3.7/include/sqlucode.h' are the same file\n    W: /usr/bin/install: 'sqlspi.h' and '/app/unixODBC-2.3.7/include/sqlspi.h' are the same file\n    W: /usr/bin/install: 'autotest.h' and '/app/unixODBC-2.3.7/include/autotest.h' are the same file\n    W: /usr/bin/install: 'uodbc_stats.h' and '/app/unixODBC-2.3.7/include/uodbc_stats.h' are the same file\n    W: /usr/bin/install: 'uodbc_extras.h' and '/app/unixODBC-2.3.7/include/uodbc_extras.h' are the same file\n    W: make[2]: *** [install-includeHEADERS] Error 1\n    Makefile:409: recipe for target 'install-includeHEADERS' failed\n    make[2]: Leaving directory '/app/unixODBC-2.3.7/include'\n    W: make[1]: *** [install-am] Error 2\n    Makefile:525: recipe for target 'install-am' failed\n    make[1]: Leaving directory '/app/unixODBC-2.3.7/include'\n    W: make: *** [install-recursive] Error 1\n    Makefile:548: recipe for target 'install-recursive' failed\n\nAny help with getting this dependency installed would be much appreciated.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          georgebglamorise\n          \n        \n\n        \n            \n            \n              February 21, 2020,  8:33pm\n            \n        #2\n        \n      \n      \n        After debugging and testing with the PSH support team, I was able to get a passing build\n@matthias-van-woensel suggested utilizing brew for managing the dependencies, and following was my build set for this to work.\n\nEdit:\nAfter this post, I found a new flaw in my approach. I planned to use  the Microsoft ODBC driver that is available via Debian package. This brought up the new concern of not being able to use Debian package managers in the PSH environment. I also had some troubles shipping the driver right in my repo, but the details below will mention how to debug the driver issues.\nhttps://docs.microsoft.com/en-us/sql/connect/odbc/linux-mac/installing-the-microsoft-odbc-driver-for-sql-server?view=sql-server-ver15#microsoft-odbc-driver-17-for-sql-server\nI was not previous aware of FreeTDS. FreeTDS is an open source ODBC Sql Server driver.\nhttp://www.freetds.org/\nFortunately, like the unixODBC driver manage, this driver is available through homebrew. Below is my final build hook step to install all dependancies to connect to a Sql Server instance from a PSH python container.\nBelow is the .odbc.ini file I used to tell register my FreeTDS driver with unixODBC that pyodbc will register. Location of this file can suit your preference, but update your build hook to match any change in location.\nFinal Build Hook:\nsh -c \"$(curl -fsSL https://raw.githubusercontent.com/Linuxbrew/install/master/install.sh)\"\n    echo 'eval $(/app/.linuxbrew/bin/brew shellenv)' &gt;&gt;~/.profile\n    eval $(/app/.linuxbrew/bin/brew shellenv)\n    brew analytics off\n    brew install gcc\n    brew install openssl\n    brew install freetds\n    brew install unixodbc\n    odbcinst -i -d -f /app/.odbc.ini\n    pipenv install --system --deploy\n    mkdir .ssh\n\n.odbc.ini\n[FreeTDS]\nDescription\t= TDS driver (Sybase/MS SQL)\nDriver\t\t= /app/.linuxbrew/lib/libtdsodbc.so\n\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Will removing the account that created an integration break the integration?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/will-removing-the-account-that-created-an-integration-break-the-integration/204", "documentId": "b838fb03a6c269d2ce82c1e796115a00c13b181a", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Will removing the account that created an integration break the integration?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            github\n          \n        \n        \n          \n            integrations\n          \n        \n        \n          \n            gitlab\n          \n        \n        \n          \n            bitbucket\n          \n        \n    \n\n\n\n\n  \n      \n        \n          gilzowp\n          \n        \n\n        \n            \n            \n              April 15, 2019,  2:30pm\n            \n        #1\n        \n      \n      \n        in regards to integrations, if the project admin that creates the original integration is later removed from the project, will the integration break?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          robert\n          \n        \n\n        \n            \n              April 15, 2019,  2:30pm\n            \n        #2\n        \n      \n      \n        No, the integrations will not break. This can be done safely on integrations such as GitHub, GitLab, and Bitbucket.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "If I add a service, can I still restore a snapshot from before that service existed?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/if-i-add-a-service-can-i-still-restore-a-snapshot-from-before-that-service-existed/298", "documentId": "40f349bde2219d59766266cfb00a5ea3ea6775d3", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  If I add a service, can I still restore a snapshot from before that service existed?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            backups\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              June 3, 2019,  3:40pm\n            \n        #1\n        \n      \n      \n        Adding a new service (eg. a new MongoDB) changes the persistent data model of my project. Does that render it incompatible with backups/snapshots made before?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              February 12, 2020, 10:20pm\n            \n        #2\n        \n      \n      \n        Yes, a backup taken before service was added will be incompatible with your configuration.\nA backup is a collection of the persistent storage backups for each service (and application) containers. When a restore takes place, each of those individual backups is applied to each service one by one. Of course, the new MongoDB service is not included in that backup, but the problem occurs in the step right before the backups are applied.\nAll of the persistent data in the environment is erased first, in order to make way for the backups to be applied. This, in combination with MongoDB missing from the backup, will result in data loss.\nYou can take a look at the tutorial here for a more comprehensive look at some of these consequences in this case and in the case of newly added mounts.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Given a project that there are five microservices, is there any way to make four private and just one public?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/given-a-project-that-there-are-five-microservices-is-there-any-way-to-make-four-private-and-just-one-public/340", "documentId": "0f794d30468bf2aae863b8784788b117bafe5b4b", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Given a project that there are five microservices, is there any way to make four private and just one public?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            microservices\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n              July 15, 2019, 12:18pm\n            \n        #1\n        \n      \n      \n        Given four applications into a single project that will work as microservices:\n\"https://{default}/conferences\":\n    id: conference\n    type: upstream\n    upstream: \"conference:http\"\n\n\"https://{default}/sessions\":\n    id: session\n    type: upstream\n    upstream: \"session:http\"\n\n\"https://{default}/speakers\":\n    id: speaker\n    type: upstream\nupstream: \"speaker:http\"\n\n\"https://{default}/\":\n  type: upstream\n  upstream: \"app:http\"\n\nHow can we make some resources as private? I mean, how can I make that all services internally communicate via HTTP, but just the app accesses publicly?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              July 25, 2019,  8:30pm\n            \n        #2\n        \n      \n      \n        There is no need to make an application container public.  If it\u2019s not listed in routes.yaml then it will not be accessible to the outside world at all.\nInstead, to have applications talk to each other add the relationship to the application that wants to initiate the connection.  For example, to have the app application in the example above talk to the speakers application, add the following to the app instance\u2019s .platform.app.yaml file:\nrelationships:\n    speaker: speaker:http\n\nThen you can consult the PLATFORM_RELATIONSHIPS environment variable for the domain name to use to send messages to that application.  Omit the speaker application from routes.yaml entirely.\nThat is preferable to exposing each application on its own public URL just so that it can be accessed from another application.\nNote that circular relationships are not supported, so you cannot have two applications that refer to each other in their relationships blocks.  Only the \u201csending\u201d side of the connection needs to have a relationship defined.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "The environment \"master\" is not currently active", "section": "Questions & Answers", "url": "https://community.platform.sh/t/the-environment-master-is-not-currently-active/268", "documentId": "af589c7eef189f10741ec4cca638716d823f3e80", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  The environment \"master\" is not currently active\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          travis.raup\n          \n        \n\n        \n            \n            \n              May 8, 2019,  8:22pm\n            \n        #1\n        \n      \n      \n        I created a new project and tried to use the Platform CLI to SSH into my project\u2019s environment via platform ssh and received the following warning message.\nCould not find applications: the environment \"master\" is not currently active.\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              May 16, 2019,  1:01pm\n            \n        #2\n        \n      \n      \n        You will receive that error on a created project that has not yet been initialized with a code base.\nThe master environment is automatically activated when you push your code to it, so run the following commands from your local project repository:\n\n\nSet Platform.sh as remote\n$ platform project:set-remote &lt;project ID&gt;\nSetting the remote project for this repository to: myapp (&lt;project ID&gt;)\n\nYou can retrieve your &lt;project ID&gt; with the command platform project:list.\n\n\nPush to Platform.sh\nIf you have not already initialized a Git repository for your project, first run git init. Then,\n$ git add .\n$ git commit -m \"Moving to Platform.sh.\"\n$ git push platform master\n\n\n\nWhen the build process has completed you can SSH into master with:\n$ platform ssh\n\n\n\nIf in the future you add and push a development branch to Platform.sh, unlike master that branch dev will not automatically be activated. In order to SSH into dev, you can activate it from within your local project directory using\n$ git checkout dev\n$ platform environment:activate\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I get information on the various Platform.sh regions?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-get-information-on-the-various-platform-sh-regions/331", "documentId": "54ae1dca7a71528abfcbaab9603efee406bb7cc1", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I get information on the various Platform.sh regions?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            regions\n          \n        \n        \n          \n            curl\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              July 11, 2019,  9:26am\n            \n        #1\n        \n      \n      \n        For example, which ones are available, where are they, what IaaS infrastructure do they run on?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          robert\n          \n        \n\n        \n            \n              July 11, 2019,  9:29am\n            \n        #2\n        \n      \n      \n        You can use our API like this:\ncurl -s -H \"Authorization: Bearer $(platform a:t)\" https://api.platform.sh/regions | json_pp\n\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Can I serve custom error pages (4xx, 5xx)?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/can-i-serve-custom-error-pages-4xx-5xx/287", "documentId": "91125cd3c3216585fca72286de3d0fd8742e437d", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Can I serve custom error pages (4xx, 5xx)?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          jgrubb\n          \n        \n\n        \n            \n              May 21, 2019, 12:43pm\n            \n        #1\n        \n      \n      \n        I\u2019d like to serve a custom error page when the application returns a 5xx error rather than the standard Platform.sh error page.  Can I do this?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n              July 25, 2019, 12:00pm\n            \n        #2\n        \n      \n      \n        What technologies are you using?\nIn general, yes, you can set your error pages.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "For Ruby on Rails, what's the best way to delete the database records?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/for-ruby-on-rails-whats-the-best-way-to-delete-the-database-records/455", "documentId": "a6d6f83688f4db3ba3cfff09bf2945b5ab193fb8", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  For Ruby on Rails, what's the best way to delete the database records?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            ruby\n          \n        \n        \n          \n            postgresql\n          \n        \n        \n          \n            databases\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              February 7, 2020,  6:57pm\n            \n        #1\n        \n      \n      \n        What\u2019s the best way to wipe my DB? I have a live ruby on rails site.  I would like to purge or delete the data from the master branch Posgres database. I\u2019d like to keep the tables intact, and only delete the rows from each. This is so that I can start my site development anew. My thinking is to change to the master branch in command line then following the reference below I would proceed with the command $ rake db:reset db:migrate Which will reset the database and reload the current schema. https://medium.com/forest-admin/rails-migrations-tricks-guide-code-cheatsheet-included-dca935354f22  Is this best way as its my first in production site no account or customers to worry about?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          oripekelman\n          \n        \n\n        \n            \n            \n              February 7, 2020,  7:00pm\n            \n        #2\n        \n      \n      \n        Safety first, so please create a backup as your first step.\nThen, And yes rake db:reset will drop all tables, it is the clean way to do this.\nI believe you can also do rake db:migrate:reset, which does a reset + a migrate\u2026\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n            \n              February 7, 2020,  7:02pm\n            \n        #3\n        \n      \n      \n        You could also rename the service in services.yaml and the reference to it in .platform.app.yaml. That will give you a \u201cnew\u201d service with no data in it, discarding the old one.\nAnd then just do the table-create/insert command (presumably rake db:migrate ).\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "MongoDB configuration at Platform.sh", "section": "Questions & Answers", "url": "https://community.platform.sh/t/mongodb-configuration-at-platform-sh/341", "documentId": "d6501f7b860fc58c11b2f62e2e1c2f5108039c63", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  MongoDB configuration at Platform.sh\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            databases\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n              July 15, 2019, 12:19pm\n            \n        #1\n        \n      \n      \n        How the replica set works at Platform.sh?\nHow to do a query on a MongoDB database using a UI client such as MongoDB Compass?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              February 7, 2020,  8:22pm\n            \n        #2\n        \n      \n      \n        To connect to MongoDB, or any other service, from your local system, first open an SSH tunnel using the platform tunnel:open command.  That will establish a secure connection to your environment from your local computer and expose local ports you can connect to.\nYou can then enter the credentials into your local tool, be it MongoDB Compass or otherwise.  The host will be localhost, the port will be one of the 30xxx ports reported by tunnel:open, and the user and password can be obtained by running platform relationships.\nSee the documentation for more details.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I access the live site using the original Platform-provided URLs?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-access-the-live-site-using-the-original-platform-provided-urls/279", "documentId": "eba4bb69d70fd641943ca122f14d8446ab300f33", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I access the live site using the original Platform-provided URLs?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            routes-yaml\n          \n        \n        \n          \n            urls\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              May 14, 2019,  2:35pm\n            \n        #1\n        \n      \n      \n        If I \u201cgo live\u201d, I lose the ability to go directly to the *.platformsh.site url. Can I go back to using that at any point?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          dman\n          \n        \n\n        \n            \n            \n              May 15, 2019,  8:11am\n            \n        #2\n        \n      \n      \n        You can add it explicitly as a route in routes.yaml in addition to the \u201c{default}\u201d route(s).\nBear in mind that having the site publicly available on development URLs (or multiple URLs simultaneously) can pollute SEO or analytics results. Normally a redirect to one canonic domain would be a better idea.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How do I share files between multiple applications?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-do-i-share-files-between-multiple-applications/304", "documentId": "e7717e7424e4944214cb9d41863c183bdad0cfb6", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How do I share files between multiple applications?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n              June 5, 2019,  1:28pm\n            \n        #1\n        \n      \n      \n        I have a multi-app project, and a mounted directory of files that I would like all applications to have access to. How do I accomplish this?\nProject structure:\nfiles/\napplication1/\n   .platform.app.yaml\n   ..\napplication2/\n   .platform.app.yaml\n   ..\n..\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              June 11, 2019,  8:16pm\n            \n        #2\n        \n      \n      \n        In order to share writeable files across applications you need to use a network-storage service.  That is, rather than the writeable directory living on each application container they both share a network mount to the same network drive.\nSee the documentation link above for specific instructions.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How do I monitor my application outgoing emails?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-do-i-monitor-my-application-outgoing-emails/243", "documentId": "ae937b2ce7facc9fa4537a29bdfb474a4914fabf", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How do I monitor my application outgoing emails?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            email\n          \n        \n    \n\n\n\n\n  \n      \n        \n          gnufred\n          \n        \n\n        \n            \n              May 3, 2019,  1:26pm\n            \n        #1\n        \n      \n      \n        Hi Platform,\nMy client application monitor physical hardware device and monitor users by mail. Therefore, emails are critical to the application.\nWe need to ensure that email services are constantly working as expected and that emails are delivered correctly to users.\nHow can I achieve that?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              February 7, 2020,  8:48pm\n            \n        #2\n        \n      \n      \n        If you use the built-in mail support provided by Platform.sh on Grid accounts, we provide a best-effort delivery but deliver is not 100% guaranteed.\nIf email delivery is application-critical and/or you will be sending a large amount of email, we recommend you obtain an account with one of the many email management services on the market.  They can provide you with an SLA for email delivery as well as higher limits than what we offer.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Odoo 13 + python", "section": "Questions & Answers", "url": "https://community.platform.sh/t/odoo-13-python/447", "documentId": "90f9691ccacfb0b88dcaa43e7130e697d701d158", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Odoo 13 + python\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            python\n          \n        \n    \n\n\n\n\n  \n      \n        \n          daniel-harper-893\n          \n        \n\n        \n            \n              January 24, 2020,  5:17pm\n            \n        #1\n        \n      \n      \n        Has anybody got the latest version of Odoo running on platform successfully ?\nCheers Dan\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              February 7, 2020,  8:37pm\n            \n        #2\n        \n      \n      \n        I\u2019m not aware of anyone running Odoo.  Looking at their site, it looks like it should be possible using the manual setup.  I\u2019ve not tried it myself, though.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          daniel-harper-893\n          \n        \n\n        \n            \n              February 16, 2020, 12:18pm\n            \n        #3\n        \n      \n      \n        Thanks @Crell I\u2019ll take a look and report back.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to build and deploy Angular Universal app?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-to-build-and-deploy-angular-universal-app/526", "documentId": "d9d4feb1032ecee37fd80398ac05f73191ca42e1", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to build and deploy Angular Universal app?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            nodejs\n          \n        \n        \n          \n            build-hook\n          \n        \n    \n\n\n\n\n  \n      \n        \n          Lith\n          \n        \n\n        \n            \n            \n              April 14, 2020,  9:31pm\n            \n        #1\n        \n      \n      \n        Hello  ,\nWe are using latest release of Angular Universal 9 with ivy (next-gen compatibility compiler) but we have an unexpected problem when we tried to build and deploy the app.\nWe launch Ivy compilation in postinstall in sync mode script in order to avoid out of memory error, but the build doesn\u2019t works\u2026\nHow to deploy our application quickly without memory error ?\nWe used \u201cL\u201d plan with 6Gb of Ram, it\u2019s 3x more than our older PaaS system.\nI provide most information about it, below :\nBuild Hook\nyarn install\nyarn run build:ssr:dev\n\nThe command build:ssr:dev launch webpack compilation :\nng run website:build:dev &amp;&amp; ng run website:server:dev\n\nThe website will be compiled to the dist directory but this is currently not working :\nBuild output error log\n$ ng run website:build:dev &amp;&amp; ng run website:server:dev\n        Generating ES5 bundles for differential loading...\n        W: An unhandled exception occurred: Call retries were exceeded\n        W: See \"/tmp/ng-1pShkt/angular-errors.log\" for further details.\n        W: error Command failed with exit code 127.\n        info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.\n\nThe file /tmp/ng-1pShkt/angular-errors.log  is not available, so I can\u2019t debug log.\nHow to see Angular build error log ?\nHow to build Angular application ? (Your documentation is only for AngularJS and it\u2019s an old version, completely differente of Angular \u201cnext gen\u201d).\nThanks for your help \n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          jared-wright\n          \n        \n\n        \n            \n              April 15, 2020,  4:21pm\n            \n        #2\n        \n      \n      \n        Hi Lith,\nPlease try adding the following to the end of your build hook to view this build error.\ncat /tmp/*/angular-errors.log\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Lith\n          \n        \n\n        \n            \n              April 16, 2020,  8:43am\n            \n        #3\n        \n      \n      \n        Hello @jared-wright,\nThank you for your answer !\nI\u2019ve tried our solution to read error log, but the content is bit limited\u2026 \n[error] Error: Call retries were exceeded\n            at ChildProcessWorker.initialize (/app/node_modules/jest-worker/build/workers/ChildProcessWorker.js:230:21)\n            at ChildProcessWorker._onExit (/app/node_modules/jest-worker/build/workers/ChildProcessWorker.js:307:12)\n            at ChildProcess.emit (events.js:310:20)\n            at Process.ChildProcess._handle.onexit (internal/child_process.js:275:12)\n\nDoes it possible to have the hardware description of the Platform.sh CI ?\nThis error occurs with Angular sometimes because of memory limit.\nDo you know if someone has already use (with success) Angular Universal on Platform.sh ?\nThanks \n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          jared-wright\n          \n        \n\n        \n            \n              April 16, 2020,  9:16am\n            \n        #4\n        \n      \n      \n        Hi Lith,\nI would check out template and example projects;\n\n  \n      \n      GitHub\n  \n  \n    \n\nPlatform.sh Templates\n\nProject Templates maintained by Platform.sh. Platform.sh Templates has 70 repositories available. Follow their code on GitHub.\n\n\n  \n  \n    \n    \n  \n  \n\n\n\n  \n      \n      GitHub\n  \n  \n    \n\nPlatform.sh Examples\n\nExample projects and proof-of-concepts for Platform.sh - Platform.sh Examples\n\n\n  \n  \n    \n    \n  \n  \n\n\nI would also recommend adjust your build to just perform  ng run website:build:dev and start your application ng run website:server:dev using the start command. https://docs.platform.sh/languages/nodejs.html#configuration\nThe issue may be that you are starting your application inside the build container.\nIf you continue to have issues, I would recommend creating a support ticket, so we can check your project and  .platform.app.yaml.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          Lith\n          \n        \n\n        \n            \n              April 16, 2020,  9:29am\n            \n        #5\n        \n      \n      \n        Thanks.\nPlatform.sh templates and examples doesn\u2019t provide information for an Angular project for now.\nConcerning the build and start part, I will try to explain how Angular Universal works, description below.\nWe are using Angular Universal, so we use Webpack to compile server and browser files :\nI\u2019ve separate the build in two \u201crun\u201d, first, we build the server files (server side) :\nng run website:server:dev\n\nThe second part build the browser files (client side) :\nng run website:build:dev\n\nAll files build with this command create a dist folder with the following tree :\n/dist\n    /website\n       /browser   /* browser part -&gt; client side */\n           ... \n       /server     /* server part -&gt; server side */\n           main.js\n           main.js.map\n\nThe server part seems to be correctly build but the browser part failed in mid-build with the error previously provided.\nThen, we launch the start command with pm2 like this :\nweb:\n  commands:\n    start: \"PM2_HOME=/app/run pm2 start dist/website/server/main.js\"\n\nI\u2019ve also wrote a ticket to support in order to have some technical help with our configuration files  \nThanks !\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Is it possible to increase Redis `maxmemory` configuration option?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/is-it-possible-to-increase-redis-maxmemory-configuration-option/350", "documentId": "c28d4bd191ea8eeb5b88a1c3752dcae177113123", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Is it possible to increase Redis `maxmemory` configuration option?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            redis\n          \n        \n        \n          \n            container-size\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              July 18, 2019, 10:20am\n            \n        #1\n        \n      \n      \n        I tried bumping up cluster size to L and adding a configuration: { maxmemory: 134217728 } to redis service but I did not manage to change the default 28MB limit.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          robert\n          \n        \n\n        \n            \n            \n              July 18, 2019, 10:20am\n            \n        #2\n        \n      \n      \n        Unfortunately the answer is no, the maxmemory for Redis isn\u2019t configurable. However, you could try increasing the container size, which should increase the maxmemory for the service. The Redis service will use all the available memory in the container, so container sizing is the way to increase that.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to get ssh connection details from the commandline?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-to-get-ssh-connection-details-from-the-commandline/284", "documentId": "d0eea81555fc5edb8f7d9d2faa61f54c046929b6", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to get ssh connection details from the commandline?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            ssh\n          \n        \n    \n\n\n\n\n  \n      \n        \n          dman\n          \n        \n\n        \n            \n              May 17, 2019,  2:33am\n            \n        #1\n        \n      \n      \n        I know I can find ssh connection info from the management console, but I\u2019d prefer not to switch out of my terminal to get this each time, or I want to automate a connection from a process of my own.\nI don\u2019t recognise the IDs in that connection string, do they change?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          dman\n          \n        \n\n        \n            \n              May 17, 2019,  2:50am\n            \n        #2\n        \n      \n      \n        The ssh connection string provided in your projects management console can also be found from the CLI if you have already installed and authenticated with the platform cli tool.\nThe easiest way to ssh in directly from the cli is just with:\nplatform ssh\n\nbut if you want to get the ssh connection string that it\u2019s using directly, you can use\n$ platform ssh --pipe\n\nwhich will return something like:\nyh3p3drn4gglu-master-7rqtwti--playbook@ssh.au.platform.sh\n\nThis pattern is usually in the form $PROJECT-$ENV-$SLUG--$APP@ssh.$REGION.platform.sh, and is not expected to change over time.\nNote that the \u2018user\u2019 part of the connection string seen here is used for routing to your project, and is not the userid you end up with on the box.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I connect to my database from my local workstation?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-connect-to-my-database-from-my-local-workstation/207", "documentId": "447d2f9fa82f2eafcd7d78f63b96c1ccac0a7fdc", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I connect to my database from my local workstation?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            databases\n          \n        \n    \n\n\n\n\n  \n      \n        \n          andrew-kester\n          \n        \n\n        \n            \n            \n              April 16, 2019,  4:05pm\n            \n        #1\n        \n      \n      \n        I need to import data into my database from a local file.  How can I do that from my local workstation?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          tony\n          \n        \n\n        \n            \n              April 16, 2019,  4:23pm\n            \n        #2\n        \n      \n      \n        For that you can use the Platform CLI tool and run platform sql &lt; my_local.sql. More information can be found on our docs site.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Use the same root domain across multiple projects", "section": "Questions & Answers", "url": "https://community.platform.sh/t/use-the-same-root-domain-across-multiple-projects/213", "documentId": "37227890bf7c94729cd8d8bf366cddf2dfa99091", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Use the same root domain across multiple projects\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            routes-yaml\n          \n        \n    \n\n\n\n\n  \n      \n        \n          michielkenis\n          \n        \n\n        \n            \n              April 17, 2019, 12:27pm\n            \n        #1\n        \n      \n      \n        We have two very similar projects and they\u2019ll be served onto the same root domain, project1.mysite.com and project2.mysite.com.\nSince we\u2019re using the public IPs of our cluster to connect DNS to P.sh, I do know you can only add a root domain once to the entire cluster (eu-2 in my case). In normal circumstances, you\u2019ll add mysite.com as (default) domain and using routes.yaml to handle your routing. But what if we provide a full domain, rather then a root domain to our domains? platform domain:add project.mysite.com rather then platform domain:add mysite.com.\nIs this possible of does it have any drawbacks in using this approach?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          jgrubb\n          \n        \n\n        \n            \n              April 18, 2019,  7:46pm\n            \n        #2\n        \n      \n      \n        If I understand correctly, this is no problem.  You\u2019d just have a route like\nhttps://{default}:\n...\n\nfor each, and the default domain would be the full subdomain string.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "When does a variable requires a JSON formatting?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/when-does-a-variable-requires-a-json-formatting/193", "documentId": "9fb8c9d995eda030e04a7da62fc2a66bc01ffb11", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  When does a variable requires a JSON formatting?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            env-variables\n          \n        \n    \n\n\n\n\n  \n      \n        \n          michielkenis\n          \n        \n\n        \n            \n              April 8, 2019,  3:40pm\n            \n        #1\n        \n      \n      \n        When providing environment variables, you have the option to provide JSON formatted values. What would be the deciding factor to create a JSON formatted variable?\nIn my case, I\u2019m looking to provide an empty string (\"\") as --value for my variable.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              April 11, 2019,  1:47pm\n            \n        #2\n        \n      \n      \n        JSON formatted variables are useful if you are trying to store variables like arrays. For your empty string example, you should be able to set an environment variable to an empty string, however if you would like to include that variable within a larger array, use JSON formatting.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Do redirects in `routes.yaml` file also show up in `PLATFORM_ROUTES`?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/do-redirects-in-routes-yaml-file-also-show-up-in-platform-routes/308", "documentId": "68fad5d48e478cbf875a15af854b3ae1d9e5d1a5", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Do redirects in `routes.yaml` file also show up in `PLATFORM_ROUTES`?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n              June 6, 2019,  6:37pm\n            \n        #1\n        \n      \n      \n        Is this even possible if I have many (thousands) of redirects since they would be stored in an environment variable?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              June 11, 2019,  8:22pm\n            \n        #2\n        \n      \n      \n        Yes, redirect routes still show in in the PLATFORM_ROUTES environment variable.  That means it is possible that having too many redirects will run into the environment variable length limit.\nIf you need a large number of redirects, there are two ways to reduce that overhead:\n\n\nUse regular-expression-based redirects.  If your redirects have common patterns they can usually be collapsed into a small number of regular-expression-based rules.\n\n\nHandle redirects in your application.  Your application will always have more knowledge of what redirects are needed and when than a statically configured rule in routes.yaml.  If you have a large or complex redirect ruleset, it is almost always better to handle that logic in proper application code rather than the routes configuration.  Most applications and frameworks have built-in redirect handling mechanisms that you can leverage.  Consult their documentation as appropriate.\n\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I force a PDF download with Platform.sh?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-force-a-pdf-download-with-platform-sh/334", "documentId": "a105b2d5ff78a6cfc2bbf00a0beb666b053ea296", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I force a PDF download with Platform.sh?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          chris.yates\n          \n        \n\n        \n            \n              July 12, 2019,  3:37pm\n            \n        #1\n        \n      \n      \n        I\u2019d like to force a PDF download from my static site, rather than have that PDF open in a browser. With Apache, I\u2019d do it like so:\n&lt;FilesMatch \"\\.(?i:pdf)$\"&gt;\nForceType application/octet-stream\nHeader set Content-Disposition attachment\n&lt;/FilesMatch&gt;\n\nHow do I do that with Platform.sh?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              July 25, 2019,  8:40pm\n            \n        #2\n        \n      \n      \n        You can set headers for static files in your .platform.app.yaml file.\nIn this specific case, you would include something like this:\nweb:\n    locations:\n        '/':\n            # ...\n            rules:\n                \\.pdf$:\n                    headers:\n                      Content-Type: application/octet-stream\n                      Content-Disposition: attachment\n\nSee the documentation for further examples.\nFor files served through your application rather than statically you would need to set the same headers from your application code.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Why is my site slow?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/why-is-my-site-slow/238", "documentId": "a7e031f4b5f88a883cf2c2abc4ebe9164eeee1b1", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Why is my site slow?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          bradhomer\n          \n        \n\n        \n            \n              May 2, 2019,  1:59pm\n            \n        #1\n        \n      \n      \n        It was fast before and works fine in my development environment.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              May 3, 2019,  9:58pm\n            \n        #2\n        \n      \n      \n        There are many possible reasons why a site may be unexpectedly slow in production.  The most common root causes are:\n\n\nCaching is not properly configured.\n\n\nThe site is not able to scale to a higher level of traffic or quantity of data than seen in development.\n\n\nCheck the router cache\nThe first thing to check is that the router cache is configured correctly.  On Platform.sh Professional the router includes a proxy cache out of the box but it must be configured correctly.  The most common error is not whitelisting session cookies, which results in any page with any cookie at all never getting cached, even just analytics cookies.  See the router cache documentation, specifically regarding the cookies property, for how to configure it properly.\nFor PHP projects there are also some additional tuning options available.  See the PHP tuning guide for steps you can take to optimize your PHP configuration.\nFurther optimization tends to be very language and application specific.  We strongly recommend using a good profiling tool to help locate particularly slow portions of your application.  Generally just knowing where it is slow will suggest why and how to correct it.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "What databases can I use in my project?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/what-databases-can-i-use-in-my-project/219", "documentId": "d6503bdc0ccb25dc94804067277f6debbb51dfa9", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  What databases can I use in my project?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          bogdan-vasilescu\n          \n        \n\n        \n            \n              April 19, 2019,  7:57am\n            \n        #1\n        \n      \n      \n        What database servers can I use in my project ? do you offer NoSQL DBs too ?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          robert\n          \n        \n\n        \n            \n              April 23, 2019,  5:54am\n            \n        #2\n        \n      \n      \n        Databases, and other services like caches, queues, indexers, are listed here.\nCurrently, our supported services include:\n\n Elasticsearch \n InfluxDB \n Memcached \n MongoDB \n MySQL \n Network Storage \n PostgreSQL \n Redis \n RabbitMQ \n Solr \n Varnish \n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How much disk space is available during the build hook for application code?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-much-disk-space-is-available-during-the-build-hook-for-application-code/181", "documentId": "0dafc0a8a0bc489b970cb753c0290d8c2721d0ae", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How much disk space is available during the build hook for application code?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            disk\n          \n        \n        \n          \n            build-hook\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              August 13, 2019, 11:00pm\n            \n        #1\n        \n      \n      \n        I\u2019m getting out of disk errors when running npm install.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          robert\n          \n        \n\n        \n            \n              March 25, 2019,  3:07pm\n            \n        #2\n        \n      \n      \n        It\u2019s fixed, currently 4GB, and we can increase that on request (in a ticket).\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I identify MySQL slow queries on the PaaS", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-identify-mysql-slow-queries-on-the-paas/321", "documentId": "dffcf254c30b4843d1ffdcc17987debf4028030a", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I identify MySQL slow queries on the PaaS\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            mysql-mariadb\n          \n        \n        \n          \n            databases\n          \n        \n    \n\n\n\n\n  \n      \n        \n          Gauthier\n          \n        \n\n        \n            \n              June 20, 2019,  7:40pm\n            \n        #1\n        \n      \n      \n        I have identified PHP scripts that are abnormally long to execute in some cases. (Thanks to the php.access.log)\nI\u2019m trying to find which MySQL request is taking so much time (up to 200 sec) and under which conditions.\nIs there a way to enable the mysql_slow_query log?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          daniel\n          \n        \n\n        \n            \n              September 10, 2019,  4:02am\n            \n        #2\n        \n      \n      \n        That would be a setting in my.cnf, which doesn\u2019t appear to be supported:\nhttps://docs.platform.sh/configuration/services/mysql.html#adjusting-mariadb-configuration\nI\u2019d instead sign up for a trial of New Relic, which should be able to give you the data you need:\nhttps://docs.platform.sh/administration/integrations/new-relic.html#new-relic\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How do I change my project name?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-do-i-change-my-project-name/242", "documentId": "595e2b4e3a1d806c0fe1f18e69c9e175f3132941", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How do I change my project name?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          matthias-van-woensel\n          \n        \n\n        \n            \n              May 3, 2019, 11:49am\n            \n        #1\n        \n      \n      \n        I have created a project, but I made a typo. Can I change the project name? Or do I have to delete and recreate the project completely?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              May 6, 2019, 11:12pm\n            \n        #2\n        \n      \n      \n        Modify the project name with the CLI\nIf you accidentally named your project Jedo Mind Tricks, you can modify its name using the Platform.sh CLI:\n$ platform project:info title \"Jedi Mind Tricks\"\nProperty title set to: Jedi Mind Tricks\nWaiting for the activity 3l7j5cn75c3wa (Chad Carlson changed project name to Jedi Mind Tricks):\n  [============================]  1 sec (complete)\nActivity 3l7j5cn75c3wa succeeded\n\nIf you are not in the local project directory, specify the project ID with the --project flag:\n$ platform project:info title \"Jedi Mind Tricks\" --project wiqte7at4yg22\n\nModify the project name with the management console\nFrom within your project on the management console, click the Settings tab at the top of the page. The next page will show the current project name.\nHover over until the Edit button becomes visible on the right of the page and click it. Update the Project name to  Jedi Mind Tricks and then click Save.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I use nutch to index my site?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-use-nutch-to-index-my-site/244", "documentId": "381b8fbd401374721cf57775976950ed27baad4e", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I use nutch to index my site?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          royall\n          \n        \n\n        \n            \n              May 3, 2019,  2:57pm\n            \n        #1\n        \n      \n      \n        I\u2019d like to use nutch to index my site and insert the index into Solr. How can I do this on Platform?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n              July 25, 2019, 11:54am\n            \n        #2\n        \n      \n      \n        Hey, how is it going?\nCould you provide move details about your site?\nWhat technologies are you using?\nBriefly.\nNow we have support to Java applications:\n\n  \n      \n      Platform.sh\n  \n  \n    \n\nJava: Hello, World! at Platform.sh\n\nToday, Platform.sh is announcing support for Java technologies. And in this post, we\u2019ll cover how easy it is to either create or move your Java application to Platform.sh.\nA quick refresher: a second-generation Platform-as-a-Service, Platform.sh is...\n\n\n  \n  \n    \n    \n  \n  \n\n\nTherefore, you can run Apache Nutch.\nApache Nutch requires some configuration at Solr at the :\nhttps://wiki.apache.org/nutch/NutchTutorial#Setup_Solr_for_search\nPlease, take a look at Configset:\nhttps://docs.platform.sh/configuration/services/solr.html#configsets\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "What is a best way to sync files from `develop` to `master`?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/what-is-a-best-way-to-sync-files-from-develop-to-master/354", "documentId": "7b8e79e465b810f99f8fbe28f0f71a3b8e14299c", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  What is a best way to sync files from `develop` to `master`?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            storage\n          \n        \n        \n          \n            platform-cli\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              July 19, 2019, 10:23am\n            \n        #1\n        \n      \n      \n        I need to move my files from the develop environment into master.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n              July 26, 2019, 12:28pm\n            \n        #2\n        \n      \n      \n        Could you be more specific when you talk about these files?\nDo you mean, source file?\nWe use git. Therefore, you can use either git rebase or git merge:\nhttps://git-scm.com/docs/git-rebase\nhttps://git-scm.com/docs/git-merge\nSeveral helpful tutorials explain both:\n\n  \n      \n      Medium \u2013 8 Feb 19\n  \n  \n    \n\ngit \u2014 Rebase vs Merge\n\nRebasing and merging are both designed to integrate changes from one branch into another branch but in different ways.\n\n  Reading time: 2 min read\n    \n\n  \n  \n    \n    \n  \n  \n\n\n\n  \n      \n      Atlassian\n  \n  \n    \n\nMerging vs. Rebasing | Atlassian Git Tutorial\n\nCompare git rebase with the related git merge command and identify all of the potential opportunities to incorporate rebasing into the typical Git workflow\n\n\n  \n  \n    \n    \n  \n  \n\n\nThe choose is more oriented to your business; there is the right way on the situation.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Is there a way to fail a build when one of the build hooks throws an error?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/is-there-a-way-to-fail-a-build-when-one-of-the-build-hooks-throws-an-error/366", "documentId": "f20e3972ce512b2a46f137423dd99618f1d1a4c6", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Is there a way to fail a build when one of the build hooks throws an error?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            build-hook\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              July 24, 2019,  1:44pm\n            \n        #1\n        \n      \n      \n        In my case I want to use npm clean-install instead of npm install to ensure that my package-lock and my package.json have not diverged.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          robert\n          \n        \n\n        \n            \n              July 24, 2019,  1:45pm\n            \n        #2\n        \n      \n      \n        Yes. To do this you need to start your build hook with set -e. That means :\n  -e  Exit immediately if a command exits with a non-zero status.\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          ralt\n          \n        \n\n        \n            \n              July 24, 2019,  1:53pm\n            \n        #3\n        \n      \n      \n        To be a bit more clear, if you don\u2019t use set -e, the build will exit with the exit code of the last command.\nFor example:\nls /folder/that/doesnt/exist\nexit 0\n\nWill exit with exit code \u201c0\u201d, for success. If you use set -e, the build will exit after the ls with the exit code that ls failed with.\nAnother option that is usually useful is set -o pipefail which will fail the build if a piped command fails.\nFor example:\nset -e\nls /folder/that/doesnt/exist | echo foo\nexit 0\n\nWill return with exit code 0.\nset -eo pipefail\nls /folder/that/doesnt/exist | echo foo\nexit 0\n\nWill return with a failure.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to run R Shiny on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-run-r-shiny-on-platform-sh/231", "documentId": "74911300e30bea1ef8e03eec83d2c373ccd73f67", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to run R Shiny on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            conda\n          \n        \n        \n          \n            r\n          \n        \n    \n\n\n\n\n  \n      \n        \n          nick\n          \n        \n\n        \n            \n            \n              April 29, 2019,  8:20pm\n            \n        #1\n        \n      \n      \n        Goal\nTo run R Shiny on Platform.sh.\nAssumptions\nYou will need:\n\nAn SSH key configured on your Platform.sh account\nAn empty Platform.sh project\n\nProblems\nPlatform.sh offers many different language runtimes by default, but some applications require different environments, such as data science applications which use R Shiny. By installing the Miniconda Python package manager, it is possible to run R applications, such as R Shiny, on Platform.sh.\nSteps\n1. Set git remote to Platform.sh project\n$ git init\n$ platform project:set-remote &lt;project id&gt;\n\n2. Create an installation script file\nThe Platform.sh build hook runs Dash, not Bash, so the installation script is executed separately in install_r.sh:\n#!/bin/bash\n\n# Download the latest Miniconda3 release and name the file `conda.sh`\ncurl https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -o conda.sh\n\n# Run the downloaded `conda.sh` script using bash\n# \u2014 Use the `-b` flag to run the installer in batch mode\n# \u2014 Use the `-p` flag to specify where the package manager will actually be installed\nbash conda.sh -b -p $PLATFORM_APP_DIR/conda\n\n# Source the following `conda.sh` file to put the `conda` command in our path for the duration of this script\n. /app/conda/etc/profile.d/conda.sh\n\n# Add the above command to `.bash_profile` so that it is available during SSH sessions\necho \". /app/conda/etc/profile.d/conda.sh\" &gt;&gt; ~/.bash_profile\necho \"conda activate\" &gt;&gt; ~/.bash_profile\n\n# Enter the base conda environment and make sure it is up to date\nconda activate base\nconda update -n base -c defaults conda\n\n# Install R\n# `r-essentials` is a bundle of 80 common R packages, including `r-shiny`.\n# Remove `r-essentials` from the line below to only have a barebones install.\n# The `-n` flag gives the environment its name.\nconda create -n r-env r-essentials r-base\n\n# Activate the freshly created environment\nconda activate r-env\n\n# Install additional packages if desired\n# conda install r-rbokeh\n\nIMPORTANT: When using conda to install R packages, you will need to add r- before the regular CRAN or MRAN name. For instance, if you want to install rbokeh, you will need to use conda install r-rbokeh.\n3. Add a start script for running scripts with R\nstart_command.sh:\n#!/bin/bash\n\n# Source the `conda.sh` file to make this particular shell session able to run the `conda` command\n. /app/conda/etc/profile.d/conda.sh\n\n# Activate the conda environment that was created in the build hook\nconda activate r-env\n\n# Run the Shiny web app\nRscript start_shinyapp.R\n\n4. Add a Shiny app in the shinyapp directory\nIn the file shinyapp/app.R:\nlibrary(shiny)\n\n# Define UI for application that draws a histogram\nui &lt;- fluidPage(\n\n   # Application title\n   titlePanel(\"Old Faithful Geyser Data\"),\n\n   # Sidebar with a slider input for number of bins\n   sidebarLayout(\n      sidebarPanel(\n         sliderInput(\"bins\",\n                     \"Number of bins:\",\n                     min = 1,\n                     max = 50,\n                     value = 30)\n      ),\n\n      # Show a plot of the generated distribution\n      mainPanel(\n         plotOutput(\"distPlot\")\n      )\n   )\n)\n\n# Define server logic required to draw a histogram\nserver &lt;- function(input, output) {\n\n   output$distPlot &lt;- renderPlot({\n      # generate bins based on input$bins from ui.R\n      x    &lt;- faithful[, 2]\n      bins &lt;- seq(min(x), max(x), length.out = input$bins + 1)\n\n      # draw the histogram with the specified number of bins\n      hist(x, breaks = bins, col = 'darkgray', border = 'white')\n   })\n}\n\n# Run the application\nshinyApp(ui = ui, server = server)\n\n5. Add a script for running the R app\nCreate the R script start_shinyapp.R:\nlibrary(shiny)\noptions(shiny.host = \"0.0.0.0\")\noptions(shiny.port = 8888)\nrunApp('shinyapp')\n\n6. Add .platform.app.yaml\nCreate the .platform.app.yaml configuration file:\n# The name of this app. Must be unique within a project.\nname: app\n\n# The runtime the application uses.\ntype: \"python:3.7\"\n\n# The hooks executed at various points in the lifecycle of the application.\nhooks:\n    build: |\n      set -e\n\n      # The build hook uses `dash` rather than `bash`.\n      # Thus, the installation occurs in separate script that runs with `bash`.\n      bash install_r.sh\n\n    deploy: |\n      set -e\n\n      # Make the start script executable\n      chmod +x start_command.sh\n\n# The size of the persistent disk of the application (in MB).\ndisk: 1024\n\n# The configuration of app when it is exposed to the web.\nweb:\n    commands:\n        start: bash ./start_command.sh\n    upstream:\n        socket_family: tcp\n        protocol: http\n    locations:\n        \"/\":\n            passthru: true\nvariables:\n    env:\n        PORT: 8888\n\n7. Define routes\n./.platform/routes.yaml\nhttp://{default}/:\n  type: redirect\n  to: \"https://{default}/\"\n\nhttps://{default}/:\n  type: upstream\n  upstream: \"app:http\"\n  primary: true\n  id: http\n  cache:\n      enabled: false\n\n8. Add empty services\n./.platform/services.yaml\n# empty\n\n9. Add, commit, and push these files to your Platform.sh project\ngit add .\ngit commit -m \"Adding configuration to install R Shiny\"\ngit push platform master\n\n10. Visit the URL on the app that was just created\nplatform url\n\nConclusion\nBy executing the Anaconda or Miniconda installation Bash scripts in the build hook, a project is able to install an Conda-based execution environment on Platform.sh.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to forward Platform.sh logs to a Splunk Indexer", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-forward-platform-sh-logs-to-a-splunk-indexer/196", "documentId": "070ab113a3f9ad83c806f83fdbe6f5c0552a23e0", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to forward Platform.sh logs to a Splunk Indexer\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            logs\n          \n        \n        \n          \n            splunk\n          \n        \n        \n          \n            mounts\n          \n        \n        \n          \n            pycon2019\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              April 30, 2019,  8:04pm\n            \n        #1\n        \n      \n      \n        Goal\nTo forward Platform.sh logs into a Splunk indexer.\nAssumptions\n\nAn active Platform.sh project\n\nPlatform.sh CLI tool installed locally\n\nSSH key configured with the project account\nA Splunk instance installed on the indexing server that is configured to receive logs on a specified port (default 9997) and a configured admin login.\n\nProblems\nForwarding Platform.sh to a third-party indexer such as Splunk is useful, especially when integrating log monitoring across other projects, including those that are not hosted on Platform.sh. Splunk creates configuration, auth and forwarding files when shipping logs, which must be taken into account on Platform.sh\u2019s read-only file system.\nSplunk log forwarding is, in its simplest configuration, dependent on configuring two components: a Receiver/Indexer and a Forwarder. The Forwarder will be installed on a writable mount on a Platform.sh project and is responsible for collecting and shipping the desired log files, whereas the Indexer receives those files and provides a dashboard for indexing, searching, and analyzing them. Splunk actions can be executed either through that dashboard or through its CLI.\nThe following How-to is written to ship logs from a Python application, but the steps do not require that.\nMore information regarding accessing Platform.sh logs can be found in the public documentation.\nSteps (Splunk Indexer)\nThis How-to is based on installing Splunk Enterprise on a local machine, but an Indexer can be created using another Splunk product that is set-up remotely. Consult the Splunk documentation to determine the correct Indexer installation.\nA Splunk receiver has to be enabled to receive forwarded logs on a specified port. By default, the dedicated port for Splunk indexer\u2019s is 9997, and it can be enabled to listen on that port either through the dashboard or using the CLI. Consult the Splunk documentation for full details on how to do that: Enable a receiver.\nSteps (Splunk Universal Forwarder)\n1. Configure routes and services\nThe project locally will ultimately have the following structure:\n.\n\u251c\u2500\u2500 .platform\n\u2502   \u251c\u2500\u2500 routes.yaml\n\u2502   \u2514\u2500\u2500 services.yaml\n\u251c\u2500\u2500 .platform.app.yaml\n\u251c\u2500\u2500 Pipfile\n\u251c\u2500\u2500 Pipfile.lock\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 config\n\u2502   \u2514\u2500\u2500 splunk\n\u2502       \u251c\u2500\u2500 scripts\n\u2502       \u2502   \u251c\u2500\u2500 config.sh\n\u2502       \u2502   \u251c\u2500\u2500 install.sh\n\u2502       \u2502   \u2514\u2500\u2500 uninstall.sh\n\u2502       \u2514\u2500\u2500 seeds\n\u2502           \u251c\u2500\u2500 inputs.conf\n\u2502           \u251c\u2500\u2500 outputs.conf\n\u2502           \u251c\u2500\u2500 splunk-launch.conf\n\u2502           \u2514\u2500\u2500 user.conf\n\u2514\u2500\u2500 server.py\n\nThe project is a simple \u201cHello, world!\u201d application using Flask. Routes must be configured in the .platform/routes.yaml:\n# .platform/routes.yaml\n\nhttps://{default}/:\n  type: upstream\n  upstream: \"app:http\"\n\nas well as its services in .platform/services.yaml, which is defined here with a single MySQL/MariaDB service:\n# .platform/services.yaml\n\nmysql:\n  type: \"mysql:10.2\"\n  disk: 1024\n\n2. Set up the Platform.sh Application configuration\nModify .platform.app.yaml to define writable mounts for the Splunk Universal Forwarder:\n# .platform.app.yaml\n\nmounts:\n    'splunk':\n        source: local\n        source_path: splunk\n    '/.splunk':\n        source: local\n        source_path: splauths\n\nMounts are utilized in this configuration because after the Splunk Universal Forwarder is installed, Splunk will still attempt to write files to the project so that logs can be forwarded to the indexer. Since Platform.sh is designed to provide a read-only file system, mounts can be used for this purpose.\nSplunk writes modified log files and authorization files when a connection is made to an indexer, and those files will be written in the directories splunk and .splunk respectively.\nModify the build hook:\n# .platform.app.yaml\n\nhooks:\n    build: |\n        if [ ! -z $SPLUNK_CONFIG ]; then\n            ./config/splunk/scripts/install.sh\n        fi\n        pipenv install --system --deploy\n\nThis section runs an install script (defined below) that installs the Forwarder if it does not detect a project variable that we will define after the installation has completed.\nModify the deploy hook:\n    deploy: |\n        if [ ! \"$(ls -A splunk)\" ]; then\n             ./config/splunk/scripts/config.sh\n        fi\n        ./splunk/splunkforwarder/bin/splunk restart\n\nThe deploy hook checks to see if the splunk directory is empty, and runs a configuration script on the Forwarder if it is. The final command actually restarts the Forwarder on every deploy and is used to ship the logs to the Indexer.\n3. Installing the Splunk Universal Forwarder\nIn config/splunk/scripts/ modify a script install.sh:\n# config/splunk/scripts/install.sh\n\n#!/usr/bin/env bash\n\nTEMP_SPLUNK_HOME=config/splunk/build\n\n# Install Splunk Universal Forwarder\n[ ! -d $TEMP_SPLUNK_HOME ] &amp;&amp; mkdir -p $TEMP_SPLUNK_HOME\ncd $TEMP_SPLUNK_HOME\nwget -O splunkforwarder-7.2.5.1-962d9a8e1586-Linux-x86_64.tgz 'https://www.splunk.com/bin/splunk/DownloadActivityServlet?architecture=x86_64&amp;platform=linux&amp;version=7.2.5.1&amp;product=universalforwarder&amp;filename=splunkforwarder-7.2.5.1-962d9a8e1586-Linux-x86_64.tgz&amp;wget=true'\ntar xvzf splunkforwarder-7.2.5.1-962d9a8e1586-Linux-x86_64.tgz\nrm splunkforwarder-7.2.5.1-962d9a8e1586-Linux-x86_64.tgz\n\nThe script will define a temporary location within the config/splunk subdirectory to install the Splunk forwarder. During the build phase mounts are not yet available, so this becomes a necessary step before the mounts are fully defined.\nMake sure to replace the installation link with the most recent version listed on Splunk\u2019s Download page.\n4. Configuring the Splunk Universal Forwarder\nWrite a config.sh script within config/splunk/scripts that will be used to control the initial configuration:\n# config/splunk/scripts/config.sh\n\n#!/usr/bin/env bash\n\ncd $PLATFORM_APP_DIR\n\nTEMP_SPLUNK_HOME=config/splunk/build/*\nSPLUNK_HOME=$PLATFORM_APP_DIR/splunk/splunkforwarder\n\n# Copy temp build to writable storage\ncp -v -r $TEMP_SPLUNK_HOME splunk\n\n# Migrate used-seed.conf to the forwarder\ncp -v config/splunk/seeds/user.conf $SPLUNK_HOME/etc/system/local/user-seed.conf\n\n# Start Splunk for the first time, accepting license\n./splunk/splunkforwarder/bin/splunk start --accept-license\n\n# Update outputs.conf with receiver address seed\ncp -v $PLATFORM_APP_DIR/config/splunk/seeds/outputs.conf $PLATFORM_APP_DIR/splunk/splunkforwarder/etc/system/local/outputs.conf\n\n# Update inputs.conf with monitor inputs seed\ncp -v $PLATFORM_APP_DIR/config/splunk/seeds/inputs.conf $PLATFORM_APP_DIR/splunk/splunkforwarder/etc/system/local/inputs.conf\n\nThis script is run in the deploy hook when the mounts defined in .platform.app.yaml are now available, so the forwarder can be moved from the temporary installation directory config/splunk/build/ to app/splunk.\nAfter that, the installation is set-up with a collection of configuration seed files located in config/splunk/seeds that are also moved to the mounted installation.\nThe first user.conf is a user seed that sets up an admin user for the forwarder. There is already one set up upon install, but unless another admin password is set up, the CLI will not be accessible remotely.\n# config/splunk/seeds/user.conf\n\n[user_info]\nUSERNAME = admin\nPASSWORD = testpass\n\nOnce the user seed is moved to the final mounted installation location, the admin credentials can be passed to the Splunk CLI to accept its license and start it for the first time.\nNext, an outputs.conf seeds the outputs configuration for the forwarder, which identifies the IP address and listening port for the receiver.\n# config/splunk/seeds/outputs.conf\n\n[tcpout]\ndefaultGroup=default\n\n[tcpout:default]\nserver=&lt;receiver ip&gt;:9997\n\n[tcpout-server://&lt;receiver ip&gt;:9997]\n\nThen an inputs.conf seeds the inputs for the forwarder. In this case, the entire var/logs Platform.sh log directory is added to the forwarder\u2019s list of inputs.\n# config/splunk/seeds/inputs.conf\n\n[monitor://var/log/]\ndisabled = false\n\nLike the admin user seed, outputs.conf and inputs.conf are moved to the final installation directory splunk.\n5. Push to Platform.sh\n\nCommit the changes and push to the Platform.sh remote:\n$ git push platform &lt;environment name&gt;\n\nThe Forwarder will be installed during the build hook and configured to the indexer during the deploy hook. At the end of the deploy hook the Splunk forwarder will be restarted during each deployment. Each time it is restarted, it will detect changes to the log files within /var/log and ship those differences to the indexer.\n6. Final Configuration\nThe installation is finished, and now that the application has successfully deployed and the indexer is listening on the configured port, logs will be sent there on every deployment.\nTo ensure that the forwarder installation in the build hook does not run on every build, add a project environment variable to the project that will be visible during the build process that will keep this from happening.\n$ platform variable:create --level project --name SPLUNK_CONFIG --value 'true'\n\nThis step can be automated by installing the Platform.sh CLI into the web container itself, although it will force a redeploy of the application when the variable is added.\nSSH into the environment to modify the admin credentials or add new users using the Splunk CLI.\nConclusion\nPlatform.sh is set up to provide a read-only file system for application containers so that consistent builds and deployments are ensured. Utilizing writable mounts however provides a simple way of setting up a Splunk Universal Forwarder to ship Platform.sh logs with an Indexer.\n\nNote: if at any time you would like to remove Splunk from your application configuration, make sure to manually remove the associated files from each mount. Simply removing the mount will not eradicate the files on it and they will exist on disk until manually removed. Remember to remove the project variable created as well if keeping the build hook described above.\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    How can I forward my logs to Splunk or Logz.io?\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to forward Platform.sh logs to Logz.io", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-forward-platform-sh-logs-to-logz-io/197", "documentId": "823cb4f7d9499159d6d87305b6dd85b657d554c0", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to forward Platform.sh logs to Logz.io\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            logs\n          \n        \n        \n          \n            logzio\n          \n        \n        \n          \n            mounts\n          \n        \n        \n          \n            pycon2019\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              April 30, 2019,  8:04pm\n            \n        #1\n        \n      \n      \n        Goal\nTo forward Platform.sh logs to Logz.io.\nAssumptions\n\nAn active Platform.sh\n\n\nPlatform.sh CLI tool installed locally\n\nSSH key configured with the project account\nAn active Logz.io account\n\nProblems\nForwarding Platform.sh to a third-party indexer such as Logz.io is useful, especially when integrating log monitoring across other projects, including those that are not hosted on Platform.sh. Logz.io uses Filebeat to create configuration, auth and forwarding files when shipping logs, which must be taken into account on Platform.sh\u2019s read-only file system.\nLogz.io recommends using Filebeat to forward logs to it, however there are a number of other options outlined in the \u201cLog Forwarding\u201d section on the Logz.io dashboard.\nThe following How-to is written to ship logs from a Python application, but the steps do not require that.\nMore information regarding accessing Platform.sh logs can be found in the public documentation.\nSteps\n1. Configure routes and services\nThe project locally will ultimately have the following structure:\n\u251c\u2500\u2500 .platform\n\u2502   \u251c\u2500\u2500 local\n\u2502   \u2502   \u251c\u2500\u2500 .gitignore\n\u2502   \u2502   \u251c\u2500\u2500 README.txt\n\u2502   \u2502   \u2514\u2500\u2500 project.yaml\n\u2502   \u251c\u2500\u2500 routes.yaml\n\u2502   \u2514\u2500\u2500 services.yaml\n\u251c\u2500\u2500 .platform.app.yaml\n\u251c\u2500\u2500 Pipfile\n\u251c\u2500\u2500 Pipfile.lock\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 config\n\u2502   \u2514\u2500\u2500 filebeat\n\u2502       \u2514\u2500\u2500 scripts\n\u2502           \u251c\u2500\u2500 config.sh\n\u2502           \u2514\u2500\u2500 install.sh\n\u251c\u2500\u2500 filebeat.yml\n\u2514\u2500\u2500 server.py\n\nThe project is a simple \u201cHello, world!\u201d application using Flask. Routes must be configured in the .platform/routes.yaml:\n# .platform/routes.yaml\n\nhttps://{default}/:\n  type: upstream\n  upstream: \"app:http\"\n\nas well as its services in .platform/services.yaml, which is defined here with a single MySQL/MariaDB service:\n# .platform/services.yaml\n\nmysql:\n  type: \"mysql:10.2\"\n  disk: 1024\n\n2. Set up the Platform.sh Application configuration\nModify .platform.app.yaml to define writable mounts for Filebeat:\n# .platform.app.yaml\n\nmounts:\n    '/.filebeat':\n        source: local\n        source_path: filebeat\n\nMounts are utilized in this configuration because after Filebeat is installed, it will attempt to write files to the project so that logs can be forwarded to Logz.io. Since Platform.sh is designed to provide a read-only file system, mounts can be used for this purpose.\nModify the build hook:\n# .platform.app.yaml\n\nhooks:\n    build: |\n        if [ ! -z $LOGZ_CONFIG ]; then\n          ./config/filebeat/scripts/install.sh\n        fi\n        pipenv install --system --deploy\n\nThis section runs an install script (defined below) that installs Filebeat if it does not detect a project variable that we will define after the installation has completed.\nModify the deploy hook:\n    deploy: |\n        if [ ! \"$(ls -A filebeat)\" ]; then\n             ./config/filebeat/scripts/config.sh\n        fi\n        ./filebeat/filebeat run --once\n\nThe deploy hook runs a configuration script on the installation if the filebeat directory is empty.\nThe final command runs Filebeat until the logs are up to date with those previously shipped and then forwards them to Logz.io on every deployment.\n3. Install Filebeat\nIn config/filebeat/scripts/ modify a script install.sh:\n# config/filebeat/scripts/install.sh\n\n#!/usr/bin/env bash\n\nTEMP_SPLUNK_HOME=config/splunk/build\n\n# Install Splunk Universal Forwarder\n#!/usr/bin/env bash\n\nTEMP_BEAT_HOME=config/filebeat/build\n\n[ ! -d $TEMP_BEAT_HOME ] &amp;&amp; mkdir -p $TEMP_BEAT_HOME\ncd $TEMP_BEAT_HOME\n\n# Install Filebeat\ncurl -L -O https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-6.7.0-linux-x86_64.tar.gz\ntar xzvf filebeat-6.7.0-linux-x86_64.tar.gz\nrm filebeat-6.7.0-linux-x86_64.tar.gz\n\n# Download the certificate\nwget https://raw.githubusercontent.com/logzio/public-certificates/master/COMODORSADomainValidationSecureServerCA.crt\n\nmkdir -p filebeat-6.7.0-linux-x86_64/pki/tls/certs\ncp COMODORSADomainValidationSecureServerCA.crt filebeat-6.7.0-linux-x86_64/pki/tls/certs/\n\nThe script will define a temporary location within the config/filebeat subdirectory to install Filebeat. During the build phase mounts are not yet available, so this becomes a necessary step before the mounts are fully defined.\nThe initial configuration requires that a certificate is downloaded along with the installation and placed in the appropriate directory. Details regarding this step are available on the Filebeat steps of the Log Forwarding section of the dashboard.\nMake sure to replace the installation link with the most recent version listed on the Filebeat downloads page.\n4. Move installation to mount point\nWrite a config.sh script within config/filebeat/scripts that will be used to control the initial configuration:\n# config/filebeat/scripts/config.sh\n\n#!/usr/bin/env bash\n\n# Move filebeat to mount with write access\ncd $PLATFORM_HOME\ncp -v -r config/filebeat/build/filebeat-6.7.0-linux-x86_64/* filebeat\nmkdir filebeat/registry\n\nThis script is run in the deploy hook when the mounts defined in .platform.app.yaml are now available, so Filebeat can be moved from the temporary installation directory config/filebeat/build/ to app/filebeat.\n5. Finish the configuration\nThe main configuration file for Filebeat is filebeat.yml, which should be placed in the application directory outside of filebeat.\nOn Logz.io within the configuration steps for Filebeat, the Wizard will construct this file based on the desired inputs that are given in its fields. An example for forwarding all file in /var/log that end with .log\n# filebeat.yml\n############################# Filebeat #####################################\n\nfilebeat.inputs:\n\n- type: log\n  paths:\n    - /var/log/*.log\n  fields:\n    logzio_codec: plain\n    token: &lt;generated token&gt;\n    type: Platform.sh\n  fields_under_root: true\n  encoding: utf-8\n  ignore_older: 3h\n\nregistry_file: /filebeat/registry\n\n############################# Output ##########################################\n\noutput:\n  logstash:\n    hosts: [\"listener.logz.io:5015\"]\n    ssl:\n      certificate_authorities: [\"/app/filebeat/pki/tls/certs/COMODORSADomainValidationSecureServerCA.crt\"]\n\nfilebeat.yml configures both the forwarder\u2019s inputs and its output location using Logstash to Logz.io.\n6. Push to Platform.sh\n\nCommit the changes and push to the Platform.sh remote:\n$ git push platform &lt;environment name&gt;\n\nFilebeat will be installed during the build hook and configured to Logz.io during the deploy hook.\nEach time Filebeat is run at the end of each deployment, it will detect changes to the log files within /var/log and ship those differences to Logz.io.\n7. Define a project variable\nTo ensure that the installation in the build hook does not run on every build, add a project environment variable to the project that will be visible during the build process that will keep this from happening.\n$ platform variable:create --level project --name LOGZ_CONFIG --value 'true'\n\nThis step can be automated by installing the Platform.sh CLI into the web container itself, although it will force a redeploy of the application when the variable is added.\nConclusion\nPlatform.sh is set up to provide a read-only file system for application containers so that consistent builds and deployments are ensured. Utilizing writable mounts however provides a simple way of setting up Filebeat to ship Platform.sh logs to Logz.io.\n\nNote: if at any time you would like to remove Splunk from your application configuration, make sure to manually remove the associated files from each mount. Simply removing the mount will not eradicate the files on it and they will exist on disk until manually removed. Remember to remove the project variable created as well if keeping the build hook described above.\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    How can I forward my logs to Splunk or Logz.io?\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to derive metrics from access log via ngxtop", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-derive-metrics-from-access-log-via-ngxtop/122", "documentId": "00b4edfb4fada98902acd7c33bf6e2d392643f79", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to derive metrics from access log via ngxtop\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            pip\n          \n        \n        \n          \n            blacklist\n          \n        \n        \n          \n            analytics\n          \n        \n        \n          \n            nginx\n          \n        \n        \n          \n            logs\n          \n        \n        \n          \n            pycon2019\n          \n        \n    \n\n\n\n\n  \n      \n        \n          mrkschan\n          \n        \n\n        \n            \n            \n              April 30, 2019,  8:12pm\n            \n        #1\n        \n      \n      \n        Goal\nTo derive various metrics from the Nginx access log via ngxtop.\nAssumptions\nTo complete this, you will need:\n\nThe Platform.sh CLI tool installed\nThe Python pip tool installed\n\nProblems\nSometimes, you may find the need to derive metrics from the access log files and identify bad traffic. Using raw Linux commands to perform the analysis may not be efficient enough.\nSteps\n1. Check ngxtop installation\nMake sure ngxtop is installed locally via the below command:\npip install --user ngxtop\n\n2. Get web traffic overview\nTo gather an overview of recent web traffic, use below command:\nplatform log access -p &lt;project id&gt; -e master --lines 102400 | ngxtop --no-follow\n\n&lt; skipped &gt;\n\nSummary:\n|   count |   avg_bytes_sent |   2xx |   3xx |   4xx |   5xx |\n|---------+------------------+-------+-------+-------+-------|\n|   41553 |         6342.284 | 27380 |  6474 |   100 |  7599 |\n\nDetailed:\n| request_path                                  |   count |   avg_bytes_sent |   2xx |   3xx |   4xx |   5xx |\n|-----------------------------------------------+---------+------------------+-------+-------+-------+-------|\n| /scripts/user-widget/dist/user-widget.min.js  |    1190 |        29123.529 |   962 |   228 |     0 |     0 |\n| /gitbook/gitbook-plugin-codetabs/codetabs.js  |    1185 |          186.957 |   961 |   224 |     0 |     0 |\n| /gitbook/style.css                            |    1185 |         8088.093 |   964 |   221 |     0 |     0 |\n| /gitbook/gitbook-plugin-edit-link/plugin.js   |    1184 |          340.759 |   961 |   223 |     0 |     0 |\n| /gitbook/gitbook-plugin-gtm/plugin.js         |    1184 |          199.188 |   960 |   224 |     0 |     0 |\n| /gitbook/gitbook-plugin-atoc/atoc.js          |    1183 |          323.057 |   961 |   222 |     0 |     0 |\n| /gitbook/gitbook-plugin-highlight/website.css |    1181 |         2065.165 |   961 |   220 |     0 |     0 |\n| /gitbook/gitbook-plugin-reveal/reveal.js      |    1181 |          229.190 |   958 |   223 |     0 |     0 |\n| /gitbook/gitbook.js                           |    1181 |        23890.862 |   959 |   222 |     0 |     0 |\n| /gitbook/theme.js                             |    1179 |        25528.468 |   957 |   222 |     0 |     0 |\n\n3. View top visitors\nIt is also possible to find the top visitor IP address and HTTP User Agent:\n$&gt; platform log access -p &lt;project id&gt; -e master --lines 102400 | ngxtop --no-follow top remote_addr http_user_agent\n\n&lt; skipped &gt;\n\ntop remote_addr\n| remote_addr    |   count |\n|----------------+---------|\n| 92.60.188.221  |    6675 |\n| 179.33.202.58  |     586 |\n| 94.143.189.241 |     547 |\n| 81.200.189.9   |     461 |\n| 35.193.89.58   |     444 |\n| 82.255.18.24   |     313 |\n| 78.246.179.170 |     305 |\n| 151.16.42.51   |     302 |\n| 89.188.6.127   |     292 |\n| 84.43.189.112  |     285 |\n\ntop http_user_agent\n| http_user_agent                                                                                                           |   count |\n|---------------------------------------------------------------------------------------------------------------------------+---------|\n| Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.21 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.21               |    6623 |\n| Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36 |    4195 |\n| Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36       |    3563 |\n| Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36                 |    2242 |\n| Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:65.0) Gecko/20100101 Firefox/65.0                                              |    1799 |\n| Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36 |    1358 |\n| Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:65.0) Gecko/20100101 Firefox/65.0                                        |    1189 |\n| Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36 |    1136 |\n| Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:65.0) Gecko/20100101 Firefox/65.0                                            |    1012 |\n| Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.119 Safari/537.36 |     973 |\n\n4. Filter by IP address\nWe could further filter the visits coming from IP address 92.60.188.221:\n$&gt; platform log access -p &lt;project id&gt; -e master --lines 102400 | ngxtop --no-follow -i 'remote_addr == \"92.60.188.221\"' top request status http_user_agent\n\n&lt; skipped &gt;\n\ntop request\n| request                                          |   count |\n|--------------------------------------------------+---------|\n| GET /development/ HTTP/1.1                       |       6 |\n| POST //index.php/api/xmlrpc HTTP/1.1             |       5 |\n| POST //xmlrpc HTTP/1.1                           |       5 |\n| POST //xmlrpc.php HTTP/1.1                       |       5 |\n| POST /gitbook/gitbook-plugin-edit-link/ HTTP/1.1 |       5 |\n| POST /gitbook/gitbook-plugin-gtm/ HTTP/1.1       |       5 |\n| GET /development/logs.html HTTP/1.1              |       4 |\n| GET /gettingstarted/tools.html HTTP/1.1          |       4 |\n| GET /styles/styles.css HTTP/1.1                  |       4 |\n| POST //soap.php HTTP/1.1                         |       4 |\n\ntop status\n|   status |   count |\n|----------+---------|\n|      502 |    6338 |\n|      200 |     223 |\n|      403 |      69 |\n|      304 |      25 |\n|      405 |      20 |\n\ntop http_user_agent\n| http_user_agent                                                                                             |   count |\n|-------------------------------------------------------------------------------------------------------------+---------|\n| Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.21 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.21 |    6623 |\n| Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0                                |      51 |\n| Googlebot/2.1 (+http://www.googlebot.com/bot.html)                                                          |       1 |\n\nFrom the above output, 92.60.188.221 is generating a lot of bad traffic and should be blacklisted.\nConclusion\nWith the help of ngxtop and Platform CLI, it is easy to perform simple analysis on the Nginx access log and identify bad traffic.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to interactively debug Python applications on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-interactively-debug-python-applications-on-platform-sh/170", "documentId": "cb394d3128d30a2343dde986e3d9d69c3976bc2f", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to interactively debug Python applications on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            debugging\n          \n        \n        \n          \n            python\n          \n        \n        \n          \n            pycon2019\n          \n        \n        \n          \n            ssh\n          \n        \n    \n\n\n\n\n  \n      \n        \n          danmilon\n          \n        \n\n        \n            \n            \n              April 30, 2019,  8:12pm\n            \n        #1\n        \n      \n      \n        Goal\nInteractively debug python applications running on Platform.sh.\nAssumptions\n\nAn active Python application running on Platform.sh\n\nA configured SSH key on the project account\nFamiliarity with the Python debugger (pdb)\n\nOptional: a Platform.sh Django template application\n\n\nProblems\nEffectively debugging web applications isn\u2019t trivial, especially when an HTTP request goes through multiple layers until it reaches the web app, which is usually the case in cloud platforms.\nDebugging in a local environment is easier, but the bug might only trigger when interacting with data present on production.\n\nNote: The debugging procedure should only be performed on a non-production environment. So, if necessary clone the production environment, with the data too if need be, depending on the preconditions that trigger the bug you\u2019re investigating.\n\nThe existence of bugs is sometimes manifested by an unhandled exception being raised and bubbling up to the top of your application, or in other cases, there are no exceptions, but the actions that a request handler is supposed to perform do not occur the way you\u2019d expect.\nLet\u2019s explore the different set of debugging tools we can use and learn when to use what.\nSteps (dropping in a REPL shell)\nSometimes identifying a bug is possible by just looking at the stack trace of the exception or getting the values of some variables at some stack in the backtrace.\nThis is exactly what the DebuggedApplication WSGI wrapper from the werkzeug library does. To use it:\n1.  Add the new werkzeug dependency.\n$ pipenv install werkzeug    \n\n2. Wrap and expose the WSGI application\nAdd the script wsgi-debug.py to the project directory. It wraps our WSGI application with DebuggedApplication and exposes it.\nimport werkzeug.debug\n        \n# For the template, it is assumed wsgi.py is in project/myapp/,     \n# edit to match your project accordingly.\n    \nimport myapp.wsgi\n    \napplication = werkzeug.debug.DebuggedApplication(\n    myapp.wsgi.application,\n    evalex=True,    \n)    \n\n3. Setup the debug script\nAdd the script gunicorn-debug.sh that stops the \u201capp\u201d service in the environment and spawns a new gunicorn instance that\u2019s pointed to the wrapped WSGI application.\n#!/usr/bin/env sh\net -ex\n                   \n# Stop the application.       \nsv stop app\n                   \n# When this script exits, start it again.       \ntrap \"exit 0\" INT       \ntrap \"sv start app\" EXIT\n                   \n# Run a gunicorn and point it towards the wrapped WSGI application.       \n# It's important to run in sync mode, and a single worker, because werkzeug       \n# DebuggedApplication doesn't like forking.       \n# Set a high enough timeout that gives us time to debug.       \ngunicorn \\\n    --worker-class sync \\\n    --workers 1 \\\n    --timeout 3600 \\\n    --bind unix:$SOCKET \\\n    wsgi-debug:application\n\nAnd make it executable.\n$ chmod +x gunicorn-debug      \n\n4. Allow exceptions to propagate\nTell Django to let exceptions bubble up, by setting these in your myapp/settings.py file.\nDEBUG = False      \nDEBUG_PROPAGATE_EXCEPTIONS = True      \n\n5.  Commit and push these changes.\n6. Run the script\nAfter the deployment succeeds, ssh into the environment and run the gunicorn-debug script.\n$ ./gunicorn-debug    \n\nNow issue the request that makes it raise the unhandled exception, and lo and behold, a beautiful debugging interface appears.\nThe stack trace of the exception can be seen when a line of code is hovered over, and a \u201cshell\u201d button appears at the right that will spawn a Python shell at that line where variables (or anything else can be run, for that matter) can be printed.\n\nNote: A PIN code is required to enable the shell, which is printed in the console of the gunicorn-debug script. This is for security reasons, to prevent unauthorized access in case it is accidentally enabled on production.\n\nSteps (Debug the application code step by step with pdb.)\nThe previous approach will help to understand why an exception is raised so that it can be fixed, but if the bug occurs at an intermediate stage before the exception is raised, this will not be enough. The werkzeug debugging interface only captures the latest state of the app and the values of each variable (i.e., it cannot go back in time).\nTo gain extra insight into what code path is entered when the request is handled, a pdb trace point can be set at some point in the code, and then interactively execute it line by line and inspect variables as you go. See the pdb official documentation for more information.\n1. Add a pdb trace\nWhile still running the application with our gunicorn-debug script, add a pdb trace (import pdb; pdb.set_trace()) at some point in the code, which can even be inside a conditional.\nFor example, to test this methodology, the following can be included in a Django application\u2019s views.py:\nif request.GET.get('pdb', False) == '1':\n        import pdb; pdb.set_trace()\n\n2. Use the PDB shell\nIssue a request that makes it reach the pdb.set_trace() and then code execution will pause and the PDB shell will appear in the terminal where the gunicorn-debug script is running.\nFrom there, pdb commands can be issued, for example, to execute code line by line, to print variables, or run any arbitrary code desired.\nConclusion\nDebugging complex bugs that are only reproduced with the data that are present on production is non trivial, but thanks to development environments data cloning capabilities, and the dynamic nature of Python, we have great tools at our disposal to properly investigate these kind of bugs.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to access RabbitMQ credentials on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-access-rabbitmq-credentials-on-platform-sh/151", "documentId": "d787d2b786dc542a30e9af9156ae4240c6d32937", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to access RabbitMQ credentials on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            config-reader-python\n          \n        \n        \n          \n            rabbitmq\n          \n        \n        \n          \n            message-queue\n          \n        \n        \n          \n            credentials\n          \n        \n        \n          \n            python\n          \n        \n        \n          \n            pycon2019\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              April 30, 2019,  8:13pm\n            \n        #1\n        \n      \n      \n        Goal:\nAccess credentials for RabbitMQ from within a Platform.sh application using Python.\nAssumptions:\n\nan active Platform.sh project\nproperly configured .platform/services.yaml for the given service\n\nSSH key configured on account if developing locally\nRabbitMQ installed if developing locally\nproperly configured RabbitMQ relationship like so, in .platform.app.yaml:\n\nrelationships:\n    rabbitmq: 'rabbitmq:rabbitmq'\n\nIf developing locally, remember to first open a tunnel to the project environment using the Platform CLI.\n$ platform tunnel:open &amp;&amp; export PLATFORM_RELATIONSHIPS=\"$(platform tunnel:info --encode)\"\n\nThis will open an SSH tunnel to your current Platform.sh environment and expose a local environment variable that mimics the relationships array on Platform.sh. Check the Platform.sh documentation and How to develop locally on Platform.sh with a tethered connection for more information.\nProblems\nPlatform.sh service credentials are made available to applications as the PLATFORM_RELATIONSHIPS environment variable, which is a base64-encoded JSON string that has to be decoded before it can be used.\nThere are two primary options for accessing service credentials on Platform.sh that can be used within an application:\n\nUsing the Platform.sh Config Reader library\n\nAccessing environment variables manually\n\nSteps (Config Reader)\n1. Install the library\nInstall the configuration library. See the documentation for minimum requirements.\n$ pip install platformshconfig\n\n2. Create a Config object\nCreating a Config object provides access to the Platform.sh environment.\nfrom platformshconfig import Config\n\nconfig = Config()\n\n3. Read the credentials\n# Get the credentials to connect to the RabbitMQ service.\ncredentials = config.credentials('rabbitmq')\n\nSteps (Manual)\n1. Load the environment variable\nimport os, json, base64\n\nrelationships = json.loads(base64.b64decode(os.environ[\"PLATFORM_RELATIONSHIPS\"]))\n\n2. Read the credentials\ncredentials = relationships['rabbitmq']\n\nUse\nIn most cases, you will need only the host and port properties to connect to RabbitMQ.  Pass those to your RabbitMQ library\u2019s setup routine in your application.  Most of the time the other values may be ignored.\nIn either case, credentials is now a dictionary matching the relationship JSON object.\n{\n  \"username\": \"guest\",\n  \"scheme\": \"amqp\",\n  \"service\": \"rabbitmq\",\n  \"ip\": \"169.254.107.244\",\n  \"hostname\": \"qmx5lbdjoolco7dqjr7cx26r7q.rabbitmq.service._.eu-3.platformsh.site\",\n  \"cluster\": \"rjify4yjcwxaa-master-7rqtwti\",\n  \"host\": \"rabbitmq.internal\",\n  \"rel\": \"rabbitmq\",\n  \"password\": \"guest\",\n  \"type\": \"rabbitmq:3.5\",\n  \"port\": 5672\n}\n\nConclusions\nUsing either the language-specific Platform.sh Configuration library or direct access methods for environment variables, an application can get RabbitMQ credentials in Python.\nPlatform.sh supports configuration libraries for multiple languages. The Python configuration library can be useful for inspecting the project environment:\n# Checks whether the code is running in a build environment\nconfig.inBuild()\n# Checks whether the code is running in a runtime environment\nconfig.inRuntime()\n\nand for reading environment variables as attributes of config:\n# Available in Build and at Runtime\nconfig.appDir\n# Available at Runtime only\nconfig.branch\nconfig.smtpHost\n\nThe APIs for each language are written to be as consistent as possible, but seek out each library\u2019s documentation for specific differences.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to access Solr credentials on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-access-solr-credentials-on-platform-sh/153", "documentId": "8af4f7bf2c41cb3c8db0b5952eceafa15f54b043", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to access Solr credentials on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            config-reader-python\n          \n        \n        \n          \n            credentials\n          \n        \n        \n          \n            search\n          \n        \n        \n          \n            solr\n          \n        \n        \n          \n            python\n          \n        \n        \n          \n            pycon2019\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              April 30, 2019,  8:13pm\n            \n        #1\n        \n      \n      \n        Goal\nAccess credentials for Solr from within a Platform.sh application using Python.\nAssumptions\n\nan active Platform.sh project\nproperly configured .platform/services.yaml for the given service\n\nSSH key configured on account if developing locally\nSolr installed if developing locally\nproperly configured Solr relationship like so, in .platform.app.yaml:\n\nrelationships:\n    solr: 'solr:solr'\n\nIf developing locally, remember to first open a tunnel to the project environment using the Platform CLI.\n$ platform tunnel:open &amp;&amp; export PLATFORM_RELATIONSHIPS=\"$(platform tunnel:info --encode)\"\n\nThis will open an SSH tunnel to your current Platform.sh environment and expose a local environment variable that mimics the relationships array on Platform.sh. Check the Platform.sh documentation and How to develop locally on Platform.sh with a tethered connection for more information.\nProblems\nPlatform.sh service credentials are made available to applications as the PLATFORM_RELATIONSHIPS environment variable, which is a base64-encoded JSON string that has to be decoded before it can be used.\nThere are two primary options for accessing service credentials on Platform.sh that can be used within an application:\n\nUsing the Platform.sh Config Reader library\n\nAccessing environment variables manually\n\nSteps (Config Reader)\n1. Install the library\nInstall the configuration library. See the documentation for minimum requirements.\n$ pip install platformshconfig\n\n2. Create a Config object\nCreating a Config object provides access to the Platform.sh environment.\nfrom platformshconfig import Config\n\nconfig = Config()\n\n3. Read the credentials\n# Get the credentials to connect to the Solr service.\ncredentials = config.credentials('solr')\n\nSteps (Manual)\n1. Load the environment variable\nimport os, json, base64\n\nrelationships = json.loads(base64.b64decode(os.environ[\"PLATFORM_RELATIONSHIPS\"]))\n\n2. Read the credentials\ncredentials = relationships['solr']\n\nUse\nIn most cases, you will need only the host and port properties to connect to Solr. Pass those to your Solr library\u2019s setup routine in your application. Most of the time the other values may be ignored.\nIn either case, credentials is a dictionary matching the relationship JSON object.\n{\n  \"service\": \"solr\",\n  \"ip\": \"169.254.103.29\",\n  \"hostname\": \"swhnppdg3ugcd5sktkga73wjoi.solr.service._.eu-3.platformsh.site\",\n  \"cluster\": \"rjify4yjcwxaa-master-7rqtwti\",\n  \"host\": \"solr.internal\",\n  \"rel\": \"solr\",\n  \"path\": \"solr\\/collection1\",\n  \"scheme\": \"solr\",\n  \"type\": \"solr:7.6\",\n  \"port\": 8080\n}\n\nConclusions\nUsing either the language-specific Platform.sh Configuration library or direct access methods for environment variables, an application can get Solr credentials in Python.\nPlatform.sh supports configuration libraries for multiple languages. The Python configuration library can be useful for connecting to Solr without creating the full DSN string using FormattedCredentials:\n# Define formatted credentials\nformatted_url = config.formatted_credentials('solr', 'pysolr')\n\nThe APIs for each language are written to be as consistent as possible, but seek out each library\u2019s documentation for specific differences.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to access Elasticsearch credentials on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-access-elasticsearch-credentials-on-platform-sh/146", "documentId": "ecba4e71611d20a6f7be21715d819162ef962ddd", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to access Elasticsearch credentials on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            config-reader-python\n          \n        \n        \n          \n            credentials\n          \n        \n        \n          \n            search\n          \n        \n        \n          \n            elasticsearch\n          \n        \n        \n          \n            python\n          \n        \n        \n          \n            pycon2019\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              April 30, 2019,  8:13pm\n            \n        #1\n        \n      \n      \n        Goal\nAccess credentials for Elasticsearch from within a Platform.sh application using Python.\nAssumptions\n\nan active Platform.sh project\nproperly configured .platform/services.yaml for the given service\n\nSSH key configured on account if developing locally\nElasticsearch installed if developing locally\nproperly configured Elasticsearch relationship like so, in .platform.app.yaml:\n\nrelationships:\n    elasticsearch: 'elasticsearch:elasticsearch'\n\nIf developing locally, remember to first open a tunnel to the project environment using the Platform CLI.\n$ platform tunnel:open &amp;&amp; export PLATFORM_RELATIONSHIPS=\"$(platform tunnel:info --encode)\"\n\nThis will open an SSH tunnel to your current Platform.sh environment and expose a local environment variable that mimics the relationships array on Platform.sh. Check the Platform.sh documentation and How to develop locally on Platform.sh with a tethered connection for more information.\nProblems\nPlatform.sh service credentials are made available to applications as the PLATFORM_RELATIONSHIPS environment variable, which is a base64-encoded JSON string that has to be decoded before it can be used.\nThere are two primary options for accessing service credentials on Platform.sh that can be used within an application:\n\nUsing the Platform.sh Config Reader library\n\nAccessing environment variables manually\n\nSteps (Config Reader)\n1. Install the library\nInstall the Platform.sh Configuration Reader library. See the documentation for minimum requirements.\n$ pip install platformshconfig\n\n2. Create a Config object\nCreating a Config object provides access to the Platform.sh environment.\nfrom platformshconfig import Config\n\nconfig = Config()\n\n3. Read the credentials\n# Get the credentials to connect to the Elasticsearch service.\ncredentials = config.credentials('elasticsearch')\n\nIf the relationship is named something else, modify the credentials() call accordingly.\nSteps (Manual)\n1. Load and decode the environment variable\nimport os, json, base64\n\nrelationships = json.loads(base64.b64decode(os.environ[\"PLATFORM_RELATIONSHIPS\"]))\n\n2. Get the credentials\ncredentials = relationships['elasticsearch']\n\nIf the relationship is named something else, modify that line accordingly.\nUse\nIn most cases, you will need only the scheme, host, and port properties to connect to Elasticsearch.  Pass those to your Elasticsearch library\u2019s setup routine in your application.  Most of the time the other values may be ignored.\nIn either case, credentials is now a dictionary matching the relationship JSON object.\n{\n  \"username\": null,\n  \"scheme\": \"http\",\n  \"service\": \"elasticsearch\",\n  \"fragment\": null,\n  \"ip\": \"169.254.101.149\",\n  \"hostname\": \"j2dkzht3gs2yr66fb2brhoj4zu.elasticsearch.service._.eu-3.platformsh.site\",\n  \"public\": false,\n  \"cluster\": \"rjify4yjcwxaa-master-7rqtwti\",\n  \"host\": \"elasticsearch.internal\",\n  \"rel\": \"elasticsearch\",\n  \"query\": [\n    \n  ],\n  \"path\": null,\n  \"password\": null,\n  \"type\": \"elasticsearch:5.4\",\n  \"port\": 9200\n}        \n\nConclusions\nUsing either the language-specific Platform.sh Configuration library or direct access methods for environment variables, an application can get Elasticsearch credentials in Python.\nPlatform.sh supports configuration libraries for multiple languages. The Python configuration library can be useful for inspecting the project environment:\n# Checks whether the code is running in a build environment\nconfig.inBuild()\n# Checks whether the code is running in a runtime environment\nconfig.inRuntime()\n\nand for reading environment variables as attributes of config:\n# Available in Build and at Runtime\nconfig.appDir\n# Available at Runtime only\nconfig.branch\nconfig.smtpHost\n\nThe APIs for each language are written to be as consistent as possible, but seek out each library\u2019s documentation for specific differences.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to create and restore snapshots using the CLI", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-create-and-restore-snapshots-using-the-cli/100", "documentId": "e52f506a08afacd1f1f9064412e0dace6873b421", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to create and restore snapshots using the CLI\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            snapshots\n          \n        \n        \n          \n            create-snapshot\n          \n        \n        \n          \n            restore-snapshot\n          \n        \n        \n          \n            python\n          \n        \n        \n          \n            pycon2019\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              April 30, 2019,  8:13pm\n            \n        #1\n        \n      \n      \n        Goal\nRestore a Platform.sh live environment from a created snapshot.\nAssumptions\nThis guide requires:\n\nAn application running on Platform.sh\n\nA local repository with the Platform.sh project as git remote\nThe Platform.sh CLI installed locally\nAn SSH key configured on the project account\n\nadmin role granted for the project\n\nThis guide uses a Python 3 template for a Platform.sh application using Flask as well as MySQL and Redis for its services. The template runs a test on both MySQL and Redis and returns a status dictionary to the live page.\nProblems\nPlatform.sh recommends that snapshots are created of the live environment before merging, or when the storage space of services is increased. For one reason or another, it may become necessary to restore an active environment to a previous working state using snapshots. Creation and restoration of snapshots can be executed from the UI and using the CLI.\nAdditional information can be found in the public documentation\nSteps\n1. Create a snapshot\nThe master environment is functioning as desired:\n$ curl https://master-7rqtwti-&lt;project id&gt;.&lt;region&gt;.platformsh.site/ \n{\"mysql\":{\"return\":null,\"status\":\"OK\"},\"redis\":{\"return\":null,\"status\":\"OK\"}}\n\nFrom master create a snapshot using the Platform.sh CLI if one has not already been created.\n$ platform snapshot:create\nCreating a snapshot of master\nWaiting for the snapshot to complete...\nWaiting for the activity khlktlgy4r5uc (User created a backup of Master):\n    Backing up master\n    Backup name is &lt;snapshot name&gt;\n   [============================] 12 secs (complete)\nA snapshot of environment master has been created\nSnapshot name: &lt;snapshot name&gt;\n\n2. Changes were made and merged to Master\n\nIn another branch dev, some changes were made. For the Python 3 template example, the Redis test was changed from\n70     r.set(key_name, \"bar\")\n\nto\n70     r.set(key_name, \"BEAR\")\n\nwhich will result in an Exception for the failed test. It was not caught in time, and dev was merged into master.\n$ platform environment:merge\n\nNow the live site is failing:\n$ curl https://master-7rqtwti-&lt;project id&gt;.&lt;region&gt;.platformsh.site/ \n{\"mysql\":{\"return\":null,\"status\":\"OK\"},\"redis\":{\"error\":[\"Traceback (most recent call last):\\n\",\"  \nFile \\\"server.py\\\", line 30, in wrap_test\\n    result = callback(*args, **kwargs)\\n\",\"  \nFile \\\"server.py\\\", line 71, in test_redis\\n    assert value == r.get(key_name)\\n\",\"AssertionError\\n\"],\n\"status\":\"ERROR\"}}\n\n3. Retrieve Snapshot Name\nActions must take place from the branch the snapshot was taken from, and will not be available from dev.\n$ git checkout dev\nSwitched to branch 'dev'\n$ platform snapshots\nNo snapshots found\n\nList the saved snapshots to retrieve the snapshot name.\n$ git checkout master\nSwitched to branch 'master'\nYour branch is up to date with 'platform/master'.\n$ platform snapshots\nSnapshots on the project &lt;project name&gt; (&lt;project id&gt;), environment Master (master):\n+---------------------------+----------------------------+----------+----------+---------+\n| Created                   | Snapshot name              | Progress | State    | Result  |\n+---------------------------+----------------------------+----------+----------+---------+\n| 2019-03-11T15:16:16-04:00 | &lt;snapshot name&gt;            | 100%     | complete | success |\n+---------------------------+----------------------------+----------+----------+---------+\n\n4. Restore the snapshot\nThe snapshot can be restored to the original environment:\n$ platform snapshot:restore &lt;snapshot name&gt;\nAre you sure you want to restore the snapshot &lt;snapshot name&gt; from 2019-03-11T15:16:16-04:00 to environment Master (master)? [Y/n] Y\nRestoring snapshot &lt;snapshot name&gt; to Master (master)\nWaiting for the restore to complete...\nWaiting for the activity tb7sf5gd3ivfw (User restored environment master from backup &lt;snapshot name&gt;):\n    Provisioning certificates\n    Environment certificates\n    - certificate 7455422: expiring on 2019-06-09 17:53:35+00:00, covering master-7rqtwti-&lt;project id&gt;.&lt;region&gt;.platformsh.site\n      [============================] 35 secs (complete)\nThe snapshot was successfully restored\n\nIt can also be restored to another active branch. In this case, the target is the branch feature-x:\nplatform snapshot:restore --target=feature-x &lt;snapshot name&gt;\n\n5. Verify the restoration was successful\nCheck that the snapshot has been restored to the environment.\n$ curl https://master-7rqtwti-&lt;project id&gt;.&lt;region&gt;.platformsh.site/ \n{\"mysql\":{\"return\":null,\"status\":\"OK\"},\"redis\":{\"return\":null,\"status\":\"OK\"}}\n$\n$ curl https://feature-x-c2qo5ma-&lt;project id&gt;.&lt;region&gt;.platformsh.site/\n {\"mysql\":{\"return\":null,\"status\":\"OK\"},\"redis\":{\"return\":null,\"status\":\"OK\"}}\n\nConclusion\nOnce a snapshot is created, undesired changes can be reverted on an active branch using the Platform.sh CLI.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    How to migrate database changes between environments\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to develop locally on Platform.sh with a tethered connection", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-develop-locally-on-platform-sh-with-a-tethered-connection/69", "documentId": "72369a42f11d049b150e20cc8f7eb485d7a97dc4", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to develop locally on Platform.sh with a tethered connection\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            local-development\n          \n        \n        \n          \n            ssh-tunnel\n          \n        \n        \n          \n            django\n          \n        \n        \n          \n            pycon2019\n          \n        \n        \n          \n            cli\n          \n        \n        \n          \n            php\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              April 30, 2019,  8:14pm\n            \n        #1\n        \n      \n      \n        Goal\nRun a project on a local web server that connects to an application\u2019s services with an SSH tunnel.\nAssumptions\nThis guide uses the Platform.sh CLI to connect to a project\u2019s services, and assumes that it and Git are already installed. The guide also assumes that an SSH key is configured on the project account.\nProblems\nThe local machine must be configured with the appropriate PHP extensions. From a local project, an SSH tunnel is required to connect to Platform.sh services and expose those relationships in a local environment variable.\nSteps\n1. Check pcntl and posix\n\nTunneling to the project\u2019s services using the CLI requires the PHP extensions pcntl and posix. Check to make sure they are present, and install if the following output is not received:\n$ php -m | grep -E 'posix|pcntl'\npcntl\nposix\n\n2. Download local project copy\nList the projects on the account to find the project-ID:\n$ platform projects\nYour projects are: \n+--------------+------------------------------------------+-------------------------------------------------+\n| ID           | Title                                    | URL                                             |\n+--------------+------------------------------------------+-------------------------------------------------+\n| &lt;project-ID&gt; | Platform Project                         | https://eu.platform.sh//#/projects/&lt;project-ID&gt; |\n+--------------+------------------------------------------+-------------------------------------------------+\n\nDownload the project.\n$ platform get &lt;project-ID&gt;\nDirectory [repo]: repo\nEnvironment [master]: dev\nDownloading project Platform Project (&lt;project-ID&gt;)\n  Cloning into 'my-project/repo'...\n  remote: counting objects: 461, done.        \n  Receiving objects: 100% (461/461), 1.41 MiB | 249.00 KiB/s, done.\n  Resolving deltas: 100% (225/225), done.\n    \nThe project Platform Project (&lt;project-ID&gt;) was successfully downloaded to: repo\n\n3. Open an SSH tunnel to the project.\n$ platform tunnel:open\nSSH tunnel opened on port 30000 to relationship: elasticsearch\nSSH tunnel opened on port 30001 to relationship: rabbitmq\nSSH tunnel opened on port 30002 to relationship: postgresql\n\nCheck to make sure that the tunnels are visible.\n$ platform tunnel:list\n+-------+--------------+-------------+-----+---------------+\n| Port  | Project      | Environment | App | Relationship  |\n+-------+--------------+-------------+-----+---------------+\n| 30000 | &lt;project-ID&gt; | dev         | app | elasticsearch |\n| 30001 | &lt;project-ID&gt; | dev         | app | rabbitmq      |\n| 30002 | &lt;project-ID&gt; | dev         | app | postgresql    |\n+-------+--------------+-------------+-----+---------------+\n\nIf the tunnels are not visible here, check /Users/&lt;user&gt;/.platformsh/tunnels.log to see if the SSH key was configured incorrectly.\n4. Export PLATFORM_RELATIONSHIPS\n\nCreate a JSON encoded PLATFORM_RELATIONSHIPS environment variable to mimic the relationships array that will be visible to the application.\nexport PLATFORM_RELATIONSHIPS=\"$(platform tunnel:info --encode)\"\n\n5. Build\nBuild the application. If a service is required locally but missing, the CLI will prompt for its installation.\n$ cd repo\n$ platform build\n\n6. Run the application\nNow the project has been built and can be run locally. For a Django application:\n$ python manage.py runserver    \n\n7. Close the tunnel.\n$ platform tunnel:close    \nClose tunnel to relationship elasticsearch on &lt;project-ID&gt;-dev--app? [Y/n] y    \nClosed tunnel to elasticsearch on &lt;project-ID&gt;-dev--app    \nClose tunnel to relationship rabbitmq on &lt;project-ID&gt;-dev--app? [Y/n] y    \nClosed tunnel to rabbitmq on &lt;project-ID&gt;-dev--app    \nClose tunnel to relationship postgresql on &lt;project-ID&gt;-dev--app? [Y/n] y    \nClosed tunnel to postgresql on &lt;project-ID&gt;-dev--app     \n\nConclusion\nOnce PHP extensions are properly configured and SSH tunnels are opened to a Platform.sh project\u2019s services, an application can be built for local development.\nThe CLI is used here to connect to PostgreSQL, ElasticSearch and RabbitMQ, but the commands are not specific to those services or to the language used in the application.\nAdditional information regarding local development best practices can be found in the Platform.sh documentation.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    How to access MySQL/MariaDB credentials on Platform.sh\n                  \n                \n                \n                  \n                    \n                    \n                    How to access Solr credentials on Platform.sh\n                  \n                \n                \n                  \n                    \n                    \n                    How to access PostgreSQL credentials on Platform.sh\n                  \n                \n                \n                  \n                    \n                    \n                    How to access InfluxDB credentials on Platform.sh\n                  \n                \n                \n                  \n                    \n                    \n                    How to access Memcached credentials on Platform.sh\n                  \n                \n                \n                  \n                    \n                    \n                    How to access MongoDB credentials on Platform.sh\n                  \n                \n                \n                  \n                    \n                    \n                    How to access RabbitMQ credentials on Platform.sh\n                  \n                \n                \n                  \n                    \n                    \n                    How to access Elasticsearch credentials on Platform.sh\n                  \n                \n                \n                  \n                    \n                    \n                    How to access Redis credentials on Platform.sh\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How do I install Apache Tika with Solr", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-do-i-install-apache-tika-with-solr/290", "documentId": "028a5f4f32df63d9bc3bc1d93770035c621b6fd8", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How do I install Apache Tika with Solr\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            solr\n          \n        \n    \n\n\n\n\n  \n      \n        \n          matthias-van-woensel\n          \n        \n\n        \n            \n            \n              September 13, 2019,  1:50pm\n            \n        #1\n        \n      \n      \n        Goal\nInstall Apache Tika with Solr on Platform.sh\nAssumptions\n\nA Drupal 8 project on Platform.sh.\n\nSolr configured on that project.\n\nProblems\nApache Tika allows you to extract information from binary files (e.g. PDF files) and make them searchable in Solr.\nSteps\n1. Install search modules using composer\nInstall and configure search_api and search_api_solr:\ncomposer require drupal/search_api\ncomposer require drupal/search_api_solr\n\nMore information is available for setting up Solr with Drupal 8 in the public documentation.\n2. Install search attachments module\nInstall search_api_attachments using composer\ncomposer require drupal/search_api_attachments\n\nSearch API Attachments enable pointing at the tika jar file to index PDF documents.\n3. Install the Tika jar\nModify or include a build hook to download the Tika jar file to the project by editing .platform.app.yaml.\n# .platform.app.yaml\nhooks:\n    build: |\n      mkdir -p /app/srv/bin\n      cd /app/srv/bin &amp;&amp; curl -OL http://download.nextag.com/apache/tika/tika-app-1.16.jar\n\nThe build hook creates the directory /srv/bin and downloads the Tika jar executable into it. An example project is available where the full .platform.app.yaml can be found.\nConsult the documentation for more information about build and deploy hooks on Platform.sh.\n4. Configure the search API attachments\nVisit /admin/config/search/search_api_attachments in a browser and add the method, java executable, and Tika paths configuration.\nThese paths correspond to the paths entered in the  .platform.app.yaml  file for the  build  step.\nConclusion\nApache Tika is now setup with Solr on Platform.sh.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          ilimak\n          \n        \n\n        \n            \n              May 24, 2019,  3:52pm\n            \n        #2\n        \n      \n      \n        Does this installation also work for Drupal 7 and the associated apachesolr, apachesolr_file and search_api modules? I currently have solr 7.6 installed and working with content, now I want to add the search to attachments like Word and PDF files.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to configure caching for static assets", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-configure-caching-for-static-assets/187", "documentId": "2e964093fad697fe5896313c79a347437689ec52", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to configure caching for static assets\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            routes-yaml\n          \n        \n        \n          \n            cache\n          \n        \n    \n\n\n\n\n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n            \n              May 28, 2019,  3:53pm\n            \n        #1\n        \n      \n      \n        How to configure caching for static assets\nGoal\nCaching is a common and effective way to improve the performance of a website.  Both Platform.sh and your browser can cache static files with the proper cache header configuration.  This guide will explain how to configure those headers.\nAssumptions\n\nThis guide applies only to static assets.  For responses generated dynamically by the application, the application itself will need to include the appropriate cache headers in the response.\nSome static assets may be inappropriate to cache.  This guide assumes that most or all files are safe to cache.\nDepending on the use case, it may make sense to cache files for a relatively short period (minutes) or a very long period (weeks).\nThis guide applies equally to static files included with your application as well as those produced by your application or uploaded by a user.\n\nProblems\nIf a file is cached and then updated, anywhere the old file is already cached will still keep the old copy until its cache expires.  For that reason it is usually better to err on the side of shorter cache lifetimes if unsure.\nSteps\n1. Determine which files to cache\nDifferent cache settings may be set for different files, based on either their directory or precise filename.  For this example assume the following directory structure:\n/\n  .platform/\n  .platform.app.yaml\n  web/\n    index.php\n    robots.txt\n    uploads/\n    assets/\n    generated/\n    nocache/\n\nWhere the document root is web.\n\n\nuploads contains user-uploaded files that should be cached for 10 minutes.\n\nassets contains developer-provided files that may be cached for longer, such a 1 day.\n\nrobots.txt is a miscellaneous file that is safe to cache.\n\ngenerated contains application-generated files, such as CSS or JS files, that may be cached for a long period but need to change quickly when code changes.\n\nnocache contains files that change so rapidly that caching them is not useful.\n\n2. Set a default cache lifetime for all static files\nLocate the web.locations block in .platform.app.yaml for the document root.  In this example it would look something like:\nweb:\n    locations:\n        '/':\n            root: 'web'\n\nAs a sibling of root, add an expires key with a time period.  To set an expiration time of 5 minutes, use:\nweb:\n    locations:\n        '/':\n            root: 'web'\n            expires: 5m\n\nThe time period can be in \u201cs\u201d (seconds), \u201cm\u201d (minutes), \u201ch\u201d (hours), \u201cd\u201d (days), \u201cw\u201d (weeks), \u201cM\u201d (30 day months), or \u201cy\u201d (365 day years).\nThis configuration will automatically set a cache-control header for all static files to cache the file for 5 minutes.\nIf you have multiple paths mapped under web.locations, each one may have its own expires declaration.\nSee the web configuration documentation for more details.\n3. Configure directory-specific alternate cache lifetimes\nTo change the cache information (or any other configuration) for a specific sub-path within the docroot, use the rules block:\nweb:\n    locations:\n        '/':\n            root: 'web'\n            expires: 5m\n            rules:\n                '^/uploads':\n                    expires: 10m\n                '^/assets':\n                    expires: 1d\n                '^/nocache':\n                    expires: -1\n\nEach rules block is a regular expression that may match the path.  In this example:\n\nany URL that begins with /uploads will have a cache lifetime of 10 minutes\nany URL that begins with /assets will have a cache lifetime of 1 day\nany URL that begins with /nocache will explicitly have caching disabled\nand any other static files will have a cache lifetime of 5 minutes\n\nThe rules block also makes it possible to target specific files by name or pattern.\n4. Configure cache-busting URLs\nA common pattern is for certain files to have very long cache lifetimes but need to be cleared on-demand after a code deploy.  That\u2019s especially true for aggregated CSS or JS files.  The standard technique for that is to include a \u201ccache busting\u201d query on the URL as produced by the application, which since it\u2019s a different URL will not use the previously cached value.  There are two steps to configure that pattern.\nFirst, set an especially long cache lifetime for the files in question.\nweb:\n    locations:\n        '/':\n            root: 'web'\n            expires: 5m\n            rules:\n                '^/generated/*.(css|js)':\n                    expires: 2w\n\nThat configuration will set a 2 week cache lifetime for any files under the generated directory that end in .css or .js.\nSecond, when your application generates URLs to those files it needs to include a ?cache=somestring query parameter.  When the application code changes then somestring will need to change, too.  An easy way to do that is to base the string on the PLATFORM_TREE_ID environment variable, which will change if and only if the code in the application changed.\nFor example, in PHP one could do:\n$somestring = substr(getenv('PLATFORM_TREE_ID'), 0, 6);\n\nThat will produce a junk string that is the first 6 characters of the tree ID.  When new code is deployed, PLATFORM_TREE_ID will change and thus $somestring will change as well.  The application will then need to generate URLs that include that value, such as:\nhttps://www.example.com/generated/forum.css?cache=$somestring\n\n5. Enable router caching\nIn .platform/routes.yaml, ensure that caching is enabled for the appropriate route:\n\"https://{default}/\":\n    type: upstream\n    upstream: \"app:http\"\n    cache:\n        enabled: true\n        cookies: ['/^SS?ESS/']\n        default_ttl: 5m\n\n\nThe enabled statement turns on the cache, causing the router to cache any responses that have a proper cache header (both static and application-generated responses).\nThe cookies statement is an array of cookie name regular expressions that should be excluded when calculating the cache.  Generally it should be set to whatever your application\u2019s cookie name is. In this example, cookies named SESS or SSESS will be excluded from the cache.  If this setting is incorrect then any request with an active session will not be cached, even if it\u2019s safe to do so.\nThe default_ttl statement will set a cache header of 5 minutes on all static responses that do not already have one.  In the example above all static files will have a cache header already so it has no effect.\n\nSee the routing documentation for more details.\nConclusion\nAll static files will now be cached for the specified period of time in the router and in each visitor\u2019s browser cache.  Dynamic application responses that have a cache header set by the application will be cached as well.  Dynamic application responses that have no cache-header will not be cached at any level.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to sync database backups to Amazon S3", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-sync-database-backups-to-amazon-s3/293", "documentId": "c4f4d8fcf1eb25ad899099b8a9b84fd523d9d377", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to sync database backups to Amazon S3\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            db-dump\n          \n        \n        \n          \n            aws-s3\n          \n        \n        \n          \n            databases\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              June 10, 2019,  8:43pm\n            \n        #1\n        \n      \n      \n        Goal\nTo transfer regular database backups to Amazon S3.\nAssumptions\nYou will need:\n\nAn SSH key configured on your Platform.sh account\nA project with a configured database (PostgreSQL in this example)\n\nProblems\nWhile Platform.sh provides managed services that make configuring databases to application very easy, certain projects may require syncing regular backups to a specified location like Amazon S3.\nSteps\nThe following steps refer to PostgreSQL specifically, though they could be generalized to other databases. Consult each service\u2019s documentation for differences, and modify the credentials accordingly.\n1. Create sensitive environment variables for AWS credentials\nAWS access keys are located in \u201cMy Security Credentials\u201d under \u201cAccess Keys\u201d. New keys can be created there as well.\nplatform variable:create --level=project --name=AWS_ACCESS_KEY_ID --value=&lt;KEY_ID&gt; --json=false --sensitive=true --prefix=env --visible-build=true --visible-runtime=true\nplatform variable:create --level=project --name=AWS_SECRET_ACCESS_KEY --value=&lt;ACCESS_KEY&gt; --json=false --sensitive=true --prefix=env --visible-build=true --visible-runtime=true\n\n2. Create a sensitive environment variable for PostgreSQL\nSince PostgreSQL comes with a default password main, create another sensitive environment variable PGPASSWORD for the cron job\nplatform variable:create --level=project --name=PGPASSWORD --value=main --json=false --sensitive=true --prefix=env --visible-build=true --visible-runtime=true\n\n3. Create a writable mount for the dumps\nIf one has not already been created, define a mount backups in .platform.app.yaml that the dumps will be written to.\nmounts:\n    'backups':\n        source: local\n        source_path: backups\n\n4. Install AWS CLI\nModify the build hook in .platform.app.yaml to install awscli\nhooks:\n    build: |\n        ...\n        if [ ! -z \"$AWS_ACCESS_KEY_ID\" ] &amp;&amp; [ ! -z \"$AWS_SECRET_ACCESS_KEY\" ]; then\n            pip install futures\n            pip install awscli --upgrade --user 2&gt;/dev/null\n        fi\n\n5. Define a cron job\nAdd a cron to .platform.app.yaml that will dump the database and sync them to S3 every 15 minutes.\ncrons:\n    dumps_to_s3:\n        spec: '*/15 * * * *'\n        cmd: |\n            if [ \"$PLATFORM_BRANCH\" = master ]; then\n                ./cron/forward_dumps_s3.sh\n            fi\n\n6. Include a script to perform the dump and sync\nInclude cron/forward_dumps_s3.sh with the bucket and folder information for the location on S3.\n#!/usr/bin/env bash\n\nTODAY_DATE=$(date +%Y-%m-%d-%H:%M:%S)\nDUMP_FILE=${TODAY_DATE}-DUMP.sql\n\nDB_HOST=\"database.internal\"\nDB_PORT=5432\nDB_USER=\"main\"\nDUMP_LOC=\"backups\"\n\nAWS_BUCKET=&lt;your bucket name&gt;\nAWS_FOLDER=&lt;bucket folder name&gt;\n\npg_dump --host=$DB_HOST --port=$DB_PORT --username=$DB_USER --file=$DUMP_LOC/$DUMP_FILE\n\naws s3 sync ~/$DUMP_LOC s3://$AWS_BUCKET/$AWS_FOLDER/\n\n7. Verify\nLog into S3 and verify that the sync worked as planned.\n\nConclusion\nProviding AWS credentials via environment variables and installing the AWS CLI, it\u2019s easy to sync regular database backups to S3.\n\nNote: Thanks to Contextual Code for laying the groundwork for this How-to with Store Platform.sh logs on S3.\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    Transferring backups from P.sh to S3\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to modify my Platform.sh project plan and its resources", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-modify-my-platform-sh-project-plan-and-its-resources/130", "documentId": "653116f686f1385b5ee9e5de4c6cf16bcac4b39c", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to modify my Platform.sh project plan and its resources\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            change-plan\n          \n        \n        \n          \n            ui\n          \n        \n    \n\n\n\n\n  \n      \n        \n          olga-linek\n          \n        \n\n        \n            \n            \n              June 10, 2019,  9:10pm\n            \n        #1\n        \n      \n      \n        Goal\nChange a Platform.sh plan/and or modify project settings such as environments, storage, and users.\nAssumptions\n\nOwner status on the project to be changed\n\nProblems\nRequirements change and modifications to your current plan sometimes need to be implemented.\nSteps\n1. Edit a Project\nLogin to your account to view the accessible projects.\nFor the projects that you are the Account Owner for, you will see three vertical dots. Click those dots to pull up a drop-down menu and select edit to modify that project\u2019s configuration.\n\n2. Upgrade the plan size\nFrom the drop down menu, modify the Project\u2019s current plan size. Changing the plan here will make visible changes to:\n\nwhat is included within the plan\nthe cost of the plan.\n\n\nWhen finished, click the Update Plan button on the bottom of the page.\nNote:  Production-sized Platform.sh subscriptions cannot be downgraded to a Development plan due to potential feature conflicts. If looking to downgrade a plan, please file a support ticket.\n3. Modify number of environments\nTo modify the number of environments, you can click on the drop down menu and select the number of environments you wish to add.\nNote: You can increase and decrease the number of environments yourself.\n\n4. Modify storage sizing\nTo modify the storage sizing, you can click on the drop down menu and select additional storage you would like to add (in GB).\nNote: You can only increase the storage sizing here. If you wish to decrease the amount of storage used, please file a support ticket.\n\n5. Number of Users\nThis page also shows the Account Owner the number of Users for the specific project in the same way. The number of users can also be modified via the CLI.\nConclusion\nAccount owner has the power to modify their plan as well as view the costs associated with the change. For further information, please check our pricing page.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to take screenshots using Puppeteer and Headless Chrome", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-take-screenshots-using-puppeteer-and-headless-chrome/305", "documentId": "3a743b4dd8c719ab387edd2398791d8a564b8d17", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to take screenshots using Puppeteer and Headless Chrome\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            screenshots\n          \n        \n        \n          \n            chrome-headless\n          \n        \n        \n          \n            puppeteer\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              June 10, 2019,  9:18pm\n            \n        #1\n        \n      \n      \n        Goal\nTo use Puppeteer and headless Chrome to create an ExpressJS application that takes website screenshots on Platform.sh.\nAssumptions\nYou will need:\n\nAn SSH key configured on your Platform.sh account\nThe Platform.sh CLI installed locally\nNode.js and npm installed locally\n\nProblems\nUsing headless Chrome to take screenshots of a website requires properly connecting the chrome-headless service container to the Node library Puppeteer by passing its credentials using the Node.js Config Reader libary.\nSteps\nThe project will ultimately have the following structure:\n.\n\u251c\u2500\u2500 .platform\n\u2502   \u251c\u2500\u2500 routes.yaml\n\u2502   \u2514\u2500\u2500 services.yaml\n\u251c\u2500\u2500 .platform.app.yaml\n\u251c\u2500\u2500 index.js\n\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 package-lock.json\n\u2514\u2500\u2500 screenshots.js\n\n1. Initialize the project\nCreate an empty project on Platform.sh using the CLI.\n$ platform create\n\nCreate a new project directory for the application on your local machine called screenshots and cd into it. Initialize the directory as a Git repository and set its remote to the newly created Platform.sh project using the outputted project ID.\n$ git init\n$ platform project:set-remote &lt;project ID&gt;\n\n2. Create the Platform.sh configuration files\n\n\n.platform/services.yaml\nDefine the chrome-headless container using the supported version outlined in the Headless Chrome documentation.\nheadless:\n    type: chrome-headless:73\n\n\n\n.platform.app.yaml\nConfigure the application nodejs:\nname: nodejs\n\ntype: nodejs:10\n\nrelationships:\n  headless: \"headless:http\"\n\ncrons:\n  cleanup:\n    spec: '*/30 * * * *'\n    cmd: rm screenshots/*\n\nweb:\n  commands:\n    start: \"nodejs index.js\"\n\nmounts:\n  \"/screenshots\": \"shared:files/screenshots\"\n\ndisk: 512\n\nThe configuration uses nodejs 10, since it is required to use the Config Reader library with Puppeteer. It defines the mount screenshots which will be the writable directory to save the screenshots the application takes.\nIn order to prevent screenshots/ from filling up as people use it, a cron job is also defined that removes its contents every 30 minutes.\n\n\n.platform/routes.yaml\nLastly, set up a basic routes configuration file, using the name of the application nodejs\n\"https://{default}/\":\n    id: main\n    type: upstream\n    upstream: \"nodejs:http\"\n\n\"https://www.{default}/\":\n    type: redirect\n    to: \"https://{default}/\"\n\n\n\n3. Write the screenshots.js file\nCreate a file in the project directory called screenshots.js with the following contents:\nconst puppeteer = require('puppeteer');\nconst platformsh = require('platformsh-config');\n\nvar exports = module.exports = {};\n\n// Create an async function\nexports.takeScreenshot = async function (url, screenshotID) {\n\n    try {\n        // Connect to chrome-headless using pre-formatted puppeteer credentials\n        let config = platformsh.config();\n        const formattedURL = config.formattedCredentials(\"headless\", \"puppeteer\");\n        const browser = await puppeteer.connect({browserURL: formattedURL});\n\n        // Open a new page to the given url and take the screenshot\n        const page = await browser.newPage();\n        await page.goto(url);\n        await page.screenshot({\n            fullPage: true,\n            path: `screenshots/${screenshotID}.png`\n        });\n\n        await browser.close();\n\n        return browser\n\n    } catch (e) {\n        return Promise.reject(e);\n    }\n\n};\n\nIt defines an async function called takeScreenshot as a module export. The Node.js Config Reader retrieves  the library\u2019s formatted credentials for Puppeteer to create the formattedURL string.\npath defines the saved location of the screenshot, while fullPage configures Puppeteer to take a screenshot of the entire page, not just the view seen within a window. Additional parameters for page.screenshot() can be found in the Puppeteer documentation.\n4. Define index.js\n\nCreate the file index.js that defines the ExpressJS application app:\nconst fs = require('fs');\nconst uuidv4 = require('uuid/v4')\nconst platformsh = require('platformsh-config');\nconst express = require('express');\n\n// Require screenshot file and its function\nvar screenshot = require(\"./screenshots.js\");\n\n// Build the application\nvar app = express()\n\n// Define the index route\napp.get('/', (req, res) =&gt; {\n  res.writeHead(200, {\"Content-Type\": \"text/html\"});\n  res.write(`&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Headless Chrome on Platform.sh&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;h1&gt;Headless Chrome on Platform.sh&lt;/h1&gt;\n\n&lt;h2&gt;Take a screenshot of a page&lt;/h2&gt;\n\nClick submit to generate a png of the &lt;a href=\"https://platform.sh/\"&gt;Platform.sh website&lt;/a&gt;, or paste in another URL.\n\n&lt;/br&gt;&lt;/br&gt;\n\n&lt;form method=\"get\" action=\"/result\"&gt;\n    &lt;input type=\"text\" name=\"screenshotURL\" value=\"https://platform.sh/\"&gt;\n    &lt;input type=\"submit\"&gt;\n&lt;/form&gt;\n\n`);\n    res.end(`&lt;/body&gt;&lt;/html&gt;`);\n})\n\n// Define screenshot result route\napp.get('/result', async function(req, res){\n  // Create a randomly generated ID number for the current screenshot\n  var screenshotID = uuidv4();\n  // Take the screenshot\n  await screenshot.takeScreenshot(req.query['screenshotURL'], screenshotID)\n  // Define and download the file\n  const file = `screenshots/${screenshotID}.png`;\n  res.download(file);\n});\n\n// Create config object to get Platform.sh PORT credentials\nlet config = platformsh.config();\n\n// Start the server.\napp.listen(config.port, function() {\n    console.log(`Listening on port ${config.port}`)\n});\n\n\nIn addition to the home route, index.js defines a /results path that calls takeScreenshot() and passes a randomly generated ID that will become part of the name for the generated png file.\n5. Define the application\u2019s dependencies\nInclude the application\u2019s dependencies in package.json:\n{\n  \"name\": \"chrome_headless\",\n  \"version\": \"1.0.0\",\n  \"description\": \"A simple example for taking screenshots with Puppeteer and headless Chrome on Platform.sh\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"\n  },\n  \"author\": \"Chad Carlson\",\n  \"license\": \"MIT\",\n  \"dependencies\": {\n    \"platformsh-config\": \"^2.0.0\",\n    \"puppeteer\": \"^1.14.0\",\n    \"express\": \"^4.16.4\",\n    \"uuid\": \"^3.3.2\"\n  }\n}\n\nThen create the package-lock.json file by running\n$ npm install\n\n6. Push to Platform.sh\n\nCommit the changes and push master to Platform.sh\n$ git add .\n$ git commit -m \"Create screenshot application.\"\n$ git push platform master\n\n7. Verify\nUse the command platform url when the build process has completed to visit the site. Click submit to take a screenshot of the Platform.sh website, or copy in another url to test the application.\nConclusion\nUsing ExpressJS, Puppeteer, and Platform.sh headless Chrome as a service, a simple application can be made that takes screenshots of an inputted url.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to enable commandline autocomplete support for the `platform` CLI tool", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-enable-commandline-autocomplete-support-for-the-platform-cli-tool/312", "documentId": "582239327f6d536b9a90341f9b441018966cb0f7", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to enable commandline autocomplete support for the `platform` CLI tool\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            platform-cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          dman\n          \n        \n\n        \n            \n              June 13, 2019,  6:18am\n            \n        #1\n        \n      \n      \n        The platform CLI tool contains a large library of commands, and trying to list them each time you can\u2019t quite remember the names or options can fill up your screen really fast. Tab-completion will be able to help us out here.\nGoal\nWe want autocomplete support (press tab to get command and option suggestions) for the platform CLI tool.\nAssumptions\nAs it\u2019s a symfony component, these commands can be programmatically extracted in a standard way.\nThe symfony-console-autocomplete tool does this for us.\nInstructions here for OSX, the setup instructions are similar for other systems and shells\nPrerequisites\nIf you don\u2019t have bash-completion installed by default, get that first.\nUsing brew on OSX. *nix sessions probably already have it.\nbrew install bash-completion\n\nAdd the startup line to your ~/.bash_profile like it advises.\nScripts found in /usr/local/etc/bash_completion.d/ can support individual commands now.\nSteps\nInstall symfony-console-autocomplete\n\n    composer global require bamarni/symfony-console-autocomplete\n\nNow we can generate a dump of all symfony-console-based CLI commands, and use that dump to generate the autocomplete prompts.\nAuto-generate autocomplete hints for platform\n\n    symfony-autocomplete platform --script-options=list &gt; /usr/local/etc/bash_completion.d/platform\n\nRestart your shell session (or at least source ~/.bash_profile) and autocomplete should be available for platform cli now.\n\nThe location /usr/local/etc/bash_completion.d/ will differ depending on your OS, version, and preferred shell. Alternate instructions for fish, zsh etc are in the README. The only difference from the examples there is that we have to add --script-options=list to extract the commands for platform.\n\nTest\nPressing [TAB] part-way through entering platform commands will now provide either autocompletion or a list of suggestions, for both commands and options to those commands.\nExamples:\n$ platform pr[TAB]\nplatform project:    \n\n$ platform project:[TAB]\nclear-build-cache  curl               get                list               variable:delete    variable:set       \ncreate             delete             info               set-remote         variable:get\n\n$ platform project:l[TAB]\nplatform project:list\n\n$ platform project:list --[TAB]\n--columns    --help       --my         --no-header  --quiet      --reverse    --title      --version    \n--format     --host       --no         --pipe       --refresh    --sort       --verbose    --yes \n\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          pjcdawkins\n          \n        \n\n        \n            \n            \n              June 13, 2019,  5:13pm\n            \n        #2\n        \n      \n      \n        After some discussion earlier - the CLI has had built-in autocompletion support for a long time, but it\u2019s not documented and doesn\u2019t activate everywhere, specifically we found a problem with Bash 3.x (an old version present by default on Macs).\nAll that you should now need is:\n\nHave Bash or ZSH as your shell\nHave bash-completion installed, or the equivalent (ZSH usually has completion built in) - on Mac OS X with Homebrew this is brew install bash-completion\n\nInstall the CLI via the installer or, if already installed, run platform up to get version 3.42.1 and platform self:install to install\nOpen a new shell (to make sure everything is sourced that needs to be)\n\n\u2026 that should be it.\nIn other words on many systems the CLI installation process should enable all this by default.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to set up and deploy a Ruby on Rails application on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-set-up-and-deploy-a-ruby-on-rails-application-on-platform-sh/176", "documentId": "11def9a0aa0938761caf257e7a6749127b251d4b", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to set up and deploy a Ruby on Rails application on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            rails\n          \n        \n        \n          \n            gemfile\n          \n        \n        \n          \n            ruby\n          \n        \n    \n\n\n\n\n  \n      \n        \n          afotey\n          \n        \n\n        \n            \n            \n              April 5, 2019, 11:12am\n            \n        #1\n        \n      \n      \n        Goal\nThis guide shows how to deploy a toy Ruby on Rails 5 application on Platform.sh running on Sqlite (please do not use Sqlite in production, ever).\nIn a later post I\u2019ll show how to deploy a robust, production-ready Rails with Postgres and Redis.\nAssumptions\n\nAn empty Platform.sh project - more info on creating a project here\n\nAn SSH key loaded in an SSH agent and configured in the Platform.sh dashboard\n\nThe Platform.sh CLI installed\n\nSome supported version of Ruby and the Rails gem installed. You can follow this excellent guide to get both installed. Your best experience would be to use the same version of Ruby you will be running on the server (for example 2.6).\n\nSteps\n1. Create a new Rails application using the CLI\n$ rails new rails-platformsh\n$ cd rails-platformsh\n\n2. Configure the application for Platform.sh\n\nSet the platform Git remote.\n$ platform project:set-remote &lt;project id&gt;\n\nUpdate the Ruby version directive in the Gemfile not to care about patch level, because locking patch-level is evil.\n# rails-platformsh/Gemfile\n\nruby '~&gt; 2.6.0'\n\nThen update the Gemfile.lock\n$ bundle update\n\n3. Add the Platform.sh configuration files\nCreate the .platform.app.yaml application configuration file.\n$ touch .platform.app.yaml\n\nAdd a basic Rails application configuration to the file.\n# rails-platformsh/.platform.app.yaml\nname: \"ruby_example\"\ntype: \"ruby:2.6\"\ndisk: 1024\n\nhooks:\n  build: |\n    bundle install\n    rake assets:precompile\n  deploy: |\n    rails db:migrate\n\nmounts:\n  \"/log\": \"shared:files/log\"\n  \"/tmp\": \"shared:files/tmp\"\n  \"/db\": \"shared:files/db\"\n\nweb:\n  commands:\n    start: 'rails server -p $PORT'\n\nCreate the .platform/services.yaml services configuration and .platform/routes.yaml router configuration files.\n$ touch .platform/routes.yaml\n$ touch .platform/services.yaml\n\nAdd basic routes configuration:\n# rails-platformsh/.platform/routes.yaml\n\n\"https://{default}\":\n  type: upstream\n  upstream: \"ruby_example:http\"\n\nyou can leave .platform/services.yaml empty for the moment. Later if you would like a Postgres or a MySQL\u2026 this is where you will put it.\n4. Deploy the application to Platform.sh\n\nCommit everything to the repository:\ngit add --all\ngit commit -m \"Initial commit\"\n\nPush the working branch to the platform remote:\ngit push platform master\n\nConclusion\nThe Rails gem can be used in conjunction with the Platform CLI to easily create and configure a Ruby on Rails application for deployment on Platform.sh.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              June 18, 2019,  8:53pm\n            \n        #2\n        \n      \n      \n        Following these instructions, I get the following error from the bundle install command in the build hook.\n      Executing build hook...\n        W: /opt/ruby/2.6/lib/ruby/2.6.0/rubygems.rb:283:in `find_spec_for_exe': Could not find 'bundler' (2.0.2) required by your /app/Gemfile.lock. (Gem::GemNotFoundException)\n        W: To update to the latest version installed on your system, run `bundle update --bundler`.\n        W: To install the missing version, run `gem install bundler:2.0.2`\n        W:      from /opt/ruby/2.6/lib/ruby/2.6.0/rubygems.rb:302:in `activate_bin_path'\n        W:      from /opt/ruby/2.6/bin/bundle:23:in `&lt;main&gt;'\n        W: /opt/ruby/2.6/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require': cannot load such file -- rake (LoadError)\n        W:      from /opt/ruby/2.6/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n        W:      from /usr/bin/rake:25:in `&lt;main&gt;'\n      \n      E: Error building project: Step failed with status code 1.\n\n    E: Error: Unable to build application, aborting.\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to generate PDFs using Puppeteer and Headless Chrome", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-generate-pdfs-using-puppeteer-and-headless-chrome/306", "documentId": "14f6b04c9f6a9315c84bc878c640cc41977ab39e", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to generate PDFs using Puppeteer and Headless Chrome\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            chrome-headless\n          \n        \n        \n          \n            puppeteer\n          \n        \n        \n          \n            pdf\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              June 20, 2019,  1:23pm\n            \n        #1\n        \n      \n      \n        Goal\nTo use Puppeteer and headless Chrome to create an ExpressJS application that generates PDFs of web sites on Platform.sh.\nAssumptions\nYou will need:\n\nAn SSH key configured on your Platform.sh account\nThe Platform.sh CLI installed locally\nNode.js and npm installed locally\n\nProblems\nUsing headless Chrome to generate PDFs of a website requires properly connecting the chrome-headless service container to the Node library Puppeteer by passing its credentials using the Node.js Config Reader libary.\nSteps\nThe project will ultimately have the following structure:\n.\n\u251c\u2500\u2500 .platform\n\u2502   \u251c\u2500\u2500 routes.yaml\n\u2502   \u2514\u2500\u2500 services.yaml\n\u251c\u2500\u2500 .platform.app.yaml\n\u251c\u2500\u2500 index.js\n\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 package-lock.json\n\u2514\u2500\u2500 pdfs.js\n\n1. Initialize the project\nCreate an empty project on Platform.sh using the CLI.\n$ platform create\n\nCreate a new project directory for the application on your local machine called pdfs and cd into it. Initialize the directory as a Git repository and set its remote to the newly created Platform.sh project using the outputted project ID.\n$ git init\n$ platform project:set-remote &lt;project ID&gt;\n\n2. Create the Platform.sh configuration files\n\n\n.platform/services.yaml\nDefine the chrome-headless container using the supported version outlined in the Headless Chrome documentation.\nheadless:\n    type: chrome-headless:73\n\n\n\n.platform.app.yaml\nConfigure the application nodejs:\nname: nodejs\n\ntype: nodejs:10\n\nrelationships:\n  headless: \"headless:http\"\n\ncrons:\n  cleanup:\n    spec: '*/30 * * * *'\n    cmd: rm pdfs/*\n\nweb:\n  commands:\n    start: \"nodejs index.js\"\n\nmounts:\n  \"/pdfs\": \"shared:files/pdfs\"\n\ndisk: 512\n\nThe configuration uses nodejs 10, since it is required to use the Config Reader library with Puppeteer. It defines the mount pdfs that will act as a writable directory to save the PDFs the application generates.\nIn order to prevent pdfs/ from filling up as people use it, a cron job is also defined that removes its contents every 30 minutes.\n\n\n.platform/routes.yaml\nLastly, set up a basic routes configuration file, using the name of the application nodejs\n\"https://{default}/\":\n    id: main\n    type: upstream\n    upstream: \"nodejs:http\"\n\n\"https://www.{default}/\":\n    type: redirect\n    to: \"https://{default}/\"\n\n\n\n3. Write the pdfs.js file\nCreate a file in the project directory called pdfs.js with the following contents:\nconst puppeteer = require('puppeteer');\nconst platformsh = require('platformsh-config');\n\nvar exports = module.exports = {};\n\n// Create an async function\nexports.makePDF = async function (url, pdfID) {\n\n    try {\n        // Connect to chrome-headless using pre-formatted puppeteer credentials\n        let config = platformsh.config();\n        const formattedURL = config.formattedCredentials(\"headless\", \"puppeteer\");\n        const browser = await puppeteer.connect({browserURL: formattedURL});\n\n        // Open a new page to the given url and create the PDF\n        const page = await browser.newPage();\n        await page.goto(url, {waitUntil: 'networkidle2'});\n        await page.pdf({\n            path: `pdfs/${pdfID}.pdf`,\n            printBackground: true\n        });\n        await browser.close();\n\n        return browser\n\n    } catch (e) {\n\n        return Promise.reject(e);\n\n    }\n\n};\n\nIt defines an async function called makePDF as a module export. The Node.js Config Reader retrieves  the library\u2019s formatted credentials for Puppeteer to create the formattedURL string.\npath defines the saved location of the PDF, while printBackground allows background images on the page to be included in the generated PDF. Additional parameters for page.pdf() can be found in the Puppeteer documentation.\n4. Define index.js\n\nCreate the file index.js that defines the ExpressJS application app:\nconst fs = require('fs');\nconst uuidv4 = require('uuid/v4')\nconst platformsh = require('platformsh-config');\nconst express = require('express');\n\n// Require pdf file and its function\nvar pdfs = require(\"./pdfs.js\");\n\n// Build the application\nvar app = express();\n\n// Define the index route\napp.get('/', (req, res) =&gt; {\n  res.writeHead(200, {\"Content-Type\": \"text/html\"});\n  res.write(`&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Headless Chrome on Platform.sh&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;h1&gt;Headless Chrome on Platform.sh&lt;/h1&gt;\n\n&lt;h2&gt;Generate a PDF of a page&lt;/h2&gt;\n\nClick submit to generate a PDF of the &lt;a href=\"https://platform.sh/\"&gt;Platform.sh website&lt;/a&gt;, or paste in another URL.\n\n&lt;/br&gt;&lt;/br&gt;\n\n&lt;form method=\"get\" action=\"/result\"&gt;\n    &lt;input type=\"text\" name=\"pdfURL\" value=\"https://platform.sh/\"&gt;\n    &lt;input type=\"submit\"&gt;\n&lt;/form&gt;\n\n`);\n    res.end(`&lt;/body&gt;&lt;/html&gt;`);\n})\n\n// Define PDF result route\napp.get('/result', async function(req, res){\n  // Create a randomly generated ID number for the current PDF\n  var pdfID = uuidv4();\n  // Generate the PDF\n  await pdfs.makePDF(req.query['pdfURL'], pdfID)\n  // Define and download the file\n  const file = `pdfs/${pdfID}.pdf`;\n  res.download(file);\n});\n\n// Create config object to get Platform.sh PORT credentials\nlet config = platformsh.config();\n\n// Start the server.\napp.listen(config.port, function() {\n    console.log(`Listening on port ${config.port}`)\n});\n\nIn addition to the home route, index.js defines a /results path that calls makePDF() and passes a randomly generated ID that will become part of the name for the generated PDF file.\n5. Define the application\u2019s dependencies\nInclude the application\u2019s dependencies in package.json:\n{\n  \"name\": \"chrome_headless\",\n  \"version\": \"1.0.0\",\n  \"description\": \"A simple example for taking screenshots with Puppeteer and headless Chrome on Platform.sh\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"\n  },\n  \"author\": \"Chad Carlson\",\n  \"license\": \"MIT\",\n  \"dependencies\": {\n    \"platformsh-config\": \"^2.0.0\",\n    \"puppeteer\": \"^1.14.0\",\n    \"express\": \"^4.16.4\",\n    \"uuid\": \"^3.3.2\"\n  }\n}\n\nThen create the package-lock.json file by running\n$ npm install\n\n6. Push to Platform.sh\n\nCommit the changes and push master to Platform.sh\n$ git add .\n$ git commit -m \"Create PDF generator application.\"\n$ git push platform master\n\n7. Verify\nUse the command platform url when the build process has completed to visit the site. Click submit to generate a PDF of the Platform.sh website, or copy in another url to test the application.\nConclusion\nUsing ExpressJS, Puppeteer, and Platform.sh headless Chrome as a service, a simple application can be made that generates PDFs of an inputted url.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to automatically update Composer dependencies with Source Operations", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-automatically-update-composer-dependencies-with-source-operations/337", "documentId": "fe4dddcc98cb55e0b3a7d706aeb3f167cb5eaa51", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to automatically update Composer dependencies with Source Operations\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            cli\n          \n        \n        \n          \n            php\n          \n        \n    \n\n\n\n\n  \n      \n        \n          GuGuss\n          \n        \n\n        \n            \n            \n              July 23, 2019,  9:07am\n            \n        #1\n        \n      \n      \n        Goal\nThis guide details how to automatically update Composer dependencies on a specific environment, so that you can test the changes before deploying to production.\nAssumptions\nYou will need:\n\nA Composer based Platform.sh application (you can start with one of our many templates for Drupal 8, WordPress, Magento, Symfony 4, Laravel)\nAn SSH key loaded in an SSH agent and configured in the Platform.sh dashboard\n\nThe Platform.sh CLI installed\n\n\nProblems\nKeeping your code base and its dependencies up to date is critical for so many reasons, and it is always possible to forget and miss a security upgrade.\nEven though Platform.sh makes it easy to update dependencies, thanks to its support for all the famous package managers (Composer, npm, gem\u2026), it is better to automate that process, so that this issue never happens.\nThat is the goal of this how-to guide.\nSteps\n1. Install the CLI on the application container\nCreate a machine user that you invite to your project. Get an API token from this machine user account (read the documentation here) and run the following command:\ncd my-platformsh-project/\nplatform variable:create -e master --level environment --name env:PLATFORMSH_CLI_TOKEN --sensitive true --value 'your API token'\n\nYour local CLI will automatically detect the current project and add the env:PLATFORMSH_CLI_TOKEN environment variable to your project.\nThen install the CLI on your application container via a new build hook defined in .platform.app.yaml:\nhooks:\n    build: |\n        curl -sS https://platform.sh/cli/installer | php\n\n2. Enable Source Operations\nCreate a dedicated update-dependencies branch where we will automatically run and test Composer updates.\nplatform branch update-dependencies -e master\n\nOn that newly created branch, add the following lines in the .platform.app.yaml:\nsource:\n    operations:\n        update:\n            command: |\n                composer update\n                git add composer.lock\n                git commit -m \"Update Composer dependencies.\"\n\nThis configuration defines an arbitrary update source operation which will run the composer update command and commit the changes to the composer.lock file, before redeploying the environment on which it has been triggered.\n3. Automatically trigger the update source operation\nDefine a new cron entry to automatically trigger the update source operation in .platform.app.yaml:\ncrons:\n    update:\n        # Trigger the update source operation every day at 00:00.\n        spec: '0 0 * * *'\n        cmd: |\n            if [ \"$PLATFORM_BRANCH\" = update-dependencies ]; then\n                platform environment:sync code data --no-wait --yes\n                platform source-operation:run update --no-wait --yes\n            fi\n\nEvery day, this cron will synchronize the update-dependencies environment with its parent master, and trigger the update source operation on it.\n4. Deploy the changes\nUse Git to deploy the changes:\ngit add .platform.app.yaml\ngit commit -m \"Enable automated Composer updates on the update-dependencies branch via cron.\"\ngit push platform update-dependencies\n\nConclusion\nThis is how easy it is to automate the update of Composer dependencies (or any other package manager dependencies if you are not using PHP) on Platform.sh.\nThe next step should be to enable a Platform.sh notification alert (Email, Slack\u2026) so that you know when the environment has been updated and you can test the changes before deploying those to production.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          robert\n          \n            listed \n        \n\n        \n            \n              July 29, 2019,  2:30pm\n            \n        #3\n        \n      \n      \n        \n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to serve a static HTML page on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-serve-a-static-html-page-on-platform-sh/51", "documentId": "a39e9751cea4af763d4cbc548c6d0e00943c06ea", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to serve a static HTML page on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            app-yaml\n          \n        \n        \n          \n            routes-yaml\n          \n        \n        \n          \n            pycon2019\n          \n        \n    \n\n\n\n\n  \n      \n        \n          robert\n          \n        \n\n        \n            \n            \n              April 30, 2019,  8:12pm\n            \n        #1\n        \n      \n      \n        Goal\nTo serve a static HTML page on Platform.sh.\nAssumptions\nYou will need:\n\nAn empty Platform.sh project\nSSH key configured to the Platform.sh account\n\nProblems\nIn addition to your HTML file, Platform.sh needs three YAML files to configure an application in a project. These files define the routing, configure the web server, and set minimal defaults for everything else.\nSteps\n1. Set git remote to Platform.sh project\n$ git init\n$ platform project:set-remote &lt;project id&gt;\n\n2. Create your HTML file:\n./web/index.html\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;body&gt;\n    &lt;p&gt;Hello World&lt;/p&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n\n3. Define routes\n./.platform/routes.yaml\nhttps://{default}/:\n    type: upstream\n    upstream: htmlhowto:http\n\n4. Add empty services\n./.platform/services.yaml\n# empty\n\n5. Add .platform.app.yaml\n./.platform.app.yaml\n# The name of this app. Must be unique within a project.\nname: htmlhowto\n\n# Any type will work. There is no \"plain HTML\" type.\ntype: \"python:3.7\"\n\n# There is no need for a writable file mount, so set it to the smallest possible size.\ndisk: 256\n\n# Configure the web server to serve our static site.\nweb:\n    commands:\n        # Run a no-op process that uses no CPU resources, since this is a static site.\n        start: sleep infinity\n\n    locations:\n        # This tells Nginx to serve from the base directory\n        \"/\":\n            root: \"web\"\n            index:\n                - \"index.html\"\n\nThis is a stripped down application configuration for serving a static file on Platform.sh. You can find more information about additional commands that can be included in .platform.app.yaml in the Platform.sh documentation.\n6. Add, commit, and push these files to your empty Platform.sh project\ngit add .\ngit commit -m \"Adding configuration to serve a static html file\"\ngit push platform master\n\n7. Test by visiting the URL of your environment.\n\nConclusion\nBy adding a route to routes.yaml, and by adding the proper web server configuration to .platform.app.yaml, a project is able to serve static HTML files.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    How to compile CSS using SASS on Platform.sh\n                  \n                \n          \n\n  \n  \n      \n        \n          gnufred\n          \n        \n\n        \n            \n              August 2, 2019,  2:09pm\n            \n        #2\n        \n      \n      \n        Is it possible to remove the trailing shash?\nUnfortunately, it not possible. We use the following Nginx directive  try_files $uri $uri/ =404;  which is not customizable by users. As explained in the try_file documentation, if Nginx cannot match the URL path as a file it will try to match it as a directory. The path will always match the existing directory whether it ends with a slash or not.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I forward my logs to Splunk or Logz.io?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-forward-my-logs-to-splunk-or-logz-io/166/2", "documentId": "e345d3187ecd9f41d5161b909676729181029c64", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I forward my logs to Splunk or Logz.io?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            monitoring\n          \n        \n        \n          \n            logs\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              August 13, 2019, 10:59pm\n            \n        #1\n        \n      \n      \n        I\u2019d like to integrate my log monitoring across my organization, including applications not hosted on Platform.sh.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              April 8, 2019,  7:50pm\n            \n        #2\n        \n      \n      \n        Both Logz.io\u2019s recommended forwarder, Filebeat, and the Splunk Universal Forwarder expect a file system with write access to ship logs to their indexers. Platform.sh by design is set-up to host applications on a read-only file system, so it is necessary to utilize mounts to provide these services with write access.\nInstallation, configuration, and shipping are explained briefly below for both Logz.io and Splunk, but more detailed How-tos are also available for more in-depth instruction:\n\nHow to forward Platform.sh logs to Logz.io\nHow to forward Platform.sh logs to a Splunk Indexer\n\nForwarding to Logz.io\n\n1. Define mounts\nDefine a mount in .platform.app.yaml that Filebeat can write to when it ships your logs, filebeat.\n# .platform.app.yaml\n\nmounts:\n    '/.filebeat':\n        source: local\n        source_path: filebeat\n\nMounts aren\u2019t available during build hooks, so one way we can install Filebeat is to create a subdirectory in our project called config/filebeat where we can store installation scripts and temporary builds, and then move them here afterwards.\n2. Modify build and deploy hooks\nInclude the following commands to your existing hooks in .platform.app.yaml:\n# .platform.app.yaml\n\nhooks:\n    build: |\n        if [ ! -z $LOGZ_CONFIG ]; then\n          ./config/filebeat/scripts/install.sh\n        fi\n        pipenv install --system --deploy\n    deploy: |\n        if [ ! \"$(ls -A filebeat)\" ]; then\n             ./config/filebeat/scripts/config.sh\n        fi\n        ./filebeat/filebeat run --once\n\nIn the build hook here an installation script config/filebeat/scripts/install.sh will install Filebeat in a temporary location during the build hook so long as a project level variable is not defined to show that this step has already been completed.\nAn example install.sh below installs Filebeat to the directory config/filebeat/build/ and downloads a certificate for it. On your Logz.io dashboard under \u2018Log Forwarding\u2019 the Filebeat instructions include more detail about these steps.\n# config/filebeat/scripts/install.sh\n\n#!/usr/bin/env bash\n\nTEMP_BEAT_HOME=config/filebeat/build\n\n[ ! -d $TEMP_BEAT_HOME ] &amp;&amp; mkdir -p $TEMP_BEAT_HOME\ncd $TEMP_BEAT_HOME\n\n# Install Filebeat\ncurl -L -O https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-6.7.0-linux-x86_64.tar.gz\ntar xzvf filebeat-6.7.0-linux-x86_64.tar.gz\nrm filebeat-6.7.0-linux-x86_64.tar.gz\n\n# Download the certificate\nwget https://raw.githubusercontent.com/logzio/public-certificates/master/COMODORSADomainValidationSecureServerCA.crt\n\nmkdir -p filebeat-6.7.0-linux-x86_64/pki/tls/certs\ncp COMODORSADomainValidationSecureServerCA.crt filebeat-6.7.0-linux-x86_64/pki/tls/certs/\n\nIn the deploy hook if the mount point is empty, a configuration script config/filebeat/scripts/config.sh moves the temporary Filebeat installation to the filebeat and creates a directory registry that will be used to save registry files.\n#!/usr/bin/env bash\n\n# Move filebeat to mount with write access\ncd $PLATFORM_HOME\ncp -v -r config/filebeat/build/filebeat-6.7.0-linux-x86_64/* filebeat\nmkdir filebeat/registry\n\n3. Configure with filebeat.yaml\n\nIn the application directory, place the filebeat.yml file that the Logz.io Wizard created for you in the \u2018Log Forwarding\u2019 section.\nTo ship all Platform.sh logs, enter var/log/*.log as its input. It will specify outputs for you as well.\n4. Complete\nAt this point if you push to platform remote Filebeat will install, configure itself, and ship Platform.sh logs with the last line of the deploy hook: ./filebeat/filebeat run --once.\nIf you keep the build hook as written, a new install will occur with each deployment unless you set a project level variable that designates that Filebeat is already configured:\n$ platform variable:create --level project --name LOGZ_CONFIG --value 'true'\n\nForwarding to Splunk\n1. Define mounts\nDefine a pair mount in .platform.app.yaml that the Forwarder can write to when it ships your logs. It will use splunk to write modified log files before they ship and .splunk to write authorization files so that it can remember configurations and credentials after it connects to your indexer.\n# .platform.app.yaml\n\nmounts:\n    'splunk':\n        source: local\n        source_path: splunk\n    '/.splunk':\n        source: local\n        source_path: splauths\n\nSame as above, since mounts aren\u2019t available during build we can install the Universal Forwarder in a subdirectory called config/filebeat where we can store installation scripts and temporary builds.\n2. Modify build and deploy hooks\n# .platform.app.yaml\n\nhooks:\n    build: |\n        if [ ! -z $SPLUNK_CONFIG ]; then\n            ./config/splunk/scripts/install.sh\n        fi\n        pipenv install --system --deploy\n    deploy: |\n        if [ ! \"$(ls -A splunk)\" ]; then\n             ./config/splunk/scripts/config.sh\n        fi\n        ./splunk/splunkforwarder/bin/splunk restart\n\nIn the build hook, the Forwarder will be installed in the temporary directory config/splunk/build, so long as a project level variable that denotes a completed configuration has not been set.\n# config/splunk/scripts/install.sh\n\n#!/usr/bin/env bash\n\nTEMP_SPLUNK_HOME=config/splunk/build\n\n# Install Splunk Universal Forwarder\n[ ! -d $TEMP_SPLUNK_HOME ] &amp;&amp; mkdir -p $TEMP_SPLUNK_HOME\ncd $TEMP_SPLUNK_HOME\nwget -O splunkforwarder-7.2.5.1-962d9a8e1586-Linux-x86_64.tgz 'https://www.splunk.com/bin/splunk/DownloadActivityServlet?architecture=x86_64&amp;platform=linux&amp;version=7.2.5.1&amp;product=universalforwarder&amp;filename=splunkforwarder-7.2.5.1-962d9a8e1586-Linux-x86_64.tgz&amp;wget=true'\ntar xvzf splunkforwarder-7.2.5.1-962d9a8e1586-Linux-x86_64.tgz\nrm splunkforwarder-7.2.5.1-962d9a8e1586-Linux-x86_64.tgz\n\nIn the deploy hook,\n# config/splunk/scripts/config.sh\n\n#!/usr/bin/env bash\n\ncd $PLATFORM_APP_DIR\n\nTEMP_SPLUNK_HOME=config/splunk/build/*\nSPLUNK_HOME=$PLATFORM_APP_DIR/splunk/splunkforwarder\n\n# Copy temp build to writable storage\ncp -v -r $TEMP_SPLUNK_HOME splunk\n\n# Migrate used-seed.conf to the forwarder\ncp -v config/splunk/seeds/user.conf $SPLUNK_HOME/etc/system/local/user-seed.conf\n\n# Start Splunk for the first time, accepting license\n./splunk/splunkforwarder/bin/splunk start --accept-license\n\n# Update outputs.conf with receiver address seed\ncp -v $PLATFORM_APP_DIR/config/splunk/seeds/outputs.conf $PLATFORM_APP_DIR/splunk/splunkforwarder/etc/system/local/outputs.conf\n\n# Update inputs.conf with monitor inputs seed\ncp -v $PLATFORM_APP_DIR/config/splunk/seeds/inputs.conf $PLATFORM_APP_DIR/splunk/splunkforwarder/etc/system/local/inputs.conf\n\n3. Create configuration files\nSplunk has a dedicated CLI that allows you to configure inputs and outputs, but it recommends creating a set of configuration seed files instead.\n\n\nuser.conf: The Forwarder comes with a default admin user with the password changeme. You will need to create this file to update the password or else remote access will not be available. Once it has been moved, you can start the Forwarder for the first time and modify the remaining configurations.\n# config/splunk/seeds/user.conf\n[user_info]\nUSERNAME = admin\nPASSWORD = testpass\n\n\n\noutputs.conf: This file configures information about the Splunk Receiver/Indexer. Replace &lt;receiver ip&gt; with the IP address of the Indexer. If you have changed the default listening port for the Indexer from 9997, you will need to change that as well.\n# config/splunk/seeds/outputs.conf\n[tcpout] defaultGroup=default \n\n[tcpout:default] server=&lt;receiver ip&gt;:9997 \n\n[tcpout-server:&lt;receiver ip&gt;:9997]\n\n\n\ninputs.conf: Finally, configure the forward to monitor all files in /var/log, the location of Platform.sh log files.\n# config/splunk/seeds/inputs.conf\n[monitor://var/log/]\ndisabled = false\n\n\n\nEach of these seed files can be placed in config/splunk/seeds in your project directory, and each is moved to the Forwarder\u2019s final installation location during the deploy hook.\n4. Complete\nLike the Logz.io instructions above, these configuration settings will install and configure the Splunk Universal Forwarder to ship Platform.sh logs on every deployment with the last line of the deploy hook: ./splunk/splunkforwarder/bin/splunk restart.\nIf you keep the build hook as written, a new install will occur with each deployment unless you set a project level variable that designates that Splunk is already configured:\n$ platform variable:create --level project --name SPLUNK_CONFIG --value 'true'\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to export database table data to a CSV file with platform-cli", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-export-database-table-data-to-a-csv-file-with-platform-cli/370", "documentId": "14bc1c4bf346469192eb77462d143b0be71c2ebf", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to export database table data to a CSV file with platform-cli\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            mysql-mariadb\n          \n        \n        \n          \n            postgresql\n          \n        \n        \n          \n            platform-cli\n          \n        \n        \n          \n            sql\n          \n        \n        \n          \n            csv\n          \n        \n        \n          \n            mysql\n          \n        \n    \n\n\n\n\n  \n      \n        \n          matthias-van-woensel\n          \n        \n\n        \n            \n              August 8, 2019,  4:09pm\n            \n        #1\n        \n      \n      \n        Goal\nYou want to export a database table (or a part of it) to a CSV file.\nAssumptions\nYou will need:\n\nPlatform CLI\n\nPlatform SQL\nThe platform CLI tool allows you to connect to your database using the command\nplatform sql\nYou can also specify which query you want to run. This will show you all the tables in your database.\nplatform sql \"SHOW TABLES\"\nExporting data\nWith this, piping it to a file then becomes trivial. Just add --raw to your command to make the output machine readable. If there is more than one column, it will be separated by a TAB character.\nplatform sql \"SHOW TABLES\" --raw &gt; all_tables.csv\nTo export data from the table items, in the database main simply do:\nplatform sql \"SELECT id, title FROM items LIMIT 10\" --raw --schema=main &gt; tab_separated_output.csv\n\nThe resulting file can be opened with any spreadsheet software (libreoffice, openoffice, MS Office). Simply select TAB as a column separator.\nWarning\nNote that these queries will run on your database server. If the tables are large, exporting them can take a while.\nMore information\nFor more information on what is possible with platform sql try\nplatform sql --help\nor checkout the platform cli git repository https://github.com/platformsh/platformsh-cli\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to transfer files between two different projects", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-transfer-files-between-two-different-projects/373", "documentId": "a917f2dbae1f3560aa03c262a56df3039e11d2b4", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to transfer files between two different projects\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          bogdan-vasilescu\n          \n        \n\n        \n            \n            \n              August 13, 2019,  1:17pm\n            \n        #1\n        \n      \n      \n        Transfer files between two different projects with SSH or SCP\nGoal\nThe goal is to transfer files between two separate projects.\nAssumptions\nYou will need two projects set up on Platform.sh:\n\nOne project (undntpvafhdn4 in this guide) that acts as the data source.\nOne project (xksjd6v6od7iq) that is the data sink (where we want to copy data to).\n\nProblems\nCommunications between projects relies on SSH, so managing the keys needs to be automated.\nSteps\n1. Preparing the data sink\nOn the data sink, add .ssh as a writeable mount (this is to allow SSH to write into known_hosts). Your .platform.app.yaml has to contain this block:\nmounts:\n    \".ssh\":\n      source: local\n      source_path: .ssh\n\n\nIn the build hook, install the Platform.sh CLI. This is used to dynamically retrieve the data source\u2019s SSH connection string. If the remote will not change, you can also hardcode the path and avoid this step.\nhooks:\n    build: |\n      echo \"### INSTALLING Platform.sh CLI ... ###\"\n      curl -sS https://platform.sh/cli/installer | php\n\n2. Transferring files\nConnect to the data sink project using the -A option for SSH (this allows SSH key forwarding and connections to the data source project from the data sink project):\n&gt; ssh -A \"$(platform ssh -p xksjd6v6od7iq --pipe)\"\n\n ___ _      _    __                    _\n| _ \\ |__ _| |_ / _|___ _ _ _ __    __| |_\n|  _/ / _` |  _|  _/ _ \\ '_| '  \\ _(_-&lt; ' \\\n|_| |_\\__,_|\\__|_| \\___/_| |_|_|_(_)__/_||_|\n\n\n Welcome to Platform.sh.\n\n This is environment master-7rqtwti\n of project xksjd6v6od7iq.\n\nweb@pff7myd47w7zhnm43cetvkeujy:~$\n\nand run the rsync command:\nweb@pff7myd47w7zhnm43cetvkeujy:~$ rsync -avrz \"$(platform ssh -p undntpvafhdn4 -e master --pipe)\":/app/web/*.txt /tmp/\nWarning: Permanently added 'ssh.eu-3.platform.sh,63.34.120.202' (RSA) to the list of known hosts.\nreceiving incremental file list\n1.txt\n2.txt\n\nsent 62 bytes  received 147 bytes  418.00 bytes/sec\ntotal size is 4  speedup is 0.02\nweb@pff7myd47w7zhnm43cetvkeujy:~$\n\n3. Automating it with a SSH key\nIf you do not want to rely on the SSH -A switch to enable key forwarding, you can add an SSH key to have the connection set up automatically.\nOn your local machine, generate a new key with no passphrase:\n&gt; ssh-keygen -f id_rsa_transfer\nGenerating public/private rsa key pair.\nEnter passphrase (empty for no passphrase):\nEnter same passphrase again:\nYour identification has been saved in id_rsa_transfer.\nYour public key has been saved in id_rsa_transfer.pub.\nThe key fingerprint is:\nSHA256:&lt;randomstring&gt;\nThe key's randomart image is:\n&lt;key_image&gt;\n\nAdd the generated public key into .ssh/authorized_keys in the data source project and commit the change:\n&gt; cat id_rsa_transfer.pub &gt; &lt;datasourceprojectpath&gt;/.ssh/authorized_keys\n&gt; cd &lt;datasourceprojectpath&gt;\n&gt; git commit -m \"Add SSH key\"\n&gt; git push\n\nAdd the key in the data sink project:\n&gt; cat id_rsa_transfer &gt; &lt;datasinkprojectpath&gt;/.ssh/id_rsa\n&gt; cat id_rsa_transfer.pub &gt; &lt;datasinkprojectpath&gt;/.ssh/id_rsa.pub\n&gt; cd &lt;datasinkprojectpath&gt;\n\nEdit the build hook to set the correct permissions on the keys:\nhooks:\n    build: |\n      &lt;... other commands ...&gt;\n      chmod 0600 .ssh/id_rsa\n\t  chmod 0600 .ssh/id_rsa.pub\n\nCommit the changes:\n&gt; git commit -m \"Add SSH key\"\n&gt; git push\n\nOn the data source project, add a separate Platform.sh user in the Console and add the newly generated public key in the new account. Provide the least privileges possible (Viewer), for security reasons.\nNow, connect in the data sink project without the -A switch:\n&gt; ssh xksjd6v6od7iq-master-7rqtwti--app@ssh.eu-3.platform.sh\n\n ___ _      _    __                    _\n| _ \\ |__ _| |_ / _|___ _ _ _ __    __| |_\n|  _/ / _` |  _|  _/ _ \\ '_| '  \\ _(_-&lt; ' \\\n|_| |_\\__,_|\\__|_| \\___/_| |_|_|_(_)__/_||_|\n\n\n Welcome to Platform.sh.\n\n This is environment master-7rqtwti\n of project xksjd6v6od7iq.\n\nweb@pff7myd47w7zhnm43cetvkeujy:~$\n\nand rsync still works:\nweb@pff7myd47w7zhnm43cetvkeujy:~$ rsync -avrz \"$(platform ssh -p undntpvafhdn4 -e master --pipe)\":/app/web/*.txt /tmp/\nWarning: Permanently added 'ssh.eu-3.platform.sh,63.35.24.107' (RSA) to the list of known hosts.\nreceiving incremental file list\n1.txt\n2.txt\n\nsent 62 bytes  received 147 bytes  418.00 bytes/sec\ntotal size is 4  speedup is 0.02\n\nConclusion\nThe two projects were set up to transfer files in an automated way.\n      \n\n      \n\n      \n         \n         \n         2 Likes\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          bogdan-vasilescu\n          \n            unlisted \n        \n\n        \n            \n              August 13, 2019, 10:33am\n            \n        #2\n        \n      \n      \n        \n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          robert\n          \n            listed \n        \n\n        \n            \n              August 13, 2019, 10:43am\n            \n        #3\n        \n      \n      \n        \n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How do I check the disk usage for elastic search?", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-do-i-check-the-disk-usage-for-elastic-search/395", "documentId": "e7f9390f1c4c5b5950a9a44b412408fbec61887e", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How do I check the disk usage for elastic search?\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            elasticsearch\n          \n        \n        \n          \n            disk\n          \n        \n    \n\n\n\n\n  \n      \n        \n          matthias-van-woensel\n          \n        \n\n        \n            \n            \n              November 18, 2019, 10:19am\n            \n        #1\n        \n      \n      \n        Goal\nGet the available disk size of elasticsearch\nAssumptions\nYou already have elasticsearch set-up and running.\nSteps\n1. Log in to the app container using ssh\nhttps://docs.platform.sh/development/access-site.html#accessing-the-application-with-ssh\n2. Query the elastic search api\nRun this curl snippet assuming your elasticsearch relationship is called elasticsearch. If the name is different, change the snippet below to reflect that.\ncurl -XGET 'elasticsearch.internal:9200/_cat/allocation?v&amp;pretty'\nshards disk.indices disk.used disk.avail disk.total disk.percent host   ip   node\n4   124.7kb   22.6mb   1.8gb   1.9gb   1 127.0.0.0 127.0.0.0 2kv5ycbzprs4bomyaeu6zkvoh4\n\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          yhoiseth\n          \n        \n\n        \n            \n              November 15, 2019,  2:54pm\n            \n        #2\n        \n      \n      \n        The command is missing a quote character. Should be curl -XGET 'elasticsearch.internal:9200/_cat/allocation?v&amp;pretty'\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to deploy a Vue.js Single Page Application (SPA) with a Golang API on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-deploy-a-vue-js-single-page-application-spa-with-a-golang-api-on-platform-sh/182", "documentId": "08888b529f4a67e87f4cf9182716b5a5a96bbf19", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to deploy a Vue.js Single Page Application (SPA) with a Golang API on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            golang\n          \n        \n        \n          \n            api\n          \n        \n        \n          \n            vuejs\n          \n        \n    \n\n\n\n\n  \n      \n        \n          juliensalinas\n          \n        \n\n        \n            \n            \n              August 21, 2019, 12:02pm\n            \n        #1\n        \n      \n      \n        Goal\nDeploy a Vue.js Single Page Application (SPA) with a Golang API backend on Platform.sh\nAssumptions\n\nan empty Platform.sh project with Medium plan\nNode.js installed locally\nVue.js CLI installed locally (npm install -g @vue/cli): https://cli.vuejs.org/\n\n\nProblems\nTwo strategies are possible when building an SPA with Platform.sh:\n\ncreating two separate projects for Vue.js frontend and Golang API backend\nhosting both apps within a single multi-app Platform project (requires at least a Medium plan)\n\nThis How-to shows the second option.\nSteps (Multi-app SPA)\n1. Project structure\nUltimately, the project structure will look like the following (one common .platform directory, and one .platform.app.yaml file per app):\nvuespa/\n    .git/\n    .platform/\n        routes.yaml\n        services.yaml\n    hello_world_backend/\n        .platform.app.yaml\n        hello_world.go\n    hello_world_frontend/\n        .platform.app.yaml\n        node_modules/\n        public/\n        src/\n            App.vue\n            main.js\n        babel.config.js\n        package-lock.json\n        package.json\n\n2. Set Up Golang App\n1. Create the Go Project\nCreate and enter a project directory vuespa. Create a hello_world_backend directory, and then create the following hello_world.go file within that directory:\n// vuespa/hello_world_backend/hello_world.go\n\npackage main\n\nimport (\n\t\"encoding/json\"\n\t\"fmt\"\n\t\"net/http\"\n\n\tpsh \"github.com/platformsh/gohelper\"\n\t\"github.com/rs/cors\"\n)\n\n// Greetings is a basic Greetings to user\ntype Greetings struct {\n\tMessage string `json:\"message\"`\n}\n\n// sayHello returns greetings to user in JSON format\nfunc sayHello(w http.ResponseWriter, r *http.Request) {\n\n\tgreetings := Greetings{Message: \"Hello World!\"}\n\n\treturnedJSON, err := json.Marshal(greetings)\n\tif err != nil {\n\t\thttp.Error(w, \"Internal server error\", http.StatusInternalServerError)\n\t}\n\n\tw.Header().Set(\"Content-Type\", \"application/json\")\n\tfmt.Fprintf(w, \"%s\", returnedJSON)\n}\n\nfunc main() {\n\n\t// Load Platform.sh environment variables in order to retrieve correct port\n\tp, err := psh.NewPlatformInfo()\n\tif err != nil {\n\t\tpanic(\"Not in a Platform.sh Environment.\")\n\t}\n\n\t// Initialize HTTP server\n\tmux := http.NewServeMux()\n\n\t// Set up the /say-hello API endpoint\n\tmux.HandleFunc(\"/say-hello\", sayHello)\n\n\t// Enable CORS and Whitelist the frontend domain in order to comply with\n\t// CORS Allowed Origins policy\n\thandler := cors.New(cors.Options{\n\t\tAllowedOrigins: []string{\"https://your-platformsh-frontend-url\"},\n\t}).Handler(mux)\n\n\t// Launch HTTP server with custom port retrieved in Platform.sh env var\n\thttp.ListenAndServe(\":\"+p.Port, handler)\n}\n\nThe above exposes a say-hello REST endpoint returning a greetings message to user.\nCORS need to be properly handled as both frontend and backend apps are not hosted at the same URLs. Ideally the frontend URL whitelisted in CORS (https://your-platformsh-frontend-url) should be retrieved through an environment variable.\nFor more information about CORS please visit: https://wikipedia.org/wiki/Cross-origin_resource_sharing\nThe frontend url will not be made available until the project is pushed to Platform.sh for the first time, so it may be necessary to push the code once to establish those routes, and then commit the url once they are defined.\nIn general, they will take the forms https://https://master-7rqtwti-&lt;project ID&gt;.&lt;project region&gt;.platformsh.site for the frontend url and https://https://backend.master-7rqtwti-&lt;project ID&gt;.&lt;project region&gt;.platformsh.site for the backend url.\n2. Set up the Platform.sh configuration\nCreate a .platform.app.yaml within the directory:\n# vuespa/hello_world_backend/.platform.app.yaml\n\nname: go-backend\n\n# Use the Golang 1.12 image\ntype: golang:1.12\n\n# A Medium plan is necessary for multi-app\nsize: M\n\nhooks:\n  # Get dependencies and build Go app\n  build: |\n    go get ./...\n    go build -o bin/app\n\nweb:\n  upstream:\n    socket_family: tcp\n    protocol: http\n\n  # Launch the Go server\n  commands:\n    start: ./bin/app\n\n  locations:\n    /:\n      allow: false\n      passthru: true\n\ndisk: 1024\n\n3. Set Up Vue.js App\n1. Initialize the Vue.js project\nCreate the Vue.js base project with the Vue CLI, selecting the default install option when prompted:\n$ vue create hello_world_frontend\n\ncd into hello_world_frontend and install the axios dependency:\n$ npm install axios\n\n2. Update The Vue.js Project\nRemove everything inside the src directory except the main.js file and add the following App.vue file:\n&lt;!-- vuespa/hello_world_frontend/src/App.vue --&gt;\n\n&lt;template&gt;\n  &lt;div id=\"app\"&gt;\n    &lt;p v-if=\"msg\"&gt;\n      Retrieved the following greetings message from API Go backend:\n      &lt;b&gt;{{ msg }}&lt;/b&gt;\n    &lt;/p&gt;\n    &lt;p v-if=\"msgError\"&gt;\n      Error while getting message from Go API backend:\n      &lt;b&gt;{{ msgError }}&lt;/b&gt;\n    &lt;/p&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\nimport axios from 'axios'\nexport default {\n  name: 'app',\n  data() {\n    return {\n      msg: '',\n      msgError: '',\n    }\n  },\n  mounted: function () {\n    axios.get('https://your-platformsh-backend-url/say-hello')\n      .then(response =&gt; {\n        if (response.status === 200) {\n          if (response.data) {\n            this.msg = response.data.message\n          } else {\n            this.msgError = 'Got no data from API'\n          }\n        } else {\n          this.msgError = 'Got an ok but unhandled HTTP response from API'\n        }\n      })\n      .catch(e =&gt; {\n        if (e.response) {\n          if (e.response.status === 500) {\n            this.msgError = 'Got an internal server error from API'\n          } else {\n            this.msgError = 'Got an unhandled error HTTP response from API'\n          }\n        } else if (e.request) {\n          this.msgError = 'Got no response when contacting API server'\n        } else {\n          this.msgError = 'Got an unhandled error when contacting API server'\n        }\n      })\n\n  }\n}\n&lt;/script&gt;\n\n3. Set up the Platform.sh configuration\nNow create a .platform.app.yaml with the following:\n# vuespa/hello_world_frontend/.platform.app.yaml\n\nname: vuejs-frontend\n\ntype: nodejs:10\n\n# A Medium plan is necessary for multi-app\nsize: M\n\nhooks:\n  build: |\n    npm install\n    npm run build\n\n# There is no need for a writable file mount, so set it to the smallest possible size.\ndisk: 256\n\nweb:\n  commands:\n    # Run a no-op process that uses no CPU resources, since this is a static site.\n    start: sleep infinity\n  locations:\n    \"/\":\n      root: \"dist\"\n      index:\n        - \"index.html\"\n      # Set a 5 minute cache lifetime on all static files.\n      expires: 300s\n      # Disable all scripts, since we don't have any anyway.\n      scripts: false\n      # By default do not allow any files to be served.\n      allow: false\n      # Whitelist common image file formats, plus HTML files, robots.txt\n      # All other requests will be rejected.\n      rules:\n        \\.(css|js|gif|jpe?g|png|ttf|eot|woff2?|otf|html|ico|svg?)$:\n          allow: true\n        ^/robots\\.txt$:\n          allow: true\n\n4. Set Up Routes and Services\nIn the root directory create a .platform directory. Create a routes.yaml file.\n# vuespa/.platform/routes.yaml\n\n\"https://backend.{default}/\":\n  type: upstream\n  upstream: \"go-backend:http\"\n\"https://{default}/\":\n  type: upstream\n  upstream: \"vuejs-frontend:http\"\n\nCreate an empty services.yaml file.\n# vuespa/.platform/services.yaml\n\n\n5. Deploy\nSet the repository\u2019s remote to an empty Platform.sh project using its project ID, which can be found within the Web UI or by listing the accounts active projects with the Platform.sh CLI, platform project:list.\n$ platform project:set-remote &lt;project ID&gt;\n\nCommit changes and deploy.\n$ git init\n$ git add .\n$ git commit -m \"Init commit\"\n$ git push platform master\n\n6. Verify\nVisit the frontend URL to see the following message:\nRetrieved the following greetings message from API Go backend: Hello World!\nConclusion\nSetting Up a Vue.js SPA + Golang API within a muti-app project on Platform.sh is pretty simple. It requires no local compilation and the project is instantly testable via an HTTPS URL.\nAn improvement would be to dynamically retrieve the backend URL in the frontend app (for API results fetching), and conversely to retrieve the frontend URL in the backend app (for CORS whitelisting).\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to use cmake in a Platform.sh build hook", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-use-cmake-in-a-platform-sh-build-hook/405", "documentId": "9670ddbc66245945ba376b935923b847b362aba6", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to use cmake in a Platform.sh build hook\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          oripekelman\n          \n        \n\n        \n            \n              November 20, 2019, 12:13pm\n            \n        #1\n        \n      \n      \n        Goal\nSometimes a library may require cmake in order to compile. By default you only have make available. An example would be libgit2 how would you get this to work on platform.sh ?\nAssumptions\nYou will need:\n\nAn SSH key configured on your Platform.sh account\nA Platform.sh project and a .platform.app.yaml to edit\n\nSteps\n1. Add at the beginning of your  build hook in .platform.app.yaml\n\nSetting VERSION to the version of cmake you want.\nexport VERSION=\"3.16.0-rc4\"\nwget https://github.com/Kitware/CMake/releases/download/v$VERSION/cmake-$VERSION-Linux-x86_64.tar.gz\ntar xzf cmake-$VERSION-Linux-x86_64.tar.gz\nexport PATH=$PATH:/$PWD/cmake-$VERSION-Linux-x86_64/bin\n\n2. Potentially cleanup  at the end of the build step if you don\u2019t want cmake in production\nrm -rf /$PWD/cmake-$VERSION-Linux-x86_64\n\nConclusion\nAny dependencies that require cmake in their build should very probably work now.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to reset a project's code and data", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-reset-a-projects-code-and-data/382", "documentId": "e06d4ba93c1dbb43ad7065c0f40bcbaa6f29cae0", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to reset a project's code and data\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              August 26, 2019,  6:56pm\n            \n        #1\n        \n      \n      \n        Goal\nTo reset a project entirely to a new code base.\nAssumptions\nYou will need:\n\nA working Platform.sh project\nAdministrator access to it\nGit and SSH configured and accessible\n\nProblems\nNormally the easiest way to \u201cstart fresh\u201d with a project on Platform.sh is to create a new project and optionally delete the old one.  However, there are some cases where that may not be viable:\n\nWhen using a trial project, deleting the project created with the trial will also delete the trial, even if the trial period has not expired.\nYou may want to retain non-code configuration on the project (users, access control, etc.) but still reset all code and data on the project.\n\nThese steps will \u201creset\u201d a project to a fresh state.\nWarning: By design, these instructions will result in code and data loss.  Do not proceed unless code and data loss is really what you want to do.\nSteps\n1. Remove all services and application data\nEdit the services.yaml file and remove all lines.  Just leave it as an empty file.\nThen update your .platform.app.yaml file.  Remove the relationships block, all mount declarations and change the name key to any new value.\nOptionally you may remove the hooks section to make the deploy a bit faster but that is not necessary.\nIf you have multiple .platform.app.yaml files, do the same for all of them.\nCommit these changes and git push to the master branch.  The environment will rebuild with no services (and thus deleting all of the previously-specified services) and with a blank application container.\nAdditionally, delete any non-master branches in Git as they will not work correctly after this process is complete.\n2. Select a new code base to deploy\nIf you have an existing Git repository you wish to deploy, ensure it has the appropriate Platform.sh configuration files.\nIf you would like to use a one of Platform.sh\u2019s pre-made templates, git clone the appropriate repository from GitHub to your local computer.\n\nPHP Templates\nPython Templates\nNode.js Templates\nJava Templates\nRuby Templates\nGo Templates\n\nNow reset the Git history in the repository.  cd into the directory you just cloned, then run:\n$ rm -rf .git\ngit init\ngit add .\ngit commit -m \"Add Platform.sh template.\"\n\n3. Force push to the project\nAdd a Git remote for the project to the local Git repository you just created.  You can find the Git URL to use in the Web Console by going to the master environment and selecting the \u201cGit\u201d dropdown.  Just copy the remote URL itself, not the full command.\nAdd that remote to the project (using the Git URL you just copied):\ngit remote add platform abc123@git.eu-3.platform.sh:abc123git\n\nThen \u201cForce push\u201d to the master branch of the project:\ngit push --force -u platform master\n\nThat will completely overwrite the master branch on Platform.sh with the code in your new repository, and set your local branch to track the project\u2019s master branch so you don\u2019t need to specify it in the future.\nThe new code will build and deploy a new master environment with the configuration in Git.\nConclusion\nThe project will now have a fresh Git history with new code, and completely empty services based on what was defined in the new code base.  Any users or environment variables that had been defined previously, however, will remain intact.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Is my built code counted against my global plan storage?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/is-my-built-code-counted-against-my-global-plan-storage/163", "documentId": "1452be7df675b9c6364cec49658ea855013625d1", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Is my built code counted against my global plan storage?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            storage\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              August 13, 2019, 10:59pm\n            \n        #1\n        \n      \n      \n        If my plan has 5GB storage, and my built code takes up 500K, does that get taken off of my available storage (5GB)?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              April 12, 2019,  2:43pm\n            \n        #2\n        \n      \n      \n        No. When your application image is created during the build process it is ultimately mounted outside of the persisted block storage on the grid host, and therefore does not count against the usage there.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to back up environment variables", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-back-up-environment-variables/430", "documentId": "6acba05d40f62fe732af9020c889af8f111de80f", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to back up environment variables\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            backups\n          \n        \n        \n          \n            env-variables\n          \n        \n    \n\n\n\n\n  \n      \n        \n          matthias-van-woensel\n          \n        \n\n        \n            \n              December 11, 2019,  3:22pm\n            \n        #1\n        \n      \n      \n        Introduction\nYou always need to store some sensitive data for your application to work. But you should never store them in your git repository. For this, you can use environment variables to define per-environment configuration settings and other sensitive information. Each project depends on those settings and will not work without the correct value in each variable.\nThe default \u2018restore from backup\u2019 procedure on platform.sh will restore your code and data but it will not store environment variables because of safety concerns.\nThis article describes how you can backup your variables in a secure and easy way.\nNote: This article is based on a blog post written by Ivan Ternovtsiy from Contextual Code.\nContextual Code relies heavily on Platform.Sh to host their customer\u2019s websites. Feel free to check out their original blog post and website.\nPrerequisites\nYou will need:\n\n\n\u201cOpenSSL\u201d PHP extension. Installed on platform.sh by default.\n\n\u201cAWS\u201d CLI installed and configured with access to the backup bucket\n\ndependencies: \n    python2: \n        awscli: '*'\n\n\n\n\u201cplatform\u201d CLI installed and configured with access to project variables\n\nSet your token in the PLATFORMSH_CLI_TOKEN environment variable.\nupdate .platform.app.yaml\n\n\n\n\n  hooks:\n     build: |\n         if [ ! -z \"$PLATFORMSH_CLI_TOKEN\" ]; then\n             curl -sS https://platform.sh/cli/installer | php\n         fi\n\nBackup\nTo configure a daily backup, follow these steps. It will add a daily backup with 7 days of retention. Storage data files are named PROJECT_BRANCH_EnvVars_DAY.json. The command MUST be executed on the platform.sh instance, otherwise, it will not be able to access sensitive variables value.\n\nSet Platform.sh variables:\n\n    platform variable:create --level=project --name=BACKUP_ENVVAR_S3_DIRECTORY --value=\"s3://your-bucket/platformsh-env-variables\" --json=false --sensitive=false --prefix=env --visible-build=false --visible-runtime=true\n\n\nCopy backup utility tool from contextual code\n\n\n      cd &lt;PROJECT_ROOT&gt;/bin/php\n    wget https://gitlab.com/contextualcode/platformsh-migration/raw/master/utils/backup_environment_variables.php\n\n\nAdd backup_env_vars_to_s3 cron ( .platform.app.yaml):\n\n      backup_env_vars_to_s3:\n        spec: '45 23 * * *'\n        cmd: php bin/php/backup_environment_variables.php\n\n\nCommit the changes:\n\n    git add .platform.app.yaml bin/php/backup_environment_variables.php\n    git commit -m \"Add backup environment variables to AWS S3\"\n    git push\n\nUnder the hood\nBelow is a summary of what the code is actually doing, but feel free to check the source code. It\u2019s always a good idea to inspect third party code before running it, especially when sensitive information is at risk.\n\nread list of environment variables using \u201cplatform variables\u201d command.\nread actual value of sensitive variable using php \u201cgetenv()\u201d function.\nread variable options (level, is sensitive, is inheritable, is json)\nbuild json with \u2018method\u2019, \u2018iv\u2019, \u2018data\u2019, \u2018tag\u2019.\n\n\u2018method\u2019 - encryption method. AES-256-GCM for PHP7.1+ and AES-256-CBC otherwise.\n\u2018iv\u2019 - random initialization vector, used during encryption.\n\u2018tag\u2019 - encryption tag. Used for AES-256-GCM, empty for AES-256-CBC.\n\u2018data\u2019 - encrypted json with variables list.\n\n\nstore json to file and push it to S3 using aws s3 cp command.\n\nRestore\nThe \u2018restore\u2019 command can be triggered from a platform.sh instance or outside.\nKeep in mind that execution outside of platform.sh will not be able to perform \u201csame exists\u201d checks for sensitive variables. As a result, it will trigger the update of all variable disregard existing variable values.\nTo restore values from Platform.sh.\n\nOn platform.sh, copy file from gitlab\n\n\ncd /tmp wget https://gitlab.com/contextualcode/platformsh-migration/raw/master/utils/restore_environment_variables.php\n\n\nCheck the latest backup filename and restore variables from it. Use --dry-run to see what will be created/updated.\n\naws s3 ls s3://your-bucket/platformsh-env-variables/ php /tmp/restore_environment_variables.php --dry-run --s3dir=s3://your-bucket/platformsh-env-variables --s3filename=projectname_stageEnvVars_FRI.json --override-existing --secret=ChangeTheSecret\n\n\nAfter changing per environment variable, platform.sh will trigger a redeploy, so you\u2019ll need to re-execute step 2 a few times to get all the variables restored.\n\nUnder the hood\nBelow is a summary of what the code is actually doing, but feel free to check the source code. It\u2019s always a good idea to inspect third party code before running it, especially when sensitive information is at risk.\n\ndownload file from S3 using aws s3 cp.\ndecrypt it with PHP \u201copenssl_decrypt\u201d function\ncompare variables in file with existing variables\ncreate variables using platform variable:create command.\n\nignore variables with the same value as already defined in the environment\nskip existing variables unless --override-existing option specified.\nupdate variables using platform variable:update command.\n\n\n\nConclusion\nThat\u2019s it! You should now have a backup and restore process for your environment variables!\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Where could I submit feature request?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/where-could-i-submit-feature-request/257", "documentId": "ca1f279e6063a7ff30a1330c064f12700896abb5", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Where could I submit feature request?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          mrkschan\n          \n        \n\n        \n            \n              May 6, 2019,  2:14am\n            \n        #1\n        \n      \n      \n        I have some features in mind that would like to see on Platform.sh, where could I submit the feature request?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    Is it possible to run a docker container on Platform.sh?\n                  \n                \n          \n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              May 17, 2019,  5:02pm\n            \n        #2\n        \n      \n      \n        You can bring up a feature request for the CLI by adding an issue to the CLI repository here.\nIf your request is for the management console, you can submit on the public issue tracker here.\nIn both cases, a moderator will add a feature request label to your issue.\nOtherwise, you can join our public Slack channel and bring up the feature request  there.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I see the status of a bug?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-see-the-status-of-a-bug/260", "documentId": "3aa14a52b228c7a7bf58163bf64e7dc08832b897", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I see the status of a bug?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          bogdan-vasilescu\n          \n        \n\n        \n            \n              May 6, 2019,  9:37am\n            \n        #1\n        \n      \n      \n        I opened a ticket a while ago for a problem and received the reply that my problem is a known bug and will be fixed in the future. How can I track the status of my bug ? will I be informed when it\u2019s fixed somehow ?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              May 20, 2019,  2:43pm\n            \n        #2\n        \n      \n      \n        If you open a ticket that relates to a known bug, the support team will likely provide a Jira ID for it. Currently, however, there is no standard location to check the status of that bug or when it will be fixed.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Why should I use Platform.sh over AWS?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/why-should-i-use-platform-sh-over-aws/314", "documentId": "f763a558a69f56e51f3e8d10bff522d859be7f1b", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Why should I use Platform.sh over AWS?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              August 13, 2019, 10:56pm\n            \n        #1\n        \n      \n      \n        What are the benefits of using Platform.sh instead?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n            \n              June 20, 2019,  9:19pm\n            \n        #2\n        \n      \n      \n        The main advantage of using a PaaS like Platform.sh over a lower-level IaaS like AWS comes down to making more things \u201cnot your problem\u201d.\nBy building directly on AWS, you have to worry about things like:\n\nKeeping your kernel and underlying libraries and tools up to date.\nTracking necessary security updates in your toolchain.\nCreating and managing test environments.\nManaging access control to various environments.\nBackups.\nMonitoring, including having someone awake at 3 am, just in case.\nTiming your build pipeline and deploy process to minimize downtime.\n\nMost (but not all) of the work involved in all of those goes away when using a PaaS like Platform.sh.  You trade away fine-grained control over every aspect of your system, including the boring parts that do not offer you any competitive advantage, in return for being able to focus on the parts of your system that do offer you a competitive advantage: Your code, your data, your business workflow.\nIt is essentially the same argument as why to use an IaaS like AWS rather than owning your own hardware: You trade away some flexibility in return for not having to think about power redundancy, physical hard disk failures, Ethernet cables getting tripped on, etc.  All of that is necessary, but none of it is a competitive advantage.  So you make it \u201csomeone else\u2019s problem\u201d to do well.\nThere are cases where using your own hardware, or your own systems management, is beneficial.  However, those are few and far between and becoming fewer and farther between every year.  For most users today, managing their own AWS instances, like managing their on hardware, is mostly just extra work, not extra value.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Is there a public product roadmap?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/is-there-a-public-product-roadmap/258", "documentId": "c5cbfda9d1cd8092238139d2bbfd7a6d5b2db209", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Is there a public product roadmap?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          mrkschan\n          \n        \n\n        \n            \n              May 6, 2019,  2:15am\n            \n        #1\n        \n      \n      \n        Do you have a public product roadmap?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              May 17, 2019,  1:13pm\n            \n        #2\n        \n      \n      \n        At the moment, Platform.sh does not have a public product roadmap. We hope to soon, so keep an eye out for that announcement.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Transferring backups from P.sh to S3", "section": "Questions & Answers", "url": "https://community.platform.sh/t/transferring-backups-from-p-sh-to-s3/215/4", "documentId": "b85c516e0c6206f8bbdc20e5e744c17829abf792", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Transferring backups from P.sh to S3\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          scotthooker\n          \n        \n\n        \n            \n              April 18, 2019,  8:35pm\n            \n        #1\n        \n      \n      \n        I think this would make a good how to guide.\nAsking here first. I understand I can install s3cmd or aws-cli. Is there any examples kicking around?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          ralt\n          \n        \n\n        \n            \n              May 23, 2019,  2:43pm\n            \n        #2\n        \n      \n      \n        Do you mean backups taken by the \u201cBackup\u201d button in the UI, or something you would do manually with mysqldump and rsync?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          scotthooker\n          \n        \n\n        \n            \n              May 23, 2019,  4:06pm\n            \n        #3\n        \n      \n      \n        I\u2019m not sure of the format of the P.sh backup. But I assume (like mine) some clients have a need to store backups within their own infra or own specified location. So in my case I mean the database and files dumped and rsynced respectively over to S3 or wherever.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              May 29, 2019,  3:34pm\n            \n        #4\n        \n      \n      \n        See: How to sync database backups to Amazon S3\nI was able to transfer my PostgreSQL dumps to S3 doing the following:\n\nCreate sensitive variables for my AWS credentials\n\nplatform variable:create --level=project --name=AWS_ACCESS_KEY_ID --value=&lt;KEY_ID&gt; --json=false --sensitive=true --prefix=env --visible-build=true --visible-runtime=true\nplatform variable:create --level=project --name=AWS_SECRET_ACCESS_KEY --value=&lt;ACCESS_KEY&gt; --json=false --sensitive=true --prefix=env --visible-build=true --visible-runtime=true\n\n\nSince PostgreSQL comes with a default password main, I created another sensitive environment variable PGPASSWORD to set up the dump cron job\n\nplatform variable:create --level=project --name=PGPASSWORD --value=main --json=false --sensitive=true --prefix=env --visible-build=true --visible-runtime=true\n\n\nI created a mount to save the dumps to in my .platform.app.yaml\n\n\nmounts:\n    'backups':\n        source: local\n        source_path: backups\n\n\nInstalled the awscli in my build hook\n\n        if [ ! -z \"$AWS_ACCESS_KEY_ID\" ] &amp;&amp; [ ! -z \"$AWS_SECRET_ACCESS_KEY\" ]; then\n            pip install futures\n            pip install awscli --upgrade --user 2&gt;/dev/null\n        fi\n\n\nCreated a cron job that called my forwarding script restricted to master\n\n\ncrons:\n    dumps_to_s3:\n        spec: '*/15 * * * *'\n        cmd: |\n            if [ \"$PLATFORM_BRANCH\" = master ]; then\n                ./cron/forward_dumps_s3.sh\n            fi\n\n\nThen included a script to perform the dumps and AWS syncs every 15 minutes\n\n#!/usr/bin/env bash\n\nTODAY_DATE=$(date +%Y-%m-%d-%H:%M:%S)\nDUMP_FILE=${TODAY_DATE}-DUMP.sql\n\nDB_HOST=\"database.internal\"\nDB_PORT=5432\nDB_USER=\"main\"\nDUMP_LOC=\"backups\"\n\nAWS_BUCKET=&lt;your bucket name&gt;\nAWS_FOLDER=&lt;bucket folder name&gt;\n\npg_dump --host=$DB_HOST --port=$DB_PORT --username=$DB_USER --file=$DUMP_LOC/$DUMP_FILE\n\naws s3 sync ~/$DUMP_LOC s3://$AWS_BUCKET/$AWS_FOLDER/\n\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I expose non-80/443 TCP port to the Internet?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-expose-non-80-443-tcp-port-to-the-internet/256", "documentId": "27acab0a70811648197f59e4190f6c01ca40caeb", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I expose non-80/443 TCP port to the Internet?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          mrkschan\n          \n        \n\n        \n            \n              May 6, 2019,  2:11am\n            \n        #1\n        \n      \n      \n        My mobile application needs to talk to a service running on Platform via non-80/443 TCP port. How could I expose that port?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              May 17, 2019,  9:27pm\n            \n        #2\n        \n      \n      \n        You cannot.  Platform.sh is a web-centric host.  The only ports that are exposed to the world for incoming requests are 80 (HTTP), 443 (HTTPS), and 22 (SSH).  All other ports are hard-blocked at the network layer.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How are mounts in .platform.app.yaml sized?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-are-mounts-in-platform-app-yaml-sized/157", "documentId": "2d01ce43d147f7b0f42d41ea0812c400956c63a2", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How are mounts in .platform.app.yaml sized?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            storage\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              August 13, 2019, 11:00pm\n            \n        #1\n        \n      \n      \n        Is everything OK as long as the total size of the mounts is less than the value in the disk directive?\nhttps://docs.platform.sh/configuration/app/storage.html#mounts\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              March 26, 2019,  2:06pm\n            \n        #2\n        \n      \n      \n        Mount sizes are defined with the disk key in your .platform.app.yaml configuration file.\nMounts are entirely optional - it may not be necessary for your application to have write access. If not, you will still need to define the disk key in .platform.app.yaml to the minimum requirements\ndisk: 256\n\ndisk defines the size of the persistent disk of the application (in MB), and you will receive a validation error if you attempt to set it lower than 256MB.\nOnce your mounts are defined with the disk key, all mounts will share the amount of disk you allocate to them.\nFor example, in a .platform.app.yaml file that configures its mounts with\ndisk: 1024\n\nmounts:\n    'private':\n        source: local\n        source_path: private\n    'web/uploads':\n        source: local\n        source_path: uploads\n\nThe mounts at mnt/private and mnt/uploads will be accessible in the /app directory at private and web/uploads, and they will together share a maximum of 1024 MB.\nIf you go over that total amount between them, then you will need to expand this pre-allocated disk space in the .platform.app.yaml disk key.\nYou can observe the disk space used by each application mount using the Platform.sh CLI:\n$ platform mount:size\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I remove the \"sent via platform.sh\" in my emails", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-remove-the-sent-via-platform-sh-in-my-emails/263", "documentId": "8f51312aeecc124cb0f539ba7b83f35ca24b459a", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I remove the \"sent via platform.sh\" in my emails\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            sendgrid\n          \n        \n        \n          \n            email\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              February 12, 2020,  7:13pm\n            \n        #1\n        \n      \n      \n        When sending email from platformsh the recipient gets a \u2018via platformsh\u2019 appended. I understand platformsh uses sendgrid. How should i configure my domain so I don\u2019t get the \u2018via\u2019 platformsh message?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          matthias-van-woensel\n          \n        \n\n        \n            \n              May 8, 2019,  8:21am\n            \n        #2\n        \n      \n      \n        You have to set up SPF on your domain.\nPlease refer to : https://docs.platform.sh/development/email.html and https://sendgrid.com/docs/glossary/spf/\nAlternatively, you could use your own sendgrid account, or any other email api.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "What is Git? How to use it?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/what-is-git-how-to-use-it/254", "documentId": "33270b12a9b8c0689f202a8f29778f035bdf72ac", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  What is Git? How to use it?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          mrkschan\n          \n        \n\n        \n            \n              May 6, 2019,  2:03am\n            \n        #1\n        \n      \n      \n        What is Git and how could I use it to upload my website?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              May 6, 2019,  9:44pm\n            \n        #2\n        \n      \n      \n        Git is a version control tool that tracks changes in your code and facilitates collaboration on projects that may involve many developers. You can find an excellent introduction to the basics of Git on their website as well.\nFirst you can download Git from their website if it hasn\u2019t already come installed with your operating system. If you already have Git installed, when you type git into the command line it will return a list of commands.\nIn general, working with Git will depend on whether you are working from a local copy of your code or interacting with a remote repository, such as when your code is actually on Platform.sh or GitHub.\nInteracting with a local repository\n\n\ngit init\nIf you have a directory on your computer that is filled with files, you can track the changes more easily by initializing it as a Git repository.\n$ git init\nInitialized empty Git repository in /Users/chadcarlson/myapp/.git/\n\nNow it\u2019s no longer simply a directory, but is now a repository. The new hidden directory .git has been added to the project, which contains files that label and keep track of whatever changes you make:\n$ ls -a .git\n.\t\t            HEAD\t\thooks\t\tlogs\t\trefs\n..\t\t            config\t\tindex\t\tobjects\nCOMMIT_EDITMSG\t    description\tinfo\t\tpacked-refs\n\n\n\ngit branch\nInitializing a repository made one very important change to your project, which is that it creates the concept of branches to your workflow. Once you initialize it, all of the files are now considered to live on the master branch of your repository. You can view this branch with the command\n$ git branch\n* master\n\nHere, only master is listed, because the repository was only just now initialized. If you want to make changes to your code, however, it is recommended that you make those changes on a new branch, which will make them easier to track. Create a branch using the previous command, only this time include the name of the new branch.\n$ git branch updates\n$ git branch\n* master\n  updates\n\nNow when you list the branches in your repository,  master and updates are both present.\nYou will notice that the asterisk is still located next to master which means that you are still on master, and any changes you make will be applied to the master branch.\n\n\ngit checkout\nSince you don\u2019t want to make changes to master necessarily, you will need to switch to the updates branch. A switch to another branch is called checkout.\n $ git checkout updates\n Switched to branch 'updates'\n $ git branch\n   master\n * updates\n\nNow any changes you make to your files will be changed on the branch updates, but will retain their old versions on master.\n\n\ngit commit\nWhen you\u2019ve made some changes to your files, there is one more important step required to essentially save those changes to the updates branch, and it is the primary unit of change in Git. It is called the commit.\n $ git add .platform.app.yaml \n $ git commit -m \"Update project root name.\"\n [updates f3b74e4] Update project root name.\n 1 file changed, 3 insertions(+), 3 deletions(-)\n\nOn Platform.sh, you can modify how an application is built and deployed inside the .platform.app.yaml file. Make a change to that file on updates and then commit that change with a message. Git will commit those changes to updates and then label that change with an identifier, which in this case is f3b74e4.\nThis means that master remains in its old version, whereas updates has an additional commit of your changes. Another way to say this is that updates is one commit ahead of master.\n\n\ngit merge\nYou\u2019ve made a commit on updates and you\u2019re satisfied with it. You want all changes in the future to include that change. The best way to make sure that this happens is by merging updates, the branch that contains that commit, into master:\n$ git checkout master\nSwitched to branch 'master'\n$ git merge updates\nUpdating 440e085..f3b74e4\n.platform.app.yaml | 6 +++---\n1 file changed, 3 insertions(+), 3 deletions(-)\n\nFirst, checkout master. Then using the form git merge &lt;branch to be merged into currently checked out branch&gt;, which in this case is updates. You will see that master is now updating based on commit f3b74e4.\n\n\nInteracting with a remote repository\nOnce you start collaborating with other developers, it\u2019s best to create a remote version of your repository that others can download and commit changes to.\n\n\ngit remote\nThe first step is to define that remote repository\u2019s location. To set the GitHub repository myapp as remote:\n$ git remote add origin git@github.com:chadwcarlson/myapp.git\n\nor for the Platform.sh project myapp with the project ID wiqte7at4yg22:\n$ platform project:set-remote wiqte7at4yg22\n\n\n\ngit push\nNow that you have set a remote repository, you can push your local copy to the remote location with\n$ git push origin master\n\non GitHub, or for Platform.sh\n$ git push platform master\n\nNow other people can download your files and contribute to your project. It will be good practice from here on out to push your new branches to the remote repository before merging, rather than merging on your local copy.\n$ git push platform updates\n\n\n\nThese are only some of the import Git commands, so be sure to explore them all by typing git in your terminal.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Why is the .platform.app.yaml file separate from the .platform folder?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/why-is-the-platform-app-yaml-file-separate-from-the-platform-folder/281", "documentId": "a4d106c7605e1652852cd1647f50618bfcd48203", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Why is the .platform.app.yaml file separate from the .platform folder?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n              May 14, 2019,  4:58pm\n            \n        #1\n        \n      \n      \n        Why do we have: .platform.* files and also a .platform folder?\nI mean, why not everything in the same folder?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          danmilon\n          \n        \n\n        \n            \n              May 15, 2019,  8:12am\n            \n        #2\n        \n      \n      \n        Because in multi-app projects, there are multiple .platform.app.yaml files one for each app, and the convention is that the .platform.app.yaml file is placed on the top-level directory of the respective application.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n            \n              July 23, 2019, 10:03pm\n            \n        #3\n        \n      \n      \n        The files in .platform control the environment at a cluster level.  They define what services should be in the cluster.\nThe .platform.app.yaml file defines the behavior of one single application container, with your custom code.\nYou can have multiple applications in the same project, with their own code, but having multiple directories each with their own .platform.app.yaml file.\nAny directory that contains a .platform.app.yaml file becomes an application container, configured by that file.  If there\u2019s only one application then the degenerate case is to just make that the repository root, which is fine.  To have multiple application containers, you would do something like:\n/\n  .platform/\n    routes.yaml\n    services.yaml\n  app1/\n      .platform.app.yaml\n  app2/\n      .platform.app.yaml\n\nAnd then app and app2 would become entirely separate application containers with the code in those respective directories.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "What is the right way to run multiple processes from my start command?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/what-is-the-right-way-to-run-multiple-processes-from-my-start-command/224", "documentId": "205c6a0afd846d3a8ea24a5218b79659d8d287a9", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  What is the right way to run multiple processes from my start command?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          adam-mahar\n          \n        \n\n        \n            \n              April 26, 2019, 12:21pm\n            \n        #1\n        \n      \n      \n        I\u2019ve read in the docs that I shouldn\u2019t background a start process, as this will cause the supervisor process to start a second copy, but is it possible to run multiple processes from the start command? What is the right way to do this?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              May 15, 2019,  5:05pm\n            \n        #2\n        \n      \n      \n        You cannot start multiple processes from the start command.\nIf the process you start itself forks, that is fine provided that the parent process remains active and will terminate all children when it receives a sigterm message.  Failure to do so will leave zombie processes lying around that may cause unexpected and unpredictable behavior.  In that case, an off-the-shelf supervisor service is best as it is designed to do exactly that.  This process is not recommended.\nIn the vast majority of cases a background process of that sort is better handled using a worker container instead.  See the documentation on how to configure one.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          matthias-van-woensel\n          \n        \n\n        \n            \n            \n              March 24, 2020,  8:34am\n            \n        #3\n        \n      \n      \n        Using a worker is the recommended way of starting more than one process. But if you are not able to use a worker and have no other way, it is technically possible to use supervisord to start multiple processes. Please only use this as a last resort.\nExample of running supervisord to run both PHP and dropboxd\nweb:\n    commands:\n        start: \"supervisord -n -c supervisor.conf\"\n\nsupervisor.conf gets committed to the repository and looks like this:\n[supervisord]\nlogfile=/tmp/supervisord.log\nnodaemon=true\nminfds=1024\npidfile=/tmp/supervisord.pid\n\n[program:php7.2]\ncommand=/usr/sbin/php-fpm7.2-zts\nprocess_name=%(program_name)s\nautostart=true\nautorestart=true\n\n[program:dropbox]\nprocess_name=%(program_name)s\ncommand=/app/.dropbox-dist/dropboxd\nautostart=true\nautorestart=true\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Where do I submit bug reports?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/where-do-i-submit-bug-reports/286", "documentId": "2c0be5c2cabdab76c108ee5942e08034b5df53c4", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Where do I submit bug reports?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              August 13, 2019, 10:58pm\n            \n        #1\n        \n      \n      \n        If I come across a problem working with Platform.sh that seems like a bug, how can I bring it to your attention?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              May 20, 2019,  3:43pm\n            \n        #2\n        \n      \n      \n        Your first response when an unexpected problem occurs with your application should be to open a support ticket through the management console.\nOtherwise, you can join our public Slack channel and bring up your problem to one of the product managers in your message: @timgilmour, @patrickklima\nIf you want to submit a bug report for the Platform.CLI, you can do so by adding an issue to the CLI repository here.\nIf your bug is in the management console, you can submit on our public issue tracker here.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          ralt\n          \n        \n\n        \n            \n              May 19, 2019,  4:16pm\n            \n        #3\n        \n      \n      \n        Note that if you have a security bug to report, please use security@platform.sh.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          timgilmour\n          \n        \n\n        \n            \n              May 20, 2019,  3:23pm\n            \n        #4\n        \n      \n      \n        Also, anything regarding the console, or anything to do with your Platform account (or integrations, etc.), please don\u2019t hesitate to ping me via slack (@timgilmour) directly, or via mention in #console-external.  If you do not have access to that slack channel, hit me up and I will have you added.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "(How) Can I change the \"Code base template\" after purchasing a plan?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-change-the-code-base-template-after-purchasing-a-plan/241", "documentId": "5ea788353115128d71d9da9581053ae63a315564", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  (How) Can I change the \"Code base template\" after purchasing a plan?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          dman\n          \n        \n\n        \n            \n              May 3, 2019,  4:25am\n            \n        #1\n        \n      \n      \n        When starting a new project, I\u2019m not sure which template I should be using, yet I have to commit to choosing one before purchasing my plan.\nCan I try out different templates later under the same plan? How would I do that?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          oripekelman\n          \n        \n\n        \n            \n              May 7, 2019,  7:42am\n            \n        #2\n        \n      \n      \n        Simplest is to delete the project and start over, setting up a project takes a minute. But\u2026 if you really want to do this, nothing complicated:\n\nThe templates live in git and can be found on our public Github account: https://github.com/platformsh?utf8=\u2713&amp;q=template\n\nYour project is just a plain git repository, if you want to start-over, nothing simpler, just clone one of our other templates, add your project\u2019s Platform.sh git repository as a remote, and force push over it.\n\nExample:\ngit clone git@github.com:platformsh/template-flask.git\ncd template-flask\ngit remote rm origin\ngit remote add origin use-the-real-thin-not-this@git.eu.platform.sh:use-the-real-thin-not-this.git\ngit push -f origin\n\nSome notes:\n\nPlease be aware this is very destructive any files, databases etc will most likely be lost forever (well unless you created a snapshot first).\nVariables and other branch configurations may linger on. Also, if the git repo you are pushing over the existing one has the same application name, with the same mount names, or if services have the same name and type the data from the previous setup will still be there which could result in some interesting end-results. So really, just delete the project and create a new one.\n\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          dman\n          \n        \n\n        \n            \n              May 7, 2019,  7:59am\n            \n        #3\n        \n      \n      \n        Thanks, especially for the link directly to the templates in github.\nI figured I could copy &amp; paste the bits from the platform.app.yaml as needed, BUT, it seemed I had to set up and check out a complete dummy project first in order just to see the examples.\nWith the ability to read and compare the templates directly, I can figure this out much quicker now.\nThe additional warnings about other side effects, like branch conflicts, are also helpful, cheers.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I receive a notification if one of my services (eg. MariaDB) dies?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-receive-a-notification-if-one-of-my-services-eg-mariadb-dies/164", "documentId": "6ee75d2b555201f5f844012cefccc3f94b10a69f", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I receive a notification if one of my services (eg. MariaDB) dies?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            monitoring\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              August 13, 2019, 11:00pm\n            \n        #1\n        \n      \n      \n        I\u2019d like to get an alert if a service dies or is unreachable.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              March 28, 2019,  4:37pm\n            \n        #2\n        \n      \n      \n        One way of doing this would be to set up a cron job to periodically ping MariaDB and send an e-mail to a specified address based on that ping status.\nAllow outgoing emails in environment configuration (if necessary)\nEmail support can be set up in each environment, and by default it is already enabled on master and disabled elsewhere. You can enable email through the environment configuration settings in the Web UI, or by using the Platform.sh CLI:\n$ platform environment:info enable_smtp true\n\nYou can find more information about email on Platform.sh in the documentation.\nSet up a cron job in .platform.app.yaml to ping MariaDB\nIn your .platform.app.yaml set up a cron job for the service you want to check the status of. Here an exit code 0 means our ping was successful and MariaDB is running fine.\n# proj_dir/.platform.app.yaml\n...\n\ncrons:\n    # Check MySQL/MariaDB status\n    mysql_status:\n        # Runs every 10 minutes\n        spec: '*/10 * * * *'\n        cmd: |\n            # Pings MySQL/MariaDB, retrieves status message\n            status=$(mysqladmin -h mysql.internal ping)\n            # Saves the exit code\n            check=$?\n            if [ $check = 0 ]; then\n                # Run mail php file, passing service and status message\n                php notifications/service_notify.php --service \"MySQL\" --status \"$status\"\n            fi\n\nrelationships:\n    mysql: \"mysql:mysql\"\n    \n...\n\nIf you named your relationships differently, you will need to modify mysql.internal to the correct name. (For example, database.internal, etc.)\nping() may not be the most robust test case, and is only used here for a simple example. Check the mysqladmin documentation to find the test that best suits your needs.\nWrite a php file that handles mail() for the ping status\nIn the project directory, create a subdirectory called notifications, and within that subdirectory write a service_notify.php file:\n// proj_dir/notifications/service_notify.php\n&lt;?php\n\n// Retrieve opts\n$shortopts  = \"\";\n\n$longopts  = array(\n    \"service:\",\n    \"status:\",\n);\n$options = getopt($shortopts, $longopts);\n\n$service = $options[\"service\"];\n$status = $options[\"status\"];\n\n// Project environment variables\n$projectid = getenv('PLATFORM_PROJECT');\n$environment = getenv('PLATFORM_ENVIRONMENT');\n$app = getenv('PLATFORM_APPLICATION_NAME');\n\n// Mail Contents\n$to      = 'you@example.com';\n$subject = sprintf('Platform.sh Service Status Update: %s DOWN on Project %s', $service, $projectid);\n$headers = 'From: webmaster@example.com' . \"\\r\\n\" .\n    'X-Mailer: PHP/' . phpversion();\n\n// Create the message\n$message = &lt;&lt;&lt;EOT\nThere has been a change in a service status:\n\n    * Service: $service\n\n    * Status: $status\n\n    on\n\n    * Project: $projectid\n\n    * Application: $app\n\n    * Environment: $environment\n\nEOT;\n\n// Send it\nmail($to, $subject, $message, $headers);\n\n?&gt;\n\n\nVerify\nOur project is set up to email you@example.com with the status of a successful ping on mysql.internal every 10 minutes. That status email will look like this.\nwebmaster@example.com\nPlatform.sh Service Status Update: MySQL DOWN on Project &lt;project ID&gt;\nTo: you@example.com\n--------------------------------------------------------------------------\n\nThere has been a change in a service status:\n\n   * Service: MySQL\n\n   * Status: mysqld is alive\n\n   on\n\n   * Project: &lt;project ID&gt;\n\n   * Application: app\n\n   * Environment: master-7rqtwti\n   \n\nSet up MySQL down notifications\nThe preceeding steps send out an e-mail that includes the status message of a successful ping on mysql.internal. That is, it will e-mail us every ten minutes to let us know everything is fine.\nTo modify the notification to let us know that MySQL has died or is unreachable, modify the if statement in .platform.app.yaml cron job to:\n            # If not successful (1)\n            if [ $check != 0 ]; then\n                # Run mail php file, passing service and status message\n                php notifications/service_notify.php --service \"MySQL\" --status \"$status\"\n            fi\n\nThis way, when a ping delivers an exit code of 1, an email is sent!\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Is it possible to run a docker container on Platform.sh?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/is-it-possible-to-run-a-docker-container-on-platform-sh/330/2", "documentId": "2411ba14826ad1ca094352e46230e9a39c2242b8", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Is it possible to run a docker container on Platform.sh?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              July 11, 2019,  9:00am\n            \n        #1\n        \n      \n      \n        I have my own Docker container prepared. Is there any way to pull it from a registry and run it on Platform.sh?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          robert\n          \n        \n\n        \n            \n              July 11, 2019,  9:14am\n            \n        #2\n        \n      \n      \n        Platform.sh doesn\u2019t support running Docker containers or any other container images other than those that are provided and maintained by us. If there are services or configurations that you need to run that we don\u2019t currently support, please open a feature request.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I make custom 404 pages?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-make-custom-404-pages/198", "documentId": "ff169e878b4938b665f8d4747b75759467e34550", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I make custom 404 pages?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            django\n          \n        \n        \n          \n            python\n          \n        \n        \n          \n            pycon2019\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              August 13, 2019, 10:59pm\n            \n        #1\n        \n      \n      \n        I\u2019d like to serve my own HTML for 404 (and other HTTP codes).\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              April 11, 2019,  2:07pm\n            \n        #2\n        \n      \n      \n        You will have to include lines for handling 404 response codes in your application code. In a Python web framework like Django, include it in a views.py file.\nfrom django.shortcuts import render_to_response\nfrom django.template import RequestContext\n\n\ndef handler404(request, exception, template_name=\"404/index.html\"):\n    response = render_to_response(\"404/index.html\")\n    response.status_code = 404\n    return response\n\nand then update urls.py:\nhandler404 = 'my_app.views.handler404'\n\n(Source)\nIn PHP you can include it in your main passthru file in the application directory, index.php. Within that file, you can then point to the custom 404 html file:\nhttp_response_code(404);\nreadfile(\"404/index.html\");\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "What is the difference between a rebuild and a redeploy?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/what-is-the-difference-between-a-rebuild-and-a-redeploy/329", "documentId": "4723893b585d63474b207e5236ab82731291d563", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  What is the difference between a rebuild and a redeploy?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              July 11, 2019,  8:45am\n            \n        #1\n        \n      \n      \n        And, does the platform redeploy command also trigger a rebuild?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          robert\n          \n        \n\n        \n            \n            \n              July 12, 2019,  9:34am\n            \n        #2\n        \n      \n      \n        Build and Deploy are two distinct phases in the Platform.sh pipeline.\n\n\nBuild has the goal of constructing a read-only file system with all of the code, in its final form, that your application needs to run.\n\nDeploy happens only after a successful build, and has the goal of mounting the persistent storage, starting all of the services, and providing the routing between services and the Nginx entry point.\n\nA Build can only be triggered by pushing a change in your code to Git. If your code doesn\u2019t change, no build happens, and the read-only code file system from the previous successful Build will be used.\nYou can trigger a Deploy with the platform redeploy CLI command. You can think of this command as \u201crebooting the server\u201d, since all the app container will be rebooted. Services will be closed for connections in that time, and re-opened when the app container is again ready.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "I need to connect to a VPN endpoint. What are my options?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/i-need-to-connect-to-a-vpn-endpoint-what-are-my-options/236", "documentId": "f36cf3e4e5beb3bbebffb56d13502b789f565120", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  I need to connect to a VPN endpoint. What are my options?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            vpn\n          \n        \n    \n\n\n\n\n  \n      \n        \n          nls\n          \n        \n\n        \n            \n              May 2, 2019,  1:58pm\n            \n        #1\n        \n      \n      \n        I need two types of connections to a server only available through a VPN:\n\nOne is a real-time http call\nThe other is a cron every night that uploads a file to a FTP server.\n\nIs there a way to handle that on Platform.sh ?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              February 7, 2020,  9:01pm\n            \n        #2\n        \n      \n      \n        Platform.sh does not support VPNs for outgoing requests.\nIf you need to issue outbound requests securely, we recommend using an SSH tunnel or HTTPS connection.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Is there a way to do the equivalent of \"screen\" on platform.sh?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/is-there-a-way-to-do-the-equivalent-of-screen-on-platform-sh/252", "documentId": "147376182e52fb14c7ada7a6efad7a6aa6741803", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Is there a way to do the equivalent of \"screen\" on platform.sh?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            import\n          \n        \n        \n          \n            ssh\n          \n        \n        \n          \n            databases\n          \n        \n    \n\n\n\n\n  \n      \n        \n          Gauthier\n          \n        \n\n        \n            \n            \n              May 3, 2019, 10:34pm\n            \n        #1\n        \n      \n      \n        I need to import a lot of data in my database, it\u2019s a very long process.\nWhat can I use since screen or tmux seem to be absent?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              February 7, 2020,  9:09pm\n            \n        #2\n        \n      \n      \n        If you need to operate on the shell, you can open a second SSH terminal to the project.\nIf you need to force a process to the background, that is not currently possible from an SSH login.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I refresh my projects list in Platform CLI?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-refresh-my-projects-list-in-platform-cli/269", "documentId": "889188f39da4e4b85ca98d69ad42f2573060c02a", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I refresh my projects list in Platform CLI?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          travis.raup\n          \n        \n\n        \n            \n              May 8, 2019,  8:27pm\n            \n        #1\n        \n      \n      \n        I have created several new projects and my Platform CLI is not refreshing the list of available projects.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          matthias-van-woensel\n          \n        \n\n        \n            \n              May 9, 2019,  2:12pm\n            \n        #2\n        \n      \n      \n        I had the same issue yesterday.\nIf you simply issue platform it will list your projects, but it won\u2019t refresh them.\nHowever, if you issue platform projects it will refresh\n      \n\n      \n\n      \n         \n         \n         2 Likes\n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          travis.raup\n          \n        \n\n        \n            \n              May 9, 2019,  7:32pm\n            \n        #3\n        \n      \n      \n        Thanks @matthias-van-woensel!\nI can confirm your solution is working.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chevr0sky\n          \n        \n\n        \n            \n            \n              May 13, 2019, 10:01pm\n            \n        #4\n        \n      \n      \n        the same here, can\u2019t figure it out\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          coco-serhey\n          \n        \n\n        \n            \n              July 12, 2019,  4:40pm\n            \n        #5\n        \n      \n      \n        Have you tried platfrom cc to clear CLI caches?\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Can I point my apex (naked) domain to Platform.sh if I'm using Amazon Route 53 to manage DNS?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/can-i-point-my-apex-naked-domain-to-platform-sh-if-im-using-amazon-route-53-to-manage-dns/310", "documentId": "aaa0b7eeb9de18c90af5ab6a5e842bcf4bef59bc", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Can I point my apex (naked) domain to Platform.sh if I'm using Amazon Route 53 to manage DNS?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            dns\n          \n        \n        \n          \n            aws\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              June 7, 2019,  2:54pm\n            \n        #1\n        \n      \n      \n        Route 53 isn\u2019t listed here\u2026 https://docs.platform.sh/golive/steps/dns.html#dns-management-and-apex-domains\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          robert\n          \n        \n\n        \n            \n            \n              June 7, 2019,  2:56pm\n            \n        #2\n        \n      \n      \n        No, Route 53 doesn\u2019t support that, except to a limited number of AWS resources, like ELBs or S3 buckets. More information on Route 53 Alias records here: https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resource-record-sets-choosing-alias-non-alias.html\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I connect an external tool to my database?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-connect-an-external-tool-to-my-database/222", "documentId": "989dc4b5f34089ea01b597fe1f87edd63b83d415", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I connect an external tool to my database?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            credentials\n          \n        \n        \n          \n            databases\n          \n        \n    \n\n\n\n\n  \n      \n        \n          Ovv\n          \n        \n\n        \n            \n            \n              July 11, 2019, 12:16pm\n            \n        #1\n        \n      \n      \n        How would I connect an external tool such as dbeaver / datagrip / \u2026 to my database ?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          tony\n          \n        \n\n        \n            \n              May 2, 2019,  9:32pm\n            \n        #2\n        \n      \n      \n        This is fully supported as long as your application supports connecting over an SSH tunnel. More details here\nTo summarize: connect with your ssh username, typically &lt;project id&gt;-&lt;branch&gt;-&lt;hash&gt;--&lt;app&gt; to your ssh.&lt;region&gt;.platform.sh. From there, your database host will be for example database.internal and your credentials are user and an empty password, if you haven\u2019t modified your db service before.\nAnother way is using platform tunnel to create tunnels to your services and then accessing them via a localhost:port combination. This is spelled out in more detail in our Docs as well.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "What is the different between Platform.sh and Terraform?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/what-is-the-different-between-platform-sh-and-terraform/342", "documentId": "7897bdad2279587dc9ad55fa22a8cd7386ab4486", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  What is the different between Platform.sh and Terraform?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n              July 15, 2019, 12:20pm\n            \n        #1\n        \n      \n      \n        What is the different between Platform.sh and Terraform?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              August 2, 2019,  1:34pm\n            \n        #2\n        \n      \n      \n        Platform.sh and Terraform are similar in that they both subscribe to the idea of \u201cinfrastructure as code\u201d.\nDevelopers on Platform.sh use a collection of YAML files that define the behavior of their application (how it builds and deploys), its services, and its routes. Since configuration is written in files, they can be version controlled such that changes to infrastructure can be tracked and observed over time as the application evolves.\nWhat these files contain is different because Platform.sh is a Platform as a Service provider, whereas Terraform is a tool for provisioning resources with an Infrastructure as a Service (IaaS) provider like AWS and Azure. Learning everything you need to know to manage each resource on an IaaS your applications depend on is a lot of work, and Platform.sh and Terraform provide different solutions to that problem.\nIf you want to deploy a Drupal application on Platform.sh, you would take an existing code base and include the three configuration YAML files that tell Platform.sh\n\nhow to build and deploy it\nwhat services it relies upon\nhow it should handle incoming requests to the application\n\nYou push to Platform.sh, and a remote repository is created that contains both the application code and its configuration files. In this way, Platform.sh ties the histories of both your application and your infrastructure into a single commit history. Once you have configured those files correctly, you\u2019re ready to go. Even if you\u2019re on a region that is actually deploying to Amazon AWS, you never have to have known that to get started. This abstraction makes it so developers can deploy on Platform.sh, because we do all the heavy lifting to keep it running on an IaaS elsewhere.\nTerraform is very different. It does not host your application code, but is rather a tool to help you host it somewhere else. It has a collection of configuration files, but those files don\u2019t refer to the application itself - how it should be built or what needs write access - at all. Those files also do not need to exist in the same repository as your application, but are often kept in a separate Git repository so that a commit history of your infrastructure can still be observed.\nThe content of the files themselves focus purely on how infrastructure should be provisioned on an IaaS, using a common syntax that communicates with AWS\u2019s (or Azure\u2019s, etc.) API in order to do so. Because of this, developers do not deploy on Terraform - they can download Terraform and use it as an abstraction tool so that they can deploy directly on an IaaS themselves more easily.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Is it possible to run a docker container on Platform.sh?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/is-it-possible-to-run-a-docker-container-on-platform-sh/330", "documentId": "86367986bb5fefdc7b1dcb16f4fefddc28034044", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Is it possible to run a docker container on Platform.sh?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              July 11, 2019,  9:00am\n            \n        #1\n        \n      \n      \n        I have my own Docker container prepared. Is there any way to pull it from a registry and run it on Platform.sh?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          robert\n          \n        \n\n        \n            \n              July 11, 2019,  9:14am\n            \n        #2\n        \n      \n      \n        Platform.sh doesn\u2019t support running Docker containers or any other container images other than those that are provided and maintained by us. If there are services or configurations that you need to run that we don\u2019t currently support, please open a feature request.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I move a Wordpress site to Platform.sh?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-move-a-wordpress-site-to-platform-sh/271", "documentId": "b55b4929da154efd6f3dddec1d3cc95265777a97", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I move a Wordpress site to Platform.sh?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            wordpress\n          \n        \n        \n          \n            migration\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              July 18, 2019,  9:50am\n            \n        #1\n        \n      \n      \n        I have an existing installation of Wordpress with my old hoster, how can I move everything to Platform.sh?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          drag0un1\n          \n        \n\n        \n            \n              May 14, 2019, 10:48pm\n            \n        #2\n        \n      \n      \n        I have the same problem to\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          zendoodles\n          \n        \n\n        \n            \n            \n              May 29, 2019,  4:30pm\n            \n        #3\n        \n      \n      \n        Wordpress is one of our Featured Frameworks, and migration is generally a snap with the instructions for migration in the  documentation. The only thing specific to Wordpress should be the details of the Platform.sh configuration files.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "My project has exceeded its cpu limit. What do I do?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/my-project-has-exceeded-its-cpu-limit-what-do-i-do/288", "documentId": "ec82c5491270f6b18a23ad76ece5f6b3ec6a624f", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  My project has exceeded its cpu limit. What do I do?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            plan-limit\n          \n        \n        \n          \n            allocation\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              July 15, 2019,  2:56pm\n            \n        #1\n        \n      \n      \n        I received the below error when trying to deploy:\nE: Error: Resources exceeding plan limit; cpu: 1.00 &gt; 0.96; try removing a service, or increase your plan size\n\nWhat does that error mean? It appears to indicate that my project has exceeded its cpu plan limit. How would I increase this and how do I know what my cpu limit is?\nThank you!\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n            \n              May 22, 2019,  5:21pm\n            \n        #2\n        \n      \n      \n        That relates to how we allocate project resources, and is a bit involved.\nThere is your plan size, and then there\u2019s your container size.\n\nEach container (your application, a Solr instance, a DB instance, etc.) comes in one of a fixed number of sizes: S, M, L, XL, which correspond to \u201cI need at least X much CPU and Y much RAM\u201d.\nYour plan also comes in its own S, M, L, XL, 2XL sizes, which mean \u201cI have this much total CPU and RAM\u201d.\n\nOn a Development environment (anything but master), the plan size is irrelevant and all containers are created as size Small (S).  Development environments only have 1-2 users in practice so giving them any more resources is a waste 99% of the time.\nOn Production (master, with a domain attached), the system will give you the largest set of containers whose CPU and RAM \u201cask\u201d will fit within the available CPU and RAM on the plan.  The more apps and services you have, the smaller each one is likely to be.  You can also specify a specific size for a certain app or service using the size key in .platform.app.yaml or services.yaml, which may result in other containers being larger or smaller than they would be on their own.  See the documentation for more on that attribute.\nThe end of the deploy log includes a list of what containers were created and what container size each one is using.\nIf the system cannot fit a Small version of each container within the plan\u2019s available resources, some version of the above error will be shown.  That means the containers you are trying to deploy are, in aggregate, asking for more CPU and RAM than your plan allows for.\nSo for example if your plan includes 3 GB of RAM, but your application and services are, in total, asking for 3.5 GB of RAM, you will get an error.\nThe possible solutions are:\n\nIf you have an explicit size set, try reducing it.  (Ask for fewer resources.)\nReduce the number of containers you have. Note that a worker application counts as another container.  (Have fewer containers asking for resources).\nIncrease your plan size.  (Give it more resources to split up between containers.)\n\nNote that the specific RAM and CPU size that each container asks for is not a fixed number but a soft-capped range, so we do not release specific numbers.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "My project looks to be out of storage. How do I add more?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/my-project-looks-to-be-out-of-storage-how-do-i-add-more/261", "documentId": "3b8e0d7df84e5fd970184bba4ea81b492c9ccd6c", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  My project looks to be out of storage. How do I add more?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            storage\n          \n        \n    \n\n\n\n\n  \n      \n        \n          omurphy\n          \n        \n\n        \n            \n              May 6, 2019,  1:57pm\n            \n        #1\n        \n      \n      \n        I received the following error when git pushing to my environment:\nE: Error: Resources exceeding plan limit; disk: 31192.00 &gt; 30720.00; try removing a service, or add more storage to your plan\n\nIt suggests that I add more storage to my plan. How do I do that? Also, what does it mean by removing a service?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              May 6, 2019, 10:27pm\n            \n        #2\n        \n      \n      \n        \nIt suggests that I add more storage to my plan. How do I do that?\n\nOne way you can add more storage to your project is through the management console.\nVisit the accounts page. In the top right hand corner of the project in question click on the three vertical dots and select Edit - you can also reach these settings from with in a project on the console by clicking the button Edit plan on the project\u2019s main page.\nThe console will then show you the state of your current plan - the plan size, the number of environments, the number of users, and the amount of storage that is available in each environment. You can click the drop down for the current storage and select a larger amount. When you are finished, click Update plan. This will trigger a redeployment of your project so that your changes are updated.\nKeep in mind that while the management console supports increasing the amount of storage provided for each project environment, it will not allow you to decrease that amount after the fact without opening a support ticket, so increase the storage by one increment at a time and redeploy to see if that fixes your issue.\n\nAlso, what does it mean by  removing a service?\n\nThe amount of storage available in an environment is shared across your services according to how you have configured it to do so in your .platform.app.yaml and .platform/services.yaml files. Removing a service would free up whatever storage it was using and become available to the remaining services as a result.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I access to an environment variable in Javascript?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-access-to-an-environment-variable-in-javascript/251", "documentId": "89fc55c7727e8598dca3963bdce3cb5368190898", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I access to an environment variable in Javascript?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            env-variables\n          \n        \n    \n\n\n\n\n  \n      \n        \n          Gauthier\n          \n        \n\n        \n            \n            \n              July 11, 2019, 12:17pm\n            \n        #1\n        \n      \n      \n        I would like to insert my Hotjar Identifier only on certain environments. How can I do that?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              May 6, 2019, 10:43pm\n            \n        #2\n        \n      \n      \n        Add the variable using the CLI\nYou can add an environment variable to a specific environment using the Platform.sh CLI.\nIn your local repository, type the command platform variable:create. The CLI will then take you through the steps to configure the variable.\n\n\nLevel: Since you want the variable to be visible only to specific environments, type environment.\n\nEnvironment: Name the environment you want the variable to be visible to (i.e. updates).\n\nName: Name the variable, which in your case might be HOTJARID.\n\nValue: Assign a value for HOTJARID, like the string 'some-value'.\n\nJSON: Tell the CLI whether or not the value is JSON formatted.\n\nSensitive: If you do not want anyone to be able to SSH into the application container and view the value of this variable, choose y.\n\nPrefix: For environment variables, choose the prefix env:.\n\nEnabled: Enable the variable.\n\nInheritable: If you would only like the variable to be visible to this current branch, choose n. On the other hand, if you plan on creating children of this branch that will also need access to HOTJARID, choose y instead.\n\nWhen you have completed these options, the CLI will create the new variable and redeploy your environment to reflect the changes.\nCreating variable env:HOTJARID on the environment updates\n+----------------+---------------------------+\n| Property       | Value                     |\n+----------------+---------------------------+\n| id             | env:HOTJARID              |\n| created_at     | 2019-05-06T18:15:49-04:00 |\n| updated_at     | 2019-05-06T18:15:49-04:00 |\n| name           | env:HOTJARID              |\n| attributes     | {  }                      |\n| value          | 'some-value'              |\n| is_json        | false                     |\n| project        | wiqte7at4yg22             |\n| environment    | updates                   |\n| inherited      | false                     |\n| is_enabled     | true                      |\n| is_inheritable | false                     |\n| is_sensitive   | false                     |\n| level          | environment               |\n+----------------+---------------------------+\nWaiting for the activity p67lnusorjsts (Chad Carlson added variable env:HOTJARID to environment updates):\n    Building application 'app' (runtime type: php:7.1, tree: efd651e)\n      Reusing existing build for this tree ID\n    \n    Provisioning certificates\n      Environment certificates\n      - certificate f4a5030: expiring on 2019-08-04 18:31:01+00:00, covering {,www}.updates-gv2zwpa-wiqte7at4yg22.eu-3.platformsh.site\n    \n    \n    Redeploying environment updates\n    Environment configuration\n        app (type: php:7.1, size: S, disk: 2048)\n        mysqldb (type: mysql:10.2, size: S, disk: 2048)\n    \n      Environment routes\n        http://updates-gv2zwpa-wiqte7at4yg22.eu-3.platformsh.site/ redirects to https://updates-gv2zwpa-wiqte7at4yg22.eu-3.platformsh.site/\n        http://www.updates-gv2zwpa-wiqte7at4yg22.eu-3.platformsh.site/ redirects to https://www.updates-gv2zwpa-wiqte7at4yg22.eu-3.platformsh.site/\n        https://updates-gv2zwpa-wiqte7at4yg22.eu-3.platformsh.site/ is served by application `app`\n        https://www.updates-gv2zwpa-wiqte7at4yg22.eu-3.platformsh.site/ redirects to https://updates-gv2zwpa-wiqte7at4yg22.eu-3.platformsh.site/\n  [============================] 8 secs (complete)\nActivity p67lnusorjsts succeeded\n\nYou can also combine these configurations into a single CLI command:\nplatform variable:create --level environment --environment updates --name HOTJARID --value 'some-value' --json false --sensitive false --prefix 'env:' --enabled true --inheritable false\n\nAdd the variable using the management console\nAlternatively you can go through the same configuration from within the management console:\n\nFrom your project, click on the (parent) environment you want the variable to be exposed to.\nClick the Settings link at the top of the page, and then the Variables tab on the sidebar of the next page.\nClick the Add + button at the top of the page.\nFill out the forms to configure your variable, and when complete click Add variable.\n\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Log location? dblog or syslog?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/log-location-dblog-or-syslog/210", "documentId": "7dd76d7b14743be93182cd7c0719de1730c96f74", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Log location? dblog or syslog?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            logs\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              April 19, 2019, 12:08am\n            \n        #1\n        \n      \n      \n        I\u2019m not sure where to find Drupal logs with syslog on, and I couldn\u2019t find any info as to whether platform recommends/cares Re: syslog vs dblog.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          zendoodles\n          \n        \n\n        \n            \n              April 16, 2019,  6:05pm\n            \n        #2\n        \n      \n      \n        We do not currently support syslog. Unfortunately the binary which the Drupal syslog module relies on is not available, so enabling syslog in your Drupal instance will mean your logs have nowhere to go.\nIn general, application logs (outside of Drupal) are added to /var/log/app.log, and you can see most anything in /var/log/{$logname}.log with the cli command platform log {$logname}. You\u2019ll find more information about the various log files in our developer documentation.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Transferring backups from P.sh to S3", "section": "Questions & Answers", "url": "https://community.platform.sh/t/transferring-backups-from-p-sh-to-s3/215", "documentId": "72fd66aebf1b6342ebc55e4360eba2a53e9f0c48", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Transferring backups from P.sh to S3\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          scotthooker\n          \n        \n\n        \n            \n              April 18, 2019,  8:35pm\n            \n        #1\n        \n      \n      \n        I think this would make a good how to guide.\nAsking here first. I understand I can install s3cmd or aws-cli. Is there any examples kicking around?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          ralt\n          \n        \n\n        \n            \n              May 23, 2019,  2:43pm\n            \n        #2\n        \n      \n      \n        Do you mean backups taken by the \u201cBackup\u201d button in the UI, or something you would do manually with mysqldump and rsync?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          scotthooker\n          \n        \n\n        \n            \n              May 23, 2019,  4:06pm\n            \n        #3\n        \n      \n      \n        I\u2019m not sure of the format of the P.sh backup. But I assume (like mine) some clients have a need to store backups within their own infra or own specified location. So in my case I mean the database and files dumped and rsynced respectively over to S3 or wherever.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              May 29, 2019,  3:34pm\n            \n        #4\n        \n      \n      \n        See: How to sync database backups to Amazon S3\nI was able to transfer my PostgreSQL dumps to S3 doing the following:\n\nCreate sensitive variables for my AWS credentials\n\nplatform variable:create --level=project --name=AWS_ACCESS_KEY_ID --value=&lt;KEY_ID&gt; --json=false --sensitive=true --prefix=env --visible-build=true --visible-runtime=true\nplatform variable:create --level=project --name=AWS_SECRET_ACCESS_KEY --value=&lt;ACCESS_KEY&gt; --json=false --sensitive=true --prefix=env --visible-build=true --visible-runtime=true\n\n\nSince PostgreSQL comes with a default password main, I created another sensitive environment variable PGPASSWORD to set up the dump cron job\n\nplatform variable:create --level=project --name=PGPASSWORD --value=main --json=false --sensitive=true --prefix=env --visible-build=true --visible-runtime=true\n\n\nI created a mount to save the dumps to in my .platform.app.yaml\n\n\nmounts:\n    'backups':\n        source: local\n        source_path: backups\n\n\nInstalled the awscli in my build hook\n\n        if [ ! -z \"$AWS_ACCESS_KEY_ID\" ] &amp;&amp; [ ! -z \"$AWS_SECRET_ACCESS_KEY\" ]; then\n            pip install futures\n            pip install awscli --upgrade --user 2&gt;/dev/null\n        fi\n\n\nCreated a cron job that called my forwarding script restricted to master\n\n\ncrons:\n    dumps_to_s3:\n        spec: '*/15 * * * *'\n        cmd: |\n            if [ \"$PLATFORM_BRANCH\" = master ]; then\n                ./cron/forward_dumps_s3.sh\n            fi\n\n\nThen included a script to perform the dumps and AWS syncs every 15 minutes\n\n#!/usr/bin/env bash\n\nTODAY_DATE=$(date +%Y-%m-%d-%H:%M:%S)\nDUMP_FILE=${TODAY_DATE}-DUMP.sql\n\nDB_HOST=\"database.internal\"\nDB_PORT=5432\nDB_USER=\"main\"\nDUMP_LOC=\"backups\"\n\nAWS_BUCKET=&lt;your bucket name&gt;\nAWS_FOLDER=&lt;bucket folder name&gt;\n\npg_dump --host=$DB_HOST --port=$DB_PORT --username=$DB_USER --file=$DUMP_LOC/$DUMP_FILE\n\naws s3 sync ~/$DUMP_LOC s3://$AWS_BUCKET/$AWS_FOLDER/\n\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to use FTP to upload files?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-to-use-ftp-to-upload-files/253", "documentId": "85b620c6a6f3f49894534bc65b887209e6b3638b", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to use FTP to upload files?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          mrkschan\n          \n        \n\n        \n            \n              May 6, 2019,  2:00am\n            \n        #1\n        \n      \n      \n        I want to upload a large amount of files to my production environment, how could I use FTP to upload them?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    Can I get a dedicated FTP/SFTP account for access to a specific directory?\n                  \n                \n          \n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              May 15, 2019,  4:56pm\n            \n        #2\n        \n      \n      \n        If the files are part of your application (that is, they are \u201ccode\u201d and not \u201cdata\u201d), they should be pushed through Git commits like any other file changed.\nIf the files are data, then you can upload them using SFTP (Secure FTP) or rsync to one of the writeable mounts defined in your .platform.app.yaml file.  If you want to sync the entire mount\u2019s file set you can also use the platform mount:upload command.\nSee the documentation for details on each option.\nPlain FTP is inherently insecure and is not available anywhere.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How do I access my .git directory from within my app?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-do-i-access-my-git-directory-from-within-my-app/349", "documentId": "f0c4ccf15b58d128a9d66f753e228306ee055e42", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How do I access my .git directory from within my app?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              July 18, 2019,  4:54am\n            \n        #1\n        \n      \n      \n        I want to be able to access the commit hash and timestamp of the current state of my project, but I don\u2019t see a .git repository when I SSH in to my application. How can I access the information stored in .git?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          nick\n          \n        \n\n        \n            \n            \n              July 18, 2019,  4:59am\n            \n        #2\n        \n      \n      \n        Platform.sh doesn\u2019t provide direct access to your .git repository, but there are still a few methods you can use to access that information from your application.\nGet the commit hash of your current work tree\nAlthough the commit hash of the state of your project isn\u2019t available to your application directly, it is still possible to figure it out using the PLATFORM_TREE_ID environment variable that is provided to your application and our CLI tool.\n\nWARNING: This method is provided only as a proof of concept. Please be sure to thoroughly test your implementation of this method before putting it into production.\n\nConfigure dependencies\nFirst, you\u2019ll need to configure an environment variable to pass your API token to the build process. In your project settings (not the settings for any individual environment), add an environment variable to contain your API token:\n\nimage.png2278\u00d71700 190 KB\n\nSet the name to env:PLATFORMSH_CLI_TOKEN, mark it as sensitive, and indicate that you want it to be available during the build process but not the runtime.\nThis proof-of-concept method has two dependencies: the Platform.sh CLI and the jq command line tool for parsing JSON objects. We can install both in the build hook by adding these lines:\ncurl -sS https://platform.sh/cli/installer | php\nwget -q https://github.com/stedolan/jq/releases/download/jq-1.6/jq-linux64 -O jq\nchmod +x jq # Make jq executable\n\nTalking with the API\nCreate a new file called get-commit.sh in the root directory of your application, and paste in the script below. Make sure to make the script executable with chmod +x get-commit.sh.\n#!/usr/bin/env bash\n\n${PLATFORM_APP_DIR}/.platformsh/bin/platform p:curl -X GET activities | \\\n${PLATFORM_APP_DIR}/jq -r \\\n    --arg tree ${PLATFORM_TREE_ID:0:7} \\\n    --arg app ${PLATFORM_APPLICATION_NAME} \\\n    '.[] |\n        select(.type == \"environment.push\") |\n        select(.log | (contains(\"tree: \" + $tree))) |\n        [0] | .payload.commits | .[0].sha\n    '\n\nThe above script makes a call to the activities API endpoint for the project in which this script is being run and extracts a commit hash from the results. Let\u2019s break it down:\n\n\n.[] | \u2013 This command iterates over the array of results and pipes each object to the next command.\n\n\nselect(.type == \"environment.push\") | \u2013 This selects the subset of activity entries that are Git push events.\n\n\nselect(.log | (contains(\"tree: \" + $tree))) | \u2013 This takes the log key from each event entry and checks to see if it has the string tree: $tree contained within, where $tree is the first seven characters of $PLATFORM_TREE_ID. The\n\n\n[0] | .payload.commits | .[0].sha \u2013 This line takes the first matching event and returns the SHA hash of the most recent commit.\n\n\nFinal build hook\nCall get-commit.sh from your build hook and output the result to a file called .commit, like so:\nhooks:\n    build: |\n      # Other commands omitted for space\n\n      # Dependencies for getting the current commit\n      curl -sS https://platform.sh/cli/installer | php\n      wget -q https://github.com/stedolan/jq/releases/download/jq-1.6/jq-linux64 -O jq\n\n      # Make the script executable\n      chmod +x jq\n\n      # Output the commit hash to a file\n      ./get-commit.sh &gt; .commit\n\n      # If you don't need `jq` for anything else, you can remove it\n      rm jq\n\nThis method should work reliably because the .commit file is only updated during the build hook. Thus, if you have multiple apps in one project, only apps that have code changes with each commit will be rebuilt, making the contents of the .commit file permanently associated with the correct commit.\nWithout dependencies\nAs mentioned above, this example is only a proof-of-concept. It is also possible to query the Platform.sh API directly without the CLI tool, and you can process the JSON results with any tool or language that you prefer.\nAdding a .git repo for other tools to use\nSome tools, such as a static site generator like Hugo, can parse the information contained within the .git directory and use it to determine when pages were last updated, who has edited a page, etc. For this use case, you\u2019ll need more than just the commit hash.\nIf you want to have access to that information in your application, you can clone the repository that is being used to build the application and extract the .git repo from there.\nIn your .platform.app.yaml file:\nhooks:\n    build: |\n      # Optionally, the contents from the build hook in the previous section\n      # . . .\n\n      # Clone the repository for the current project\n      git clone git@github.com:YOUR-NAME/YOUR-REPOSITORY.git .repo\n\n      # Optionally, set the working state of the repository to the current commit\n      cd .repo\n      git reset --hard $(cat ${PLATFORM_APP_DIR}/.commit)\n      cd ..\n\n      # Move the .git repo into the root directory of the app, and delete the old working tree\n      mv .repo/.git .\n      rm -rf .repo\n\nNow any tools you want to use can process this repository as if it were any other working tree containing a .git directory.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          nick\n          \n            listed \n        \n\n        \n            \n              July 18, 2019,  2:44pm\n            \n        #4\n        \n      \n      \n        \n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          hugo\n          \n        \n\n        \n            \n              February 18, 2020,  8:17am\n            \n        #5\n        \n      \n      \n        Hi,\n8 months have passed, is there an easy way to access our .git directory within an app, or we still should do this? \nThanks \n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Using platform.sh environments for continuous integration / functional tests", "section": "Questions & Answers", "url": "https://community.platform.sh/t/using-platform-sh-environments-for-continuous-integration-functional-tests/386", "documentId": "53555ba2b50a9165c3b782e05c8ca25cfa9eb159", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Using platform.sh environments for continuous integration / functional tests\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          daniel\n          \n        \n\n        \n            \n              September 9, 2019,  6:45am\n            \n        #1\n        \n      \n      \n        What would the pros / cons of using platform to run integration / functional tests, instead of a typical Continuous Integration service? And is using platform to run functional tests possible / a bad idea?\nMy thinking is this:\n\nUnit tests, static analysis, code linting etc. are easy to run in isolation, so that should remain in a typical CI environment\nFunctional tests require a functioning environment, which platform.sh can automatically provide\nSometimes you want to run your functional tests against production data, which is also something platform.sh can automatically provide\n\nAn example implementation could be:\n\nOn build, detect if this is an environment you want to run tests in (eg. non-production, pull request environment etc.)\nInstall any tools you need to run functional tests (eg. a headless browser and testing framework)\nRun the tests \u2013 fail the build if the tests fail\nSend notification of the passed/failed build (I think the standard github pull request integration would report this back, but I\u2019m not sure \u2013 an email or slack notification could be sent)\n\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              February 7, 2020,  8:12pm\n            \n        #2\n        \n      \n      \n        Hi Daniel.\nThe build environment is branch-agnostic.  Since build images can be reused on multiple branches there\u2019s no way to detect the branch during build.\nThis is not something we currently support directly; you can run unit tests (that do not require access to the database) during build.  More on that here: How to fail a build on failing unit tests\nFor end to end tests, you would need to ensure the tools are installed in all environments.  Then in a post_deploy hook, check if you\u2019re on a branch where you want to run tests (at minimum, non-master), and run whatever commands you need.  It\u2019s better to do in post_deploy than deploy because deploy blocks the environment being publicly accessible, which  may be necessary depending on the nature of your tests.\nThe report-back in case of failure is the big challenge.  At present we have no mechanism available to do that.  If you have some external notification system that can accept a webhook, you can have your test code ping that URL when it\u2019s done.  We have no built-in support for it at this time, though.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "My plan has 10GB of storage. How can I see precisely how much I am using?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/my-plan-has-10gb-of-storage-how-can-i-see-precisely-how-much-i-am-using/158", "documentId": "1571c1a28632a4dbab43e2007fed5e9e64027e28", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  My plan has 10GB of storage. How can I see precisely how much I am using?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            storage\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              August 13, 2019, 10:58pm\n            \n        #1\n        \n      \n      \n        I know that some is used by my services, and some is used by the disk directive in .platform.app.yaml. Is there a way to see how much is being used from the 10GB total that my project has?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              March 26, 2019,  4:04pm\n            \n        #2\n        \n      \n      \n        SSH into a project environment\n$ platform ssh\n\nIf you are not in the project directory where Platform.sh is set as remote (platform project:set-remote) follow the CLI instructions to access the project you want.\nCheck the disk storage of the project\n$ df -H\nFilesystem                                       Size  Used Avail Use% Mounted on\n/dev/loop21                                      502M  502M     0 100% /\ntmpfs                                             13k     0   13k   0% /dev\ntmpfs                                            5.3M     0  5.3M   0% /dev/shm\ntmpfs                                             53M  263k   53M   1% /run\n/dev/loop69                                       31M   31M     0 100% /app\n/dev/mapper/7iraodzyabnamgtvhuic5q6i34           512M   20M  501M   4% /mnt\n/dev/mapper/platform-udos4pvcpyklbaxontkaeuwgmy  4.3G   39M  4.3G   1% /tmp\n/dev/mapper/platform-lxc                         336G   19G  300G   6% /run/shared\n\nCalculate\nThis is a small project on a \u201cMedium\u201d Platform.sh plan, which comes with 5 GB of storage per environment. Not including the last line of output, the two /dev/mapper/*\n/dev/mapper/7iraodzyabnamgtvhuic5q6i34           512M   20M  501M   4% /mnt\n/dev/mapper/platform-udos4pvcpyklbaxontkaeuwgmy  4.3G   39M  4.3G   1% /tmp\n\nare the parts of the environment that are counted against this cap. The first line is dictated by the amount of disk allocated to mounts in .platform.app.yaml. In this case\n.020 + .039 = 0.059\n\n0.059 GB of the available storage is currently being used.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          oripekelman\n          \n        \n\n        \n            \n            \n              April 16, 2019,  4:32pm\n            \n        #3\n        \n      \n      \n        Your plan has a maximum amount of storage you can get with  platform project:info subscription.storage  the answer is in MB.\nYou distribute that total storage between your apps and your services by specifying  the disk key of your .yaml files.\nIf like me you like bash one liners, here you go :\nfind . -type f -name '.platform.app.yaml' -o -name 'services.yaml' |xargs grep disk:\nExecuted at the root of your project will give how you distributed your storage.\n.\nYou can redistribute storage between your different apps and services, and you can upsize the size of the global storage.\nNow, if you want to know for a specific app how much of the allocated is still free\u2026 you can use the CLI to get the \u201creal usage\u201d of each app. Short and sweet:\nplatform mount:size\nWhich directly gives you :\n\nLastly, you really want to also to add yourself a notification if ever you are running low on space:  platform integration:add --type=\"health.email\" --recipients=\"myemail@example.com\" will do the trick.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          tony\n          \n        \n\n        \n            \n              April 16, 2019,  4:18pm\n            \n        #4\n        \n      \n      \n        Similar to what @oripekelman said platform db:size can give you your database storage, with the caveat it may not be 100% accurate\nChecking database service mysqldb...\n+--------------+--------+\n| Property     | Value  |\n+--------------+--------+\n| max          | 2048MB |\n| used         | 22MB   |\n| percent_used | 1%     |\n+--------------+--------+\n\nWarning\nThis is an estimate of the database's disk usage. It does not represent its real size on disk.\n\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Can I use Platform.sh for a different language?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/can-i-use-platform-sh-for-a-different-language/237", "documentId": "d20da0a45699e4769f2abd9642867a4d4f4f194b", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Can I use Platform.sh for a different language?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          matthias-van-woensel\n          \n        \n\n        \n            \n              May 2, 2019,  1:59pm\n            \n        #1\n        \n      \n      \n        We can use PHP, NodeJS, Go, and more.\nBut my favorite language is not there. How do I add a new language (e.g. Erlang, Elixir, \u2026) ?\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              May 6, 2019, 10:04pm\n            \n        #2\n        \n      \n      \n        If Platform.sh does not currently a runtime container for your language, you will have to install it during the build hook inside your .platform.app.yaml file.\nA good example of how you can do this has been published as a How-to for deploying a Rust application on Platform.sh. Pay special attention to the build hook Step 2 and modify accordingly for your language.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Using a custom certificate and LetsEncrypt certificates on the same project?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/using-a-custom-certificate-and-letsencrypt-certificates-on-the-same-project/361", "documentId": "70aed820989217c732e6aa420753cddd909b0584", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Using a custom certificate and LetsEncrypt certificates on the same project?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            letsencrypt\n          \n        \n        \n          \n            certificates\n          \n        \n        \n          \n            ssl\n          \n        \n        \n          \n            tls\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              July 23, 2019, 10:04am\n            \n        #1\n        \n      \n      \n        Is it possible to use a custom SSL certificate just for a specific domain, and use the autogenerated one for all other domains on the same project?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          e.karisch\n          \n        \n\n        \n            \n            \n              July 24, 2019,  9:20am\n            \n        #2\n        \n      \n      \n        If the custom certificate SAN/CN matches the custom specific domain, the custom certificate is preferred over autogenerated Let\u2019s Encrypt certificates.\nOne exception is at the end of the custom certificate validity, where a Let\u2019s Encrypt certificate is generated in the background to replace the custom certificate if it isn\u2019t renewed.\nIf a wildcard custom certificate is upload, it will always be preferred for all domains matching the wildcard SAN/CN and not only a specific subdomain under the wildcard.\n      \n\n      \n\n      \n         \n         \n         2 Likes\n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Does Platform.sh support subdomains and Let's Encrypt for them?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/does-platform-sh-support-subdomains-and-lets-encrypt-for-them/200", "documentId": "68c9060e578bf27c4b98f01582d6c9877dd4c3a8", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Does Platform.sh support subdomains and Let's Encrypt for them?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              August 13, 2019, 10:58pm\n            \n        #1\n        \n      \n      \n        I\u2019m looking to add 500+ subdomains to my application on Platform Professional. How do I set them up in my routes.yaml file? Is there a limit to the number of subdomains I can add there? How do I set up certificates for them?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              April 17, 2019,  1:43pm\n            \n        #2\n        \n      \n      \n        While Platform.sh does support wildcard routes to generate the number of subdomains you are looking for, we do not currently support Let\u2019s Encrypt for those wildcards.\nTo create the wildcards, you can simply prefix the route with a star ( * ), for example  *.{default} , and HTTP request to  www.{default} ,  blog.{default} ,  us.{default}  will all get routed to the same endpoint.\nAs for certificates, Platform.sh does support custom certificates, such as a Comodo SSL wildcard certificate.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          jgrubb\n          \n        \n\n        \n            \n              April 18, 2019,  7:42pm\n            \n        #3\n        \n      \n      \n        Hi, yes there is a limit and to know what the limit is requires diving into implementation details a bit.\nThe way that platform.sh manages certain aspects of configuration within the application containers is with environment variables.  You are probably familiar with the PLATFORM_RELATIONSHIPS variable used to set up connection strings for that environments database, etc but there is another variable named PLATFORM_ROUTES that is essentially a JSON representation of your environments routes.  It\u2019s base64 encoded just like the RELATIONSHIPS variable, so decoded it looks something like this -\nweb@35ztu3ywra3e7usbmuowjb6nim:~$ echo $PLATFORM_ROUTES | base64 -d | json_pp\n{\n   \"http://www.feature-sidebar-um4m5by-26w5v7umv77iu.us-2.platformsh.site/\" : {\n      \"original_url\" : \"http://www.{default}/\",\n      \"id\" : null,\n      \"to\" : \"https://www.feature-sidebar-um4m5by-26w5v7umv77iu.us-2.platformsh.site/\",\n      \"primary\" : false,\n      \"restrict_robots\" : true,\n      \"type\" : \"redirect\",\n      \"http_access\" : {\n         \"basic_auth\" : {},\n         \"addresses\" : []\n      }\n   },\n   \"https://feature-sidebar-um4m5by-26w5v7umv77iu.us-2.platformsh.site/\" : {\n      \"restrict_robots\" : true,\n      \"original_url\" : \"https://{default}/\",\n      \"primary\" : false,\n      \"http_access\" : {\n         \"basic_auth\" : {},\n         \"addresses\" : []\n      },\n      \"attributes\" : {},\n      \"type\" : \"redirect\",\n      \"tls\" : {\n         \"min_version\" : null,\n         \"client_authentication\" : null,\n         \"client_certificate_authorities\" : [],\n         \"strict_transport_security\" : {\n            \"include_subdomains\" : null,\n            \"preload\" : null,\n            \"enabled\" : null\n         }\n      },\n...\n\nSo here\u2019s the deal - there is a limitation to how large a Linux environment variable can be. The more routes (domains) you add to your project, the larger this variable will be.  It\u2019s kind of impossible for me to say exactly how many domains it can fit because it\u2019s really more about \u201chow many bytes does this string take up?\u201d but I think 500 is probably going to be over the limit.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "What does \"WARNING: [pool web] server reached max_children setting (2), consider raising it\" mean?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/what-does-warning-pool-web-server-reached-max-children-setting-2-consider-raising-it-mean/240", "documentId": "b1d72cefd474e51808021a2045ae597d95488f52", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  What does \"WARNING: [pool web] server reached max_children setting (2), consider raising it\" mean?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          bradhomer\n          \n        \n\n        \n            \n              May 2, 2019,  3:39pm\n            \n        #1\n        \n      \n      \n        I keep seeing this in my site logs. Does this mean my site is down? How do I raise the max_children setting?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          jared-wright\n          \n        \n\n        \n            \n              May 7, 2019,  6:47am\n            \n        #2\n        \n      \n      \n        WARNING: [pool web] server reached max_children setting means your service has reached the maximum number of PHP children processes. This is caused by too many PHP requests to the service or by long running/stuck PHP requests. This may also result in 503 errors in your web application.\nPlease read through our PHP-FPM documentation to explain the issue in more detail. This documentation also provides a way to check your applications memory usage and adjust the max_children allocation.\nhttps://docs.platform.sh/languages/php/fpm.html\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How can I forward my logs to Splunk or Logz.io?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/how-can-i-forward-my-logs-to-splunk-or-logz-io/166", "documentId": "6ff74d8bf19db9ee014ae34c763d0524716777ae", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How can I forward my logs to Splunk or Logz.io?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            monitoring\n          \n        \n        \n          \n            logs\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              August 13, 2019, 10:59pm\n            \n        #1\n        \n      \n      \n        I\u2019d like to integrate my log monitoring across my organization, including applications not hosted on Platform.sh.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              April 8, 2019,  7:50pm\n            \n        #2\n        \n      \n      \n        Both Logz.io\u2019s recommended forwarder, Filebeat, and the Splunk Universal Forwarder expect a file system with write access to ship logs to their indexers. Platform.sh by design is set-up to host applications on a read-only file system, so it is necessary to utilize mounts to provide these services with write access.\nInstallation, configuration, and shipping are explained briefly below for both Logz.io and Splunk, but more detailed How-tos are also available for more in-depth instruction:\n\nHow to forward Platform.sh logs to Logz.io\nHow to forward Platform.sh logs to a Splunk Indexer\n\nForwarding to Logz.io\n\n1. Define mounts\nDefine a mount in .platform.app.yaml that Filebeat can write to when it ships your logs, filebeat.\n# .platform.app.yaml\n\nmounts:\n    '/.filebeat':\n        source: local\n        source_path: filebeat\n\nMounts aren\u2019t available during build hooks, so one way we can install Filebeat is to create a subdirectory in our project called config/filebeat where we can store installation scripts and temporary builds, and then move them here afterwards.\n2. Modify build and deploy hooks\nInclude the following commands to your existing hooks in .platform.app.yaml:\n# .platform.app.yaml\n\nhooks:\n    build: |\n        if [ ! -z $LOGZ_CONFIG ]; then\n          ./config/filebeat/scripts/install.sh\n        fi\n        pipenv install --system --deploy\n    deploy: |\n        if [ ! \"$(ls -A filebeat)\" ]; then\n             ./config/filebeat/scripts/config.sh\n        fi\n        ./filebeat/filebeat run --once\n\nIn the build hook here an installation script config/filebeat/scripts/install.sh will install Filebeat in a temporary location during the build hook so long as a project level variable is not defined to show that this step has already been completed.\nAn example install.sh below installs Filebeat to the directory config/filebeat/build/ and downloads a certificate for it. On your Logz.io dashboard under \u2018Log Forwarding\u2019 the Filebeat instructions include more detail about these steps.\n# config/filebeat/scripts/install.sh\n\n#!/usr/bin/env bash\n\nTEMP_BEAT_HOME=config/filebeat/build\n\n[ ! -d $TEMP_BEAT_HOME ] &amp;&amp; mkdir -p $TEMP_BEAT_HOME\ncd $TEMP_BEAT_HOME\n\n# Install Filebeat\ncurl -L -O https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-6.7.0-linux-x86_64.tar.gz\ntar xzvf filebeat-6.7.0-linux-x86_64.tar.gz\nrm filebeat-6.7.0-linux-x86_64.tar.gz\n\n# Download the certificate\nwget https://raw.githubusercontent.com/logzio/public-certificates/master/COMODORSADomainValidationSecureServerCA.crt\n\nmkdir -p filebeat-6.7.0-linux-x86_64/pki/tls/certs\ncp COMODORSADomainValidationSecureServerCA.crt filebeat-6.7.0-linux-x86_64/pki/tls/certs/\n\nIn the deploy hook if the mount point is empty, a configuration script config/filebeat/scripts/config.sh moves the temporary Filebeat installation to the filebeat and creates a directory registry that will be used to save registry files.\n#!/usr/bin/env bash\n\n# Move filebeat to mount with write access\ncd $PLATFORM_HOME\ncp -v -r config/filebeat/build/filebeat-6.7.0-linux-x86_64/* filebeat\nmkdir filebeat/registry\n\n3. Configure with filebeat.yaml\n\nIn the application directory, place the filebeat.yml file that the Logz.io Wizard created for you in the \u2018Log Forwarding\u2019 section.\nTo ship all Platform.sh logs, enter var/log/*.log as its input. It will specify outputs for you as well.\n4. Complete\nAt this point if you push to platform remote Filebeat will install, configure itself, and ship Platform.sh logs with the last line of the deploy hook: ./filebeat/filebeat run --once.\nIf you keep the build hook as written, a new install will occur with each deployment unless you set a project level variable that designates that Filebeat is already configured:\n$ platform variable:create --level project --name LOGZ_CONFIG --value 'true'\n\nForwarding to Splunk\n1. Define mounts\nDefine a pair mount in .platform.app.yaml that the Forwarder can write to when it ships your logs. It will use splunk to write modified log files before they ship and .splunk to write authorization files so that it can remember configurations and credentials after it connects to your indexer.\n# .platform.app.yaml\n\nmounts:\n    'splunk':\n        source: local\n        source_path: splunk\n    '/.splunk':\n        source: local\n        source_path: splauths\n\nSame as above, since mounts aren\u2019t available during build we can install the Universal Forwarder in a subdirectory called config/filebeat where we can store installation scripts and temporary builds.\n2. Modify build and deploy hooks\n# .platform.app.yaml\n\nhooks:\n    build: |\n        if [ ! -z $SPLUNK_CONFIG ]; then\n            ./config/splunk/scripts/install.sh\n        fi\n        pipenv install --system --deploy\n    deploy: |\n        if [ ! \"$(ls -A splunk)\" ]; then\n             ./config/splunk/scripts/config.sh\n        fi\n        ./splunk/splunkforwarder/bin/splunk restart\n\nIn the build hook, the Forwarder will be installed in the temporary directory config/splunk/build, so long as a project level variable that denotes a completed configuration has not been set.\n# config/splunk/scripts/install.sh\n\n#!/usr/bin/env bash\n\nTEMP_SPLUNK_HOME=config/splunk/build\n\n# Install Splunk Universal Forwarder\n[ ! -d $TEMP_SPLUNK_HOME ] &amp;&amp; mkdir -p $TEMP_SPLUNK_HOME\ncd $TEMP_SPLUNK_HOME\nwget -O splunkforwarder-7.2.5.1-962d9a8e1586-Linux-x86_64.tgz 'https://www.splunk.com/bin/splunk/DownloadActivityServlet?architecture=x86_64&amp;platform=linux&amp;version=7.2.5.1&amp;product=universalforwarder&amp;filename=splunkforwarder-7.2.5.1-962d9a8e1586-Linux-x86_64.tgz&amp;wget=true'\ntar xvzf splunkforwarder-7.2.5.1-962d9a8e1586-Linux-x86_64.tgz\nrm splunkforwarder-7.2.5.1-962d9a8e1586-Linux-x86_64.tgz\n\nIn the deploy hook,\n# config/splunk/scripts/config.sh\n\n#!/usr/bin/env bash\n\ncd $PLATFORM_APP_DIR\n\nTEMP_SPLUNK_HOME=config/splunk/build/*\nSPLUNK_HOME=$PLATFORM_APP_DIR/splunk/splunkforwarder\n\n# Copy temp build to writable storage\ncp -v -r $TEMP_SPLUNK_HOME splunk\n\n# Migrate used-seed.conf to the forwarder\ncp -v config/splunk/seeds/user.conf $SPLUNK_HOME/etc/system/local/user-seed.conf\n\n# Start Splunk for the first time, accepting license\n./splunk/splunkforwarder/bin/splunk start --accept-license\n\n# Update outputs.conf with receiver address seed\ncp -v $PLATFORM_APP_DIR/config/splunk/seeds/outputs.conf $PLATFORM_APP_DIR/splunk/splunkforwarder/etc/system/local/outputs.conf\n\n# Update inputs.conf with monitor inputs seed\ncp -v $PLATFORM_APP_DIR/config/splunk/seeds/inputs.conf $PLATFORM_APP_DIR/splunk/splunkforwarder/etc/system/local/inputs.conf\n\n3. Create configuration files\nSplunk has a dedicated CLI that allows you to configure inputs and outputs, but it recommends creating a set of configuration seed files instead.\n\n\nuser.conf: The Forwarder comes with a default admin user with the password changeme. You will need to create this file to update the password or else remote access will not be available. Once it has been moved, you can start the Forwarder for the first time and modify the remaining configurations.\n# config/splunk/seeds/user.conf\n[user_info]\nUSERNAME = admin\nPASSWORD = testpass\n\n\n\noutputs.conf: This file configures information about the Splunk Receiver/Indexer. Replace &lt;receiver ip&gt; with the IP address of the Indexer. If you have changed the default listening port for the Indexer from 9997, you will need to change that as well.\n# config/splunk/seeds/outputs.conf\n[tcpout] defaultGroup=default \n\n[tcpout:default] server=&lt;receiver ip&gt;:9997 \n\n[tcpout-server:&lt;receiver ip&gt;:9997]\n\n\n\ninputs.conf: Finally, configure the forward to monitor all files in /var/log, the location of Platform.sh log files.\n# config/splunk/seeds/inputs.conf\n[monitor://var/log/]\ndisabled = false\n\n\n\nEach of these seed files can be placed in config/splunk/seeds in your project directory, and each is moved to the Forwarder\u2019s final installation location during the deploy hook.\n4. Complete\nLike the Logz.io instructions above, these configuration settings will install and configure the Splunk Universal Forwarder to ship Platform.sh logs on every deployment with the last line of the deploy hook: ./splunk/splunkforwarder/bin/splunk restart.\nIf you keep the build hook as written, a new install will occur with each deployment unless you set a project level variable that designates that Splunk is already configured:\n$ platform variable:create --level project --name SPLUNK_CONFIG --value 'true'\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Preventing stuck deployments caused by long-running cron jobs", "section": "Tutorials", "url": "https://community.platform.sh/t/preventing-stuck-deployments-caused-by-long-running-cron-jobs/434", "documentId": "530e122bb1ebc5e5812d929396fff89bd0d5f01b", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Preventing stuck deployments caused by long-running cron jobs\n\n\n\n    \n      \n        \n        Tutorials\n      \n    \n\n\n    \n        \n          \n            python\n          \n        \n        \n          \n            ssh\n          \n        \n    \n\n\n\n\n  \n      \n        \n          yhoiseth\n          \n        \n\n        \n            \n            \n              December 20, 2019,  9:30am\n            \n        #1\n        \n      \n      \n        The default way of deploying to production on Platform.sh is to simply push master to the platform remote. However, if a cron job is running, the application and services will be stopped, and the deployment will not finish until the cron job is finished. When this happens, the application goes down. In order to prevent this from happening, you can use a custom deployment script that first makes sure that no Django management commands are running in the production environment.\nIn the example below, we are checking if any Django management commands are running. If so, we abort the deployment. I have tested the script using Python 3.7.5, but it should work on 3.6.0 and later. If you\u2019re not running Python, you can use it as inspiration for porting it to your language of choice. If you do, please consider sharing it with the community, for example as a reply to this post.\nAs a caveat, note that if a cron job starts after the build has started, it might still block the deployment. The probability of this increases if your build takes a long time.\n#!/usr/bin/env python\nimport sys\nfrom os import getenv\nfrom subprocess import CompletedProcess, run\n\n\ndef git(command: str) -&gt; None:\n    run(f\"git {command}\", shell=True)\n\n\ndef main() -&gt; None:\n    git(\"checkout master\")\n    git(\"pull origin\")\n    print(\"Getting running processes in order to prevent stuck deployment\u2026\")\n    completed_process: CompletedProcess = run(\n        f\"ssh {getenv('PLATFORM_SH_SSH_DESTINATION')} 'ps auxf'\",\n        capture_output=True,\n        shell=True,\n    )\n    output = str(completed_process.stdout)\n    print(\"Making sure that process list was received\u2026\")\n    if \"/app/.global/bin/gunicorn\" not in output:\n        sys.exit(\"Gunicorn process not found. Are you able to connect using SSH?\")\n    print(\"Process list received. Checking for running Django management commands\u2026\")\n    if \"manage.py\" in output:\n        sys.exit(\"Running Django management command detected. Not safe to continue.\")\n    print(\n        \"No running commands detected. Pushing changes to the production environment\u2026\"\n    )\n    git(\"push platform\")\n\n\nif __name__ == \"__main__\":\n    main()\n\n\nTo use the script:\n\nCreate a Python file, e.g. deploy.py, in the root of your project and paste the script contents into it.\nSet the environment variable PLATFORM_SH_SSH_DESTINATION to the user@host destination of your production environment.\nCheck if there are any modifications you need to make. For example, you may be running other kinds of jobs than just Django management commands, so you may need to add other strings in addition to manage.py\n\nRun ./deploy.py when you\u2019re ready to deploy.\nCommit the script so you don\u2019t lose it.\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Is it possible to kill a build or deploy?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/is-it-possible-to-kill-a-build-or-deploy/156", "documentId": "13553f9a192802c120a83209e912074fec3afeb7", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Is it possible to kill a build or deploy?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              August 13, 2019, 11:00pm\n            \n        #1\n        \n      \n      \n        Sometimes I push a commit and the build/deploy either takes a very long time, or it becomes permanently stuck. Am I able to do something to kill the process?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n              March 26, 2019,  2:01pm\n            \n        #2\n        \n      \n      \n        Basics\nIf a build or deployment is running longer than expected, it may be caused by one of the following:\n\nThe build is blocked by something in your build hook\nThe deployment is blocked by a long running process in your deploy hook.\nThe deployment is blocked by a long running cron job in the environment.\nThe deployment is blocked by a long running cron job in the parent environment.\n\nAccess the environment\u2019s logs\nFirst, determine if the build has completed and is attempting to deploy. Access the environment\u2019s build logs with the Platform.sh CLI:\n$ platform logs &lt;project ID&gt;\n\nAlternatively, you can click on the Pending status icon on the Web UI to check its status.\nThere should be a line similar to\nRe-deploying environment w6ikvtghgyuty-drupal8-b3dsina.\n\nIf that message is not visible, the project is most likely in a state of a blocked build, and it will be required to create a support ticket to have the build killed.\nKill a stuck deployment\nIf the above message is visible, the project is in a stuck deployment.\nSSH into the environment. The long-running cron jobs on the environment can be found with the command\n$ ps afx\n\nand once the long-running process has been identified (&lt;PID&gt;), it can be killed with the command\n$ kill &lt;PID&gt;\n\nYou can find additional information about stuck builds and deployments in the public documentation.\n      \n\n      \n\n      \n         \n         \n         2 Likes\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Consequences of restoring backups after the persistent data model has been changed", "section": "Tutorials", "url": "https://community.platform.sh/t/consequences-of-restoring-backups-after-the-persistent-data-model-has-been-changed/461", "documentId": "a1ce8466e2bbc7061242b5bf221829aaae54465c", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Consequences of restoring backups after the persistent data model has been changed\n\n\n\n    \n      \n        \n        Tutorials\n      \n    \n\n\n    \n        \n          \n            mounts\n          \n        \n        \n          \n            restore-snapshot\n          \n        \n        \n          \n            backups\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              February 13, 2020,  7:11pm\n            \n        #1\n        \n      \n      \n        Goal\nThe ability to restore environment backups is a powerful tool, but only when backups are taken regularly to reflect the rapid changes that can occur over the course of the development of your application. Failing to do so has some consequences, as older backups that don\u2019t reflect major changes can result in data loss once restored.\nThe goal in this tutorial is to explore some of these consequences, and to illustrate how taking the time to setup scheduled backups can alleviate plenty of headaches down the line.\nPreparation\nYou will need:\n\nA Platform.sh account\nA Platform.sh project\n\nPlatform.sh CLI installed locally\nA local copy of that project\n\nProblems\nPlatform.sh gives you the ability to quickly create backups of the state of your environments, and then easily restore those backups to those environments should you need to. This is not yet an automatic process, and both creation and restoration must be executed manually by the user.\nBut, of course, people forget to take frequent backups - they\u2019re busy developing. It\u2019s for this reason that we often recommend users install the Platform.sh CLI into their application containers in order to automate this process.\nIf you have not yet set up automatic backups as described in the above How-to, you may very well find yourself in the following situation.\n\nI\u2019ve created a backup close to the start of an environment\u2019s history.\nI\u2019ve made a lot of changes to that environment (added services, added data to those services, created new mounts, etc.).\nSomething went wrong.\nWell, look, I have a backup right here. But it\u2019s old. What will happen?\n\nThis tutorial is meant to explore this exact scenario, with the intended takeaways:\n\nthe importance of setting up automatic backups on your projects using the How-to above as a guide (so you don\u2019t find yourself in this situation in the first place).\nsome greater understanding of how Platform.sh handles your data during backups, restores, and syncs.\n\nSteps\nCreating backups\n\nnote\nThis tutorial uses a modified version of our Platform.sh Language Examples project. That project is intended to show how to interact with all of our managed services with each of our runtimes. It\u2019s a great resource, and it even powers most of the examples in our public documentation, but it\u2019s gigantic, and much more than we need for this tutorial.\nWe removed all of the runtimes except for Python, leaving us with only the main and python application container directories. We also removed all of the services save postgresql, but we will be adding a few of them back in the steps below. It is not necessary that you use the same repository if going through this tutorial step by step, just try to match the steps in your own project.\n\n1. Create a new branch\nAssuming you have already created a project and initialized it with some code, create a new environment\nplatform branch add-mongo master\n\n2. Create a backup\nThen create a backup of that environment in its current state.\nplatform backup:create\nCreating a backup of add-mongo\nWaiting for the activity is5ytp2lbm7p4 (Chad Carlson created a backup of add-mongo):\n\nCreating snapshot of add-mongo\nCreated backup bivzemjpeqvohqey2t7fo7vs5m\n[============================] 15 secs (complete)\nActivity is5ytp2lbm7p4 succeeded\nBackup name: bivzemjpeqvohqey2t7fo7vs5m\n\nSo what happened here? Each service, which includes applications, has its own persistent storage. During a backup, a copy is made for each of them. It\u2019s the collection of these backups that then makes up backup bivzemjpeqvohqey2t7fo7vs5m.\nAdding a new service\n1. Configure a new service\nFirst, let\u2019s add a new service to the project, one that did not exist when the backup was created. Modify your services.yaml file to include MongoDB:\ndbmongo:\n    type: mongodb:3.6\n    disk: 1024\n    size: S\n\nand your .platform.app.yaml to include the new relationship:\nrelationships:\n    mongodb: 'dbmongo:mongodb'\n\nThen commit and push the changes to Platform.sh.\ngit add .\ngit commit -m \"Adds mongodb.\"\ngit push platform add-mongo\n\nPlatform.sh will provision MongoDB to your virtual cluster, and expose the following credentials in your PLATFORM_RELATIONSHIPS  environment variable:\n{\n  \"username\": \"main\",\n  \"scheme\": \"mongodb\",\n  \"service\": \"mongodb\",\n  \"ip\": \"169.254.117.167\",\n  \"hostname\": \"ldh423mk2e7o6qto2syljqbg5u.mongodb.service._.eu-3.platformsh.site\",\n  \"cluster\": \"rjify4yjcwxaa-master-7rqtwti\",\n  \"host\": \"mongodb.internal\",\n  \"rel\": \"mongodb\",\n  \"path\": \"main\",\n  \"query\": {\n    \"is_master\": true\n  },\n  \"password\": \"main\",\n  \"type\": \"mongodb:3.6\",\n  \"port\": 27017\n}\n\n2. Develop and verify\nAt this point, MongoDB is available for you to develop with. Over the next few days, you may make the following changes as you are developing on the environment:\n\nyou create a new collection in main called starwars.\nyour application adds a number of documents to that collection. (In the case of our language examples project, the Python app adds a document with the contents {\"name\": \"Rey\", \"occupation\": \"Jedi\"} as a test each time the site is visited)\n\nYou can verify those documents have been added locally by opening an SSH tunnel to the service (platform:tunnel single -r mongodb) and then connecting to MongoDB via that tunnel and the credentials above:\n$ mongo --port 30000 -u main -p main --authenticationDatabase main\nMongoDB shell version v4.0.3\n&gt; use main\nswitched to db main\n&gt; show collections\nstarwars\n&gt; db.starwars.find()\n{ \"_id\" : ObjectId(\"5e4457d05908440effc53a20\"), \"name\" : \"Rey\", \"occupation\" : \"Jedi\" }\n{ \"_id\" : ObjectId(\"5e4457d35908440effc53a22\"), \"name\" : \"Rey\", \"occupation\" : \"Jedi\" }\n{ \"_id\" : ObjectId(\"5e4457d75908440effc53a24\"), \"name\" : \"Rey\", \"occupation\" : \"Jedi\" }\n{ \"_id\" : ObjectId(\"5e4457d95908440effc53a26\"), \"name\" : \"Rey\", \"occupation\" : \"Jedi\" }\n{ \"_id\" : ObjectId(\"5e44585c5908440effc53a28\"), \"name\" : \"Rey\", \"occupation\" : \"Jedi\" }\n&gt;\n\nThere\u2019s all the newly added data.\n3. Restore the backup\nNow, if we restore the backup we created at the beginning (before MongoDB was a part of the cluster)  using the command\nplatform backup:restore bivzemjpeqvohqey2t7fo7vs5m\n\nThe restore will do a few things:\n\nAll persistent data currently in that environment is wiped.\nBackup bivzemjpeqvohqey2t7fo7vs5m, which contains a backup of each service present when it was taken, is then applied to the containers present in the environment one by one.\n\nBecause of that first point, and because no backup for MongoDB exists in backup bivzemjpeqvohqey2t7fo7vs5m, all data and code pertaining to MongoDB is erased before anything else happens. If you attempt to open a tunnel and locally connect to MongoDB straight away, the service won\u2019t even be recognized as existing in the project.\nRun platform redeploy, re-open the tunnel to MongoDB, and then repeat the prior steps to connect to MongoDB:\n$ mongo --port 30000 -u main -p main --authenticationDatabase main\nMongoDB shell version v4.0.3\n&gt; use main\nswitched to db main\n&gt; show collections\nstarwars\n&gt;\n\nAs you can see, the added collection no longer exists on the service. This is our first example of why it\u2019s important to create backups regularly. If one had been taken some time after MongoDB existed, we would still have been able to keep some of its data.\nMounts\n1. Configure a new mount\nAnother case where this would be relevant is the addition of new mounts to the project. If you were to create a mount that was not included in backup bivzemjpeqvohqey2t7fo7vs5m, would the files in that mount be erased?\nYou can probably guess already based on the previous example, but let\u2019s find out. You can add a mount to an application by adding the following lines to your .platform.app.yaml file:\nmounts:\n    'add-mount':\n        source: local\n        source_path: add-mount\n\nThen commit and push to Platform.sh:\ngit add .\ngit commit -m \"Add a mount.\"\ngit push platform add-mongo\n\n2. Add data and verify\nLet\u2019s just create a simple file\nmkdir mount-data &amp;&amp; touch mount-data/test.txt\necho \"Here's our mounted data on Platform.sh.\" &gt;&gt; mount-data/test.txt\n\nand then upload it to the newly defined mount:\nplatform mount:upload --mount add-mount --source ./mount-data\n\nYou can then verify that the file was uploaded to the project by runing platform ssh to SSH into the application container. Then run,\nweb@app.0:~$ echo \"$(&lt;add-mount/test.txt)\"\nHere's our mounted data on Platform.sh.\n\n3. Restore the backup\nLooks good - now let\u2019s restore the environment from the backup.\nplatform backup:restore bivzemjpeqvohqey2t7fo7vs5m\n\nOnce again, if we SSH into the container immediately after the backup is restored, the add-mount mount will not be present. After a platform redeploy however, it is, but alas, our data has been deleted:\nweb@python.0:~$ ls\nPipfile  Pipfile.lock  README.md  add-mount  examples  setup.py  web\nweb@python.0:~$ echo \"$(&lt;add-mount/test.txt)\"\n-bash: add-mount/test.txt: No such file or directory\n\nConclusion\nIn this tutorial we saw that:\n\nThe first step during backup restoration wipes all persistent data from the current environment.\nAll data after that backup was created - including service configuration - will be lost. We saw first hand that this is the case when new service containers are added, as well as mounted data.\nThere\u2019s a super simple way to configure automatic backups on your projects that will help mitigate this whole mess in the first place.\n\nRead the above How-to and start protecting your data!\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    If I add a service, can I still restore a snapshot from before that service existed?\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to kill stuck processes that block your deployments", "section": "Tutorials", "url": "https://community.platform.sh/t/how-to-kill-stuck-processes-that-block-your-deployments/473", "documentId": "63d33c810a0cf6b72442eb342dbdfacbd14498f7", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to kill stuck processes that block your deployments\n\n\n\n    \n      \n        \n        Tutorials\n      \n    \n\n\n    \n        \n          \n            stuck_build\n          \n        \n        \n          \n            processes\n          \n        \n        \n          \n            linux\n          \n        \n    \n\n\n\n\n  \n      \n        \n          bogdan-vasilescu\n          \n        \n\n        \n            \n              February 24, 2020,  3:11pm\n            \n        #1\n        \n      \n      \n        One of the most common causes for environment builds that get stuck is a runaway/stuck process.\nTo ensure data consistency, the deployment flow tries to terminate running processes gracefully. Sometimes, this does not work and the deployment ends up waiting forever due to a blocking process. Using two simple commands when connected to SSH can help you get things moving without having to wait for our support team to intervene.\nAs an example, let\u2019s assume a cron process is stuck.\nThe demo application contains one blocker.sh script:\n#!/bin/sh\n\nsleep 3600\n\nwhich is configured as an every 5 minute cron in .platform.app.yaml:\n  blocker:\n    spec: '*/5 * * * *'\n    cmd: '/bin/bash /app/block.sh'\n\nNow, this process is blocking our new deployment - the log is stuck at:\n    Redeploying environment master\n      Preparing deployment\n      Closing services router and app\n\nFirst thing to do is see if you can connect with SSH to the environment (this should work most of the time). If the SSH connection is successful, run: ps fuxa.\nThe output will be a list of processes, similar to this one:\nweb@app.0:~$ ps fuxa\nUSER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot         153  0.9  0.0 197656 33176 ?        Sl   15:05   0:00 /usr/bin/python2.7 /etc/platform/commands/notify\nweb          159  0.0  0.0 271388 26620 ?        Sl   15:05   0:00  \\_ /usr/bin/python2.7 /etc/platform/commands/notify\nweb          162  0.0  0.0   4280   740 ?        S    15:05   0:00      \\_ /bin/dash -c /bin/bash /app/blocker.sh\nweb          165  0.0  0.0  12920  2740 ?        S    15:05   0:00          \\_ /bin/bash /app/blocker.sh\nweb          166  0.0  0.0   7580   668 ?        S    15:05   0:00              \\_ sleep 3600\nroot           1  0.0  0.0  15816  1096 ?        Ss+  15:02   0:00 init [2]\nroot          74  0.0  0.0   4204  1132 ?        Ss   15:02   0:00 runsvdir -P /etc/service log: ...................................................................................................................\nroot          80  0.0  0.0   4052   704 ?        Ss   15:02   0:00  \\_ runsv tideways\nroot          81  0.0  0.0   4052   696 ?        Ss   15:02   0:00  \\_ runsv ssh\nroot          90  0.0  0.0  72104  5608 ?        S    15:02   0:00  |   \\_ /usr/sbin/sshd -D\nroot         167  0.0  0.0  94876  6472 ?        Ss   15:06   0:00  |       \\_ sshd: web [priv]\nweb          173  0.0  0.0  94876  3668 ?        S    15:06   0:00  |           \\_ sshd: web@pts/0\nweb          174  0.0  0.0  21768  3852 pts/0    Ss   15:06   0:00  |               \\_ -bash\nweb          190  0.0  0.0  37448  3172 pts/0    R+   15:06   0:00  |                   \\_ ps fuxa\nroot          82  0.0  0.0   4052   700 ?        Ss   15:02   0:00  \\_ runsv nginx\nroot         115  0.0  0.0  36984  6684 ?        S    15:02   0:00  |   \\_ nginx: master process /usr/sbin/nginx -g daemon off; error_log /var/log/error.log; -c /etc/nginx/nginx.conf\nweb          121  0.0  0.0  45460 11560 ?        S    15:02   0:00  |       \\_ nginx: worker process\nroot          83  0.0  0.0   4052   752 ?        Ss   15:02   0:00  \\_ runsv newrelic\nroot          84  0.0  0.0   4052   644 ?        Ss   15:02   0:00  \\_ runsv idmapd\nroot          87  0.0  0.0  23348  2152 ?        S    15:02   0:00  |   \\_ /usr/sbin/rpc.idmapd -f -C -p /run/rpc_pipefs\nroot          85  0.0  0.0   4052   700 ?        Ss   15:02   0:00  \\_ runsv app\nweb          111  0.0  0.0 359464 30288 ?        Ss   15:02   0:00      \\_ php-fpm: master process (/etc/php/7.2-zts/fpm/php-fpm.conf)\nweb          116  0.0  0.0  12932   296 ?        S    15:02   0:00          \\_ /bin/bash /etc/platform/start-app\nweb          117  0.0  0.0   7584   656 ?        S    15:02   0:00              \\_ tee -a /var/log/app.log\n\nYou can probably see already our stuck process is here:\nweb          162  0.0  0.0   4280   740 ?        S    15:05   0:00      \\_ /bin/dash -c /bin/bash /app/blocker.sh\nweb          165  0.0  0.0  12920  2740 ?        S    15:05   0:00          \\_ /bin/bash /app/blocker.sh\nweb          166  0.0  0.0   7580   668 ?        S    15:05   0:00              \\_ sleep 3600\n\nThe important thing in the above output is the number listed in the second column, after the web user: this is the process ID, a unique identifier for each running process. As we\u2019re interested in stopping the process, it\u2019d be very useful to somehow forcefully stop it.\nThis can be done with the kill -9 command, followed by the list of process IDs you want to stop.\nTherefore, to stop the cron in our example, we\u2019d need to run:\nkill -9 162 165 166\n\nBe careful: there might be more processes that block the deployment ! Inspect the process list carefully (all application processes will be under the web user) and repeat the previous command for all of them.\nOnce done, the SSH connection will be terminated and you\u2019ll see the friendly:\nMessage from bot@platform.sh at 15:09:36:                                      \n  This container is being dematerialized. See you on the other side.       \n\nmessage. Your previously stuck deployment will now continue.\nNote: if the SSH connection cannot be established, you will need to open a support ticket.\n      \n\n      \n\n      \n         \n         \n         2 Likes\n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Java Email at Platform.sh", "section": "Tutorials", "url": "https://community.platform.sh/t/java-email-at-platform-sh/483", "documentId": "ce229ca6eedb78646d0f601c8f6684ac484d1c1a", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Java Email at Platform.sh\n\n\n\n    \n      \n        \n        Tutorials\n      \n    \n\n\n    \n        \n          \n            java\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n            \n              March 5, 2020,  4:07pm\n            \n        #1\n        \n      \n      \n        Electronic mail is a method of exchanging messages between people using electronic devices. In this post, we\u2019ll explain how to send an email message with Java through Platform.sh.\nBy default, only the master environment can send emails. For non-master environments, you can configure outgoing emails via the management console.\nEmails from Platform.sh are sent via a SendGrid-based SMTP proxy. Each Platform.sh project is provisioned as a SendGrid sub-account. These SendGrid sub-accounts are capped at 12k emails per month.\nBelow the sample code that uses Java Mail:\nimport sh.platform.config.Config;\n\nimport javax.mail.Message;\nimport javax.mail.MessagingException;\nimport javax.mail.Session;\nimport javax.mail.Transport;\nimport javax.mail.internet.InternetAddress;\nimport javax.mail.internet.MimeMessage;\nimport java.util.Properties;\nimport java.util.logging.Level;\nimport java.util.logging.Logger;\n\npublic class JavaEmailSender {\n\n    private static final Logger LOGGER = Logger.getLogger(JavaEmailSender.class.getName());\n\n    public void send() {\n        Config config = new Config();\n        String to = \"\";//change accordingly\n        String from = \"\";//change accordingly\n        String host = config.getSmtpHost();\n        //or IP address\n        //Get the session object\n        Properties properties = System.getProperties();\n        properties.setProperty(\"mail.smtp.host\", host);\n        Session session = Session.getDefaultInstance(properties);\n\n        //compose the message\n        try {\n            MimeMessage message = new MimeMessage(session);\n            message.setFrom(new InternetAddress(from));\n            message.addRecipient(Message.RecipientType.TO, new InternetAddress(to));\n            message.setSubject(\"Ping\");\n            message.setText(\"Hello, this is example of sending email  \");\n\n            // Send message\n            Transport.send(message);\n            System.out.println(\"message sent successfully....\");\n\n        } catch (MessagingException exp) {\n            exp.printStackTrace();\n            LOGGER.log(Level.SEVERE, \"there is an error to send an message\", exp);\n        }\n    }\n}\n\n\nThere is plenty of additional l documentation about using JavaMail, like this one, that shows how to send email with HTML format and an attachment:\nhttps://mkyong.com/java/java-how-to-send-email/\nReferences\n\n\n\nhttps://docs.platform.sh/development/email.html\n\n\n\n\nhttps://mkyong.com/java/java-how-to-send-email/\n\n\n\n\nhttps://javaee.github.io/javamail/\n\n\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Garbage Collector Log", "section": "Tutorials", "url": "https://community.platform.sh/t/garbage-collector-log/482", "documentId": "ee41a263e9ad5dbaa4a03fcd7e0ff42219320f77", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Garbage Collector Log\n\n\n\n    \n      \n        \n        Tutorials\n      \n    \n\n\n    \n        \n          \n            java\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n            \n              March 5, 2020,  4:16pm\n            \n        #1\n        \n      \n      \n        Java garbage collection is the process by which Java programs perform automatic memory management. This post, we\u2019ll explain how to add the log in the Platform.sh application.\nHow to Generate GC Log File?\nIn order to understand the GC log, you first need to generate one. Passing the following system properties to your JVM would generate GC logs.\nTo set the JVM log on Platform.sh we need to append it with the Java startup parameter.\nE.g., To define the GC log. From your app\u2019s .platform.app.yaml file.\nweb:\n    commands:\n        start: java -jar -Xmx2048m -Xlog:gc*=debug:stdout:time,uptimemillis,tid target/microprofile-microbundle.jar --port $PORT\n\nWhen you append the GC log, the next step is to check the information, the default file to the registry is on /tmp/log/app.log. Therefore you can check the GC information from the command below once you\u2019re inside the application container.\ntail -f /tmp/log/app.log\nTo access the machine through ssh, please check the PSH documentation:\nhttps://docs.platform.sh/development/ssh.html\n-XX:+PrintGC\nThe flag -XX:+PrintGC (or the alias -verbose:gc) activates the \u201csimple\u201d GC logging mode, which prints a line for every young generation GC and every full GC.\n-XX:+PrintGCDetails\nIf we use -XX:+PrintGCDetails instead of -XX:+PrintGC, we activate the \u201cdetailed\u201d GC logging mode which differs depending on the GC algorithm used. We start by taking a look at the output produced by a young generation GC using the Throughput Collector.\nUnified JVM Logging\nJava 9 comes with a unified logging architecture (JEP 158) that pipes a lot of messages that the JVM generates through the same mechanism, which can be configured with the -Xlog option.\nE.g.: -Xlog:gc*=debug:stdout:time,uptimemillis,tid\n-Xloggc\nBy default the GC log is written to stdout. With -Xloggc: we may instead specify an output file. Note that this flag implicitly sets -XX:+PrintGC and -XX:+PrintGCTimeStamps as well. Still, I would recommend setting these flags explicitly if desired, in order to safeguard yourself against unexpected changes in new JVM versions.\nMigrate to Java 11\nThe benefits of using the latest LTS version are the increase of support to the containers, therefore, beyond the new APIs and security fixes, there is an increase of performance to run on GC.\nD Command-Line Options\nThis appendix describes some command-line options that can be useful when diagnosing problems with the Java HotSpot VM.\n\n  \n      \n      Oracle Help Center\n  \n  \n    \n\nTroubleshooting Guide\n\nThis appendix describes some command-line options that can be useful when diagnosing problems with the Java HotSpot VM.\n\n\n  \n  \n    \n    \n  \n  \n\n\nReferences\n\nhttps://www.oracle.com/webfolder/technetwork/tutorials/obe/java/gc01/index.html\nhttps://stackify.com/what-is-java-garbage-collection/\nhttps://blog.codefx.org/java/unified-logging-with-the-xlog-option/#What-Is-Unified-Logging\nhttps://dzone.com/articles/understanding-garbage-collection-log\n\nSee also\n\nJava Memory arguments: Java Memory commands\n\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    Tips for running Java on Platform.sh\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Multiple Applications (Tomcat)", "section": "Tutorials", "url": "https://community.platform.sh/t/multiple-applications-tomcat/468", "documentId": "e693ac6fe97dfb42f053e3c6bfe0286b24fe1898", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Multiple Applications (Tomcat)\n\n\n\n    \n      \n        \n        Tutorials\n      \n    \n\n\n    \n        \n          \n            java\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n            \n              April 23, 2020, 12:52pm\n            \n        #1\n        \n      \n      \n        Platform.sh supports building multiple applications per project (for example, RESTful web services with a front-end, or a main website and a blog).\nAll of the applications share a common configuration through the files present in the .platform/ folder at the root of the Git repository. Every application exists in its own subdirectory, and each of them contain its own application configuration via a .platform.app.yaml file, so that your directory structure looks something like this:\n$ ls -a\n.git/\n.platform/\n  routes.yaml\n  services.yaml\napp/\n  .platform.app.yaml\n  pom.xml\n    [...]\napp2/\n  .platform.app.yaml\n  pom.xml\n    [...]\npom.xml\n\nWhen you push via Git, Platform.sh will build each application separately. Only the application(s) that have been modified will be rebuilt.\n\nSample code\nDocumentation\n\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Java Memory commands", "section": "Tutorials", "url": "https://community.platform.sh/t/java-memory-commands/481", "documentId": "5a72f1c24694d442b93c19daa06811a4c7c570d7", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Java Memory commands\n\n\n\n    \n      \n        \n        Tutorials\n      \n    \n\n\n    \n        \n          \n            java\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n            \n              April 15, 2020,  2:43pm\n            \n        #1\n        \n      \n      \n        Java Heap space is used by the Java runtime to allocate memory to Objects and JRE classes. Whenever we create an object, it\u2019s always created in the Heap space. This post, we\u2019ll explain to how to set the memory size on Platform.sh.\nGarbage Collection runs on the heap memory to free the memory used by objects that don\u2019t have any reference. Any object created in the heap space has global access and can be referenced from anywhere in the application.\nTo set the memory size on JVM on Platform.sh we need to append the memory settings with the Java startup parameter.\nPlatform.sh has a command that returns the memory that is available with -$(jq .info.limits.memory /run/config.json) that value is on megabytes. As a recommendation, you can use the fine maximum JVM memory.\nweb:\n    commands:\n        start: java -jar -Xmx$(jq .info.limits.memory /run/config.json)m target/microprofile-microbundle.jar --port $PORT\n\nBelow, more arguments to set the memory:\n-Xmn size\nSets the initial and maximum size (in bytes) of the heap for the young generation (nursery). Append the letter k or K to indicate kilobytes, m or M to indicate megabytes, or g or G to indicate gigabytes. The young generation region of the heap is used for new objects. GC is performed in this region more often than in other regions. If the size for the young generation is too small, then a lot of minor garbage collections are performed. If the size is too large, then only full garbage collections are performed, which can take a long time to complete. Oracle recommends that you keep the size for the young generation greater than 25% and less than 50% of the overall heap size.\n#-Xms size\nSets the initial size (in bytes) of the heap. This value must be a multiple of 1024 and greater than 1 MB. Append the letter k or K to indicate kilobytes, m or M to indicate megabytes, g or G to indicate gigabytes.\n-Xmx size\nSpecifies the maximum size (in bytes) of the memory allocation pool in bytes. This value must be a multiple of 1024 and greater than 2 MB. Append the letter k or K to indicate kilobytes, m or M to indicate megabytes, and g or G to indicate gigabytes. The default value is chosen at runtime based on system configuration. For server deployments, -Xms and -Xmx are often set to the same value.\n\nAs mentioned, previously use the $(jq .info.limits.memory /run/config.json) to create the Xmx command. E.g.: java -jar -Xmx$(jq .info.limits.memory /run/config.json)m\n\n-Xnoclassgc\nDisables garbage collection (GC) of classes. This can save some GC time, which shortens interruptions during the application run. When you specify -Xnoclassgc at startup, the class objects in the application are left untouched during GC and are always considered live.\n-Xss size\nSets the thread stack size (in bytes). Append the letter k or K to indicate KB, m or M to indicate MB, and g or G to indicate GB.\nExitOnOutOfMemoryError\nWhen you enable this option, the JVM exits on the first occurrence of an out-of-memory error. It can be used if you prefer restarting an instance of the JVM rather than handling out of memory errors.\nRecommended Java memory command at Platform.sh\n\njava -jar -Xmx$(jq .info.limits.memory /run/config.json)m -XX:+ExitOnOutOfMemoryError ...\n\nGC Log activated\njava -jar -Xmx$(jq .info.limits.memory /run/config.json)m -XX:+ExitOnOutOfMemoryError -XX:+PrintGCDetails ...\n\nReferences\n\nGarbage Collector Log\nhttps://docs.oracle.com/en/java/javase/11/tools/java.html#GUID-3B1CE181-CD30-4178-9602-230B800D4FAE\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    Tips for running Java on Platform.sh\n                  \n                \n                \n                  \n                    \n                    \n                    Garbage Collector Log\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Tips for running Java on Platform.sh", "section": "Tutorials", "url": "https://community.platform.sh/t/tips-for-running-java-on-platform-sh/531", "documentId": "ec0962610ca57d7da402d8026640ad7ae55b343e", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Tips for running Java on Platform.sh\n\n\n\n    \n      \n        \n        Tutorials\n      \n    \n\n\n    \n        \n          \n            java\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n            \n              April 16, 2020,  6:03pm\n            \n        #1\n        \n      \n      \n        Goal\nThis tutorial will explain some Java commands and some recommendations to optimize the process of running your Java applications safety on Platform.sh.\nAssumptions\n\n\nYou either have a Java application that you want to run on Platform.sh, or you already have a Java application already running on Platform.sh\n\n\nA text editor of your choice.\n\n\nSteps\nOnce you have your Java application running on Platform.sh, there are several steps you should take to optimize the application runtime.\nMinimum requirement (Memory)\nThe first one is Xmx, which defines the maximum size that the JVM can use. The optimal value can be derived from the application\u2019s generated configuration files and will scale with your container size automatically.\nTo extract the appropriate value on the command line, use $(jq .info.limits.memory /run/config.json).\nThe second parameter is ExitOnOutOfMemoryError.  When you enable this option, the JVM exits on the first occurrence of an out-of-memory error.  Platform.sh will restart the application automatically.\nThese are the basic recommended parameters for running a Java application. So, the command will start with:\njava -jar -Xmx$(jq .info.limits.memory /run/config.json)m -XX:+ExitOnOutOfMemoryError //The rest of the arguments and the jar file.\n\nGarbage collector (Optional)\nWhen migrating the application to a cloud environment, it is often essential to analyze the Garbage Collector\u2019s log and behavior. For this, there are two options:\n\nPlacing the log into the Platform.sh app.log file (which captures STDOUT).\nCreating a log file specifically for the GC.\n\nTo use the STDOUT log, you can add the parameter -XX: + PrintGCDetails, E.g.:\njava -jar -Xmx$(jq .info.limits.memory /run/config.json)m -XX:+ExitOnOutOfMemoryError -XX:+PrintGCDetails //The rest of the arguments and the jar file.\n\nJava supports a number of different garbage collection strategies.  Which one is optimal for your application will vary depending on your available memory, Java version, and application profile.  Determining which is best for your application is out of scope, but the main options and how to enable them are:\n\n\n\n\nName\nCommand  Flag\nDescription\n\n\n\n\nSerial Garbage Collector\n-XX:+UseSerialGC\nThis is the simplest GC implementation, as it basically works with a single thread.\n\n\nParallel Garbage Collector\n-XX:+UseParallelGC\nUnlike Serial Garbage Collector, this uses multiple threads for managing heap space. But it also freezes other application threads while performing GC.\n\n\nCMS Garbage Collector\n-XX:+USeParNewGC\nThe Concurrent Mark Sweep (CMS) implementation uses multiple garbage collector threads for garbage collection. It\u2019s for applications that prefer shorter garbage collection pauses, and that can afford to share processor resources with the garbage collector while the application is running.\n\n\nG1 Garbage Collector\n-XX:+UseG1GC\nGarbage First, G1, is for applications running on multiprocessor machines with large memory space.\n\n\n\nThe default stragtegy on Java 9 and later is G1.  The GC strategy to use can be set in the start line with:\nSerial\njava -jar -Xmx$(jq .info.limits.memory /run/config.json)m -XX:+ExitOnOutOfMemoryError -XX:+PrintGCDetails -XX:+UseSerialGC //The rest of the arguments and the jar file.\n\nParallel Garbage Collector\njava -jar -Xmx$(jq .info.limits.memory /run/config.json)m -XX:+ExitOnOutOfMemoryError -XX:+PrintGCDetails -XX:+UseParallelGC //The rest of the arguments and the jar file.\n\nCMS Garbage Collector\njava -jar -Xmx$(jq .info.limits.memory /run/config.json)m -XX:+ExitOnOutOfMemoryError -XX:+PrintGCDetails -XX:+USeParNewGC //The rest of the arguments and the jar file.\n\nG1\njava -jar -Xmx$(jq .info.limits.memory /run/config.json)m -XX:+ExitOnOutOfMemoryError -XX:+PrintGCDetails -XX:+UseG1GC //The rest of the arguments and the jar file.\n\nJava 8 Optimization\nIdeally, all applications should run the latest LTS release of the JVM at least.  That is currently Java 11.  Java 11 has a number of performance improvements, particularly on container-based environments such as Platform.sh.\nHowever, in many cases, this is not possible.  If you are still running on Java 8 there are two additional considerations.\nThe default garbage collector for Java 8 is Parallel GC.  In most cases G1 will offer better performance.  We recommend enabling it, as above.\nFurthermore, there is the UseStringDeduplication flag which works to eliminate duplicate Strings within the GC process.  That flag can save between 13% to 30% of memory, depending on application. However, this can impact on the pause time of your app.\njava -jar -Xmx$(jq .info.limits.memory /run/config.json)m -XX:+UseG1GC -XX:+UseStringDeduplication -XX:+ExitOnOutOfMemoryError -XX:+PrintGCDetails\n\nReferences\n\nJava Memory Commands\nHow to Migrate my Java application to Platform.sh\nGarbage Collector Log\nIntroduction to Garbage Collection Tuning\n\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How do I get a postgres connection string for prisma2 framework", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-do-i-get-a-postgres-connection-string-for-prisma2-framework/427", "documentId": "9687dcc895ae04d99a513c19962507a077da9237", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How do I get a postgres connection string for prisma2 framework\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            postgresql\n          \n        \n        \n          \n            prism\n          \n        \n        \n          \n            prism2\n          \n        \n        \n          \n            connectionstring\n          \n        \n        \n          \n            prisma\n          \n        \n        \n          \n            prisma2\n          \n        \n    \n\n\n\n\n  \n      \n        \n          matthias-van-woensel\n          \n        \n\n        \n            \n            \n              December 11, 2019,  3:45pm\n            \n        #1\n        \n      \n      \n        Goal\nTo create a postgresql connection string from the PLATFORM_RELATIONSHIPS environment variable.\nAssumptions\n\nYou have nodejs installed in your container.\nYou have postgresql\nYou know how to work with prisma2\n\nProblem\nYou can get database credentials using the $PLATFORM_RELATIONSHIPS variable\necho $PLATFORM_RELATIONSHIPS | base64 --decode | json_pp\nSee our documentation\nBut\u2026 the prisma2 framework assumes you have a postgresql connection string See prisma2 documentation.\nProposed solution\nWe can make a simple nodejs script that takes the base64 decoded string from PLATFORM_RELATIONSHIPS, and converts it into a postgresql connection string.\nIn a bash script, that would look like this:\n$ DECODED_RELATIONSHIPS=$(echo $PLATFORM_RELATIONSHIPS | base64 --decode)\n$ nodejs get_postgres_querystring.js $DECODED_RELATIONSHIPS postgresdatabase\n\npostgres://main:main@postgresdatabase.internal:5432/main\n\nWhere the last variable, postgresdatabase, is the name of the relationship.\nAnd get_postgres_querystring.js looks like this:\nvar myArgs = process.argv.slice(2);\nvar relationships = myArgs[0];\nvar db = myArgs[1];\n\nvar json_rel = JSON.parse(relationships);\nvar json_db = json_rel[db][0];\nvar url = \"postgres://\"+json_db[\"username\"]+\":\"+json_db[\"password\"]+\"@\"+json_db[\"host\"]+\":\"+json_db[\"port\"]+\"/\"+json_db[\"path\"];\n\nconsole.log(url);\n\nIntegrate into your environment\nCreate a .environment file\nAccording to the documentation we can create an .environment file that allows us to set environment variables.\nCreate a .environment file and put what we have learned above in it, but add the output to an environment variable using export\n$ DECODED_RELATIONSHIPS=$(echo $PLATFORM_RELATIONSHIPS | base64 --decode)\n$ connect_string=$(nodejs qs.js $DECODED_RELATIONSHIPS postgresdatabase)\n$ export PS_CON_STRING=\"$connect_string\"\n\nUsing the environment variable\nYou can now use env(\"PS_CON_STRING\") in your prisma2 configuration.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Can I get a dedicated FTP/SFTP account for access to a specific directory?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/can-i-get-a-dedicated-ftp-sftp-account-for-access-to-a-specific-directory/452/2", "documentId": "f2bab7e4945e32a6d89e5eb53b89d4de5528042d", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Can I get a dedicated FTP/SFTP account for access to a specific directory?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            sftp\n          \n        \n        \n          \n            files\n          \n        \n        \n          \n            user-management\n          \n        \n        \n          \n            ssh\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              February 7, 2020,  9:04pm\n            \n        #1\n        \n      \n      \n        Can I create an SFTP account for one of my team that only allows access to one folder, not to the whole site?\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          dman\n          \n        \n\n        \n            \n            \n              February 7, 2020,  9:03pm\n            \n        #2\n        \n      \n      \n        A common requirement is to provide some sort of upload or download folder within your site, that an external tool or service may want to read or write to. This may be automated uploads of product catalogs or CSVs, or automated downloads of exported reports or backups. Generally it\u2019s a good idea to provide these automated tools with the minimum necessary privileges for their task, so a dedicated account just for the robot, with limited access, is a good way to do this.\nPlatform.sh does not allow unencrypted FTP access, you have to use SFTP.\nOn Platform Grid (Standard) you only get one login to your environment. Even when you have multiple developers with access, they all connect as the same user there. That account has visibility of your whole project, and write-access to all your writable file mounts. It\u2019s not possible to add additional users with limited access within that. You cannot \u201cchroot\u201d an account.\nYou can however add additional \u2018user\u2019 accounts to your project, and even manage access for them on a per-branch level. So adding a new \u2018user\u2019 account to your project, granting it access to a specific branch, and uploading its public ssh key will achieve most of what you need. You just need to provide it with the full directory path for its target. This account will have ssh access to upload and download files on Platform.sh as needed.\nThe SFTP credentials are the ones shown as \u201cSSH\u201d info on your project-branch console page, or can be retrieved with the  platform ssh --pipe command.\nYou must use ssh key authentication. Password only authentication is prohibited.\nRemember, your deployed environment is read-only, so the risk of allowing a daemon account access to your uploaded files is limited to those mounts that you have already designated as writeable anyway.\nFor Platform Dedicated hosting, more flexibility is possible. If needed, please raise a ticket with Platform.sh Support with your requirements.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to configure a php mail library (like Drupal 7 phpmailer) to use the correct server", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-configure-a-php-mail-library-like-drupal-7-phpmailer-to-use-the-correct-server/437", "documentId": "0689e52f3e18d127254507249cf3ce3d62bb9f01", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to configure a php mail library (like Drupal 7 phpmailer) to use the correct server\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            email\n          \n        \n        \n          \n            environments\n          \n        \n        \n          \n            smtp\n          \n        \n    \n\n\n\n\n  \n      \n        \n          dman\n          \n        \n\n        \n            \n            \n              December 30, 2019, 10:21am\n            \n        #1\n        \n      \n      \n        Goal\nTo send mail, using a third party PHP library, In a Drupal environment.\nAssumptions\n\nThis is for Drupal 7, and its phpmailer.module. However, the concepts may apply to any PHP app that needs SMTP mail server details provided to it during configuration.\nYou have admin access to your Drupal site.\nYou have write access to your sites settings.php (by way of git deployments).\nYou have read the initial docs on sending email from Platform.sh environments, and taken notes that you need to explicitly enable emails on dev environments if needed.\n\nProblems\n\nMail doesn\u2019t send, because I\u2019m using an advanced library.\nTest emails are not delivered.\nWatchdog reports, or drush wd-show shows messages like\n\n\nError sending e-mail\nSMTP Error: SMTP connect() failed.\n\nBy default, using mail() on a Platform.sh environment is already configured to just work, as\n\nThe PHP runtime is configured to send email automatically via the assigned SendGrid sub-account.\n\nHowever, if using additional mail libraries like SwiftMailer, Drupals smtp.module or phpmailer.module, the basic PHP mail() is deliberately bypassed, and additional SMTP settings are exposed, and must now be configured by you.\nSteps\nIf using Drupal 7 phpmailer:\n1. Check the settings\nAt the admin page found at\n/admin/config/system/phpmailer\ncheck the Primary SMTP server. It should not be localhost.\nIt may need to be set to whatever the value of the Platform.sh-provided environment variable PLATFORM_SMTP_HOST is for your hosting environment. This may be different depending on region or plan. Platform.sh-provided variables.\n\nHint: you can see the environment variables available to your runtime by visiting your phpinfo page at /admin/reports/status/php - though it\u2019s also available by ssh-ing in also.\nplatform ssh  \u2018echo PLATFORM_SMTP_HOST is $PLATFORM_SMTP_HOST\u2019\n\nCopy that host value (an IP) into your Primary SMTP server setting at /admin/config/system/phpmailer. The SMTP port should remain 25.\nTest that mail works by entering your email address in the Test Configuration section when you save.\n2. Configure these settings in your settings.php file, not just the UI\nFor protection against database overwrites, and to ensure the settings remain correct if you have to move servers around, it can be better to copy this environment variable out of the live environment, and into Drupals configuration settings directly.\nInspecting the settings ( drush vget smtp ) tells us that the configuration key we need to update is smtp_host.\nEdit your sites settings.php or equivalent, and add a line like:\n$conf['smtp_host'] = getenv('PLATFORM_SMTP_HOST');\n\nTest email sending works.\nConclusion\nThe mail delivery subsystem is now configured to send mail using the named server explicitly. If things change, the correct SMTP server should be updated also.\nAs noted earlier, the default behaviour with no special mail handling subsystem, is expected to work automatically. It\u2019s only the more configurable ones that may have incorrect placeholders, or may require you to provide a value explicitly.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Set up XDebug on Dedicated (Pro) server clusters", "section": "How-to Guides", "url": "https://community.platform.sh/t/set-up-xdebug-on-dedicated-pro-server-clusters/403", "documentId": "b3660faddb031b170221f72552bce223e23caf35", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Set up XDebug on Dedicated (Pro) server clusters\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            ssh-tunnel\n          \n        \n        \n          \n            debugging\n          \n        \n        \n          \n            magento\n          \n        \n        \n          \n            xdebug\n          \n        \n        \n          \n            php\n          \n        \n    \n\n\n\n\n  \n      \n        \n          dman\n          \n        \n\n        \n            \n            \n              January 8, 2020,  8:11am\n            \n        #1\n        \n      \n      \n        Use your local development environment to do breakpoint debugging on your remote server(s)\nThis document is mostly about the nuts-and-bolts of establishing communications between your local development environment and the remote servers. It\u2019s not a HOWTO use your IDE, it\u2019s about how to diagnose network or service issues that are specific to the Platform hosting environment.\nAssumptions\nYou will need:\n\nA local copy of your project site, with all code files available\nAn IDE such as PHPStorm with integrated XDebug support.\nXDebug extensions installed and activated on your environments\n\nConceptual overview\nBefore getting started, it\u2019s helpful to understand what happens at every step in an xdebugging process.\nYou normally don\u2019t have to worry about some of these layers, but if any one of them goes wrong, nothing will work, so this may help to narrow in on what does and doesn\u2019t work, when you are setting up for the first time.\nOnce all the server configurations are in place, and your IDE and the tunnels are set up to listen, what happens is this:\n\nYou initiate an xdebug session from your browser, by requesting http://your.site?XDEBUG_SESSION_START=yourxdebugkey\n\nThis request is routed to the outer (cache) layer of the hosting platform, where the presence of the XDEBUG_SESSION_START key should tell the system not to cache it.\nThe request next passes to the load-balancing router, which forwards it to one of three web heads.\nIt reaches the (nginx) webserver, which also recognises the XDEBUG_SESSION_START key, and so passes it to a dedicated xdebug-enabled php service for processing.\nThis is to avoid the performance cost of running xdebug resident or on-demand inside a production PHP service.\nPHP script execution begins, and this starts sending stack trace messages to a socket on that server ( /run/platform/${PROJECTID}${SUFFIX}/xdebug.sock ).\nYour development environment has a tunnel open to each of the three web heads, which listens to that remote socket(s), and relays these messages to a local socket (port 9000) on your development machine.\nYour IDE is configured to listen to that port, so the incoming message triggers IDE debugging.\nYour IDE is configured to map the paths of php code files on the server to your local project folders, so it\u2019s able to show you where in the local code, the remote process is currently stepping through.\nYou can use your IDE to step through the execution stack, evaluate state, or run to breakpoints. This sends messages back over the tunnel to the running process, which then executes on the server.\nEventually, execution and page build completes, and the response is sent back from the server, and your browser displays the page.\nFor subsequent browser requests, an XDEBUG_SESSION cookie should have been set, and should provide the same effect as the XDEBUG_SESSION_START parameter for subsequent requests.\n\nThat is what is supposed to happen when all is well.\nThe routing, tunneling and the multi-head delegation of requests are the quirks specific to this hosting environment that you may need to know. Other tutorials on how to xdebug Magento or remote breakpoint debugging with PHPStorm should be referred to for deeper HOWTOs.\n\nFor reference, the config settings on the server that make this happen can be inspected on the server at\n/etc/platform/$USER/php-fpm.xdebug.conf\n/etc/platform/$USER/php.xdebug.ini\n\nActivity logs are kept separate from the usual access logs, and are seen at\n/var/log/platform/$USER/xdebug.access.log\n/var/log/platform/$USER/php5-fpm-xdebug.log\n\nRemember, you are sometimes talking to three different servers at once.\nA Dedicated (Previously known as \u201cPro\u201d, \u201cPlatform Enterprise\u201d or \u201cPE\u201d) site with integrated deployment management has several web heads in the cluster.\nThis makes connecting to \u201cthe server\u201d indeterminate, as any one of three may be the server for a request, so keep this in mind as we go forwards.\nGetting started\nGetting the server configured\nFor a \u201cDedicated\u201d cluster, you need to have requested to have xdebug enabled via a support ticket to Platform.sh.\nThis may already be done for you, so please check before raising another ticket.\nThey will have set xdebug_enable: true on your project, and provided you with a unique xdebug_key to use to initiate the session.\nYour xdebug_key is usually different between your production and your staging environments. Take note of which you are using.\n\nIf xdebug has already been enabled, a record of your key may have been helpfully left in a text file /mnt/shared/ for your reference.\nIf it\u2019s not there, you can usually retrieve the xdebug key with a command like:\nplatform ssh --environment=staging 'grep -A 3  XDebug /etc/platform/$USER/nginx.conf'\n\n     # XDebug Configuration\n     ##\n     map \"$cookie_xdebug_session$arg_xdebug_session_start$arg_xdebug_session_stop\" $php_backend {\n       \"Gd6QdPZaqnnSet32\"                                      \"unix:///run/platform/myproject_stg/php5-xdebug.sock\";\n\n= Your XDEBUGKEY=Gd6QdPZaqnnSet32\nIf you can\u2019t find that key in your nginx.conf file either, then xdebug is probably not yet enabled for you, and you should raise the request.\n\nLocal environment\nAssume any debugging should be happening on staging in the first case.\n    PROJECTID=[projectID from ticket]\n    BRANCH='staging'\n\nOr if you already have the project cloned locally:\n    PROJECTID=$(platform project:info id)\n    HOSTNAME=$(platform environment:info edge_hostname)\n\nXDebug talking to multiple webheads\nTo listen to multiple possible sources of incoming xdebug connections,\nXDebug communication from all three heads need to be tunneled back to a port (9000) on our local environment.\nMost public XDebug tutorials won\u2019t allow for this multiple-head issue.\nOpen tunnels to the servers\nHere\u2019s a small script that sets up 3 simultaneous tunnels:\n\n# Set these:\nPROJECTID=\"xxxxxxxxxxxxx\"\nXDEBUGKEY=\"yyyyyyyyyyyyy\"\n\n# Optionally change these:\nBRANCH=\"staging\"; # or 'master'\nPORT=9000\n# These are the per-instance configurations you may need to change.\n\n# Review these\nURL=$( platform --project=${PROJECTID} --environment=${BRANCH} route:get 'https://{default}/' --property=url )\n[ $BRANCH = 'staging' ] &amp;&amp; SUFFIX='_stg' || SUFFIX=''\nSOCKETPATH=\"/run/platform/${PROJECTID}${SUFFIX}/xdebug.sock\"\n\nWEBHEADS=( $(platform --project=${PROJECTID} --environment=${BRANCH} ssh --pipe --all) )\n# These are settings to be used for setting up the tunnels\n\n# Now open the tunnels\nfor WEBHEAD in $WEBHEADS ; do  \n  echo \"Will listen to xdebug on webhead ${WEBHEAD}\"\n  echo \"Clearing old xdebug socket on instance.\"\n  ssh ${WEBHEAD} \"rm ${SOCKETPATH}\"\n  echo \"Opening port forwarding to xdebug socket. Listening on port ${PORT} in the background.\"\n  ssh -R ${SOCKETPATH}:localhost:${PORT} -N ${WEBHEAD} &amp;\ndone\n\nAt this point, the remote server(s) should be sending you messages back down that tunnel.\nYou next need to connect a listener on your end to do something with that info.\nTo close the tunnels\nkill $(jobs -p)\n\n\nIf using zsh, then \u201cjobs -p\u201d doesn\u2019t work as expected. Instead, \u201ckill %1 %2 %3 %4\u201d may work.\n\nIn my experience, the ssh tunnels time out on their own in about 10 minutes if idle.\nTimeout, server ssh.platform.cloud not responding.\n[1]   Exit 255                ssh -R ${SOCKETPATH}:localhost:${PORT} -N ${WEBHEAD}\n\nTo start debugging.\nLaunch your browser with the key in the URL\nopen \"${URL}?XDEBUG_SESSION_START=${XDEBUGKEY}\"\n\nDiagnostic: Ensure the request is hitting the server(s) correctly\nWhen that key is used (and is correct) during a browser session, transactions will be getting logged in xdebug.access.log\non the server(s).\nYou can check activity in these files to ensure that the request is even getting through - that it\u2019s not being cached, and that the parameter is being passed through the router without being stripped.\nThe following command will summarize the most recent xdebug.access.log from all webheads at once.\nWEBHEADS=$(platform ssh --project=$PROJECTID --environment=staging --pipe --all)\necho $WEBHEADS | xargs -I% ssh % 'tail /var/log/platform/$USER/xdebug.access.log'\n\nReasons the XDebug session may not be getting logged in xdebug.access.log\n\n\nYou have three web heads, the load balancer may be sending your request to any one of them. You need to check all logs on all instances at once, not just one.\nYour $XDEBUGKEY is wrong. Double-check against the value in /etc/platform/$USER/nginx.conf.\nThe URL you used was for a different branch than the one you are looking at\nThe outside cache layer is intercepting the request. You can check if it\u2019s cached using wget -I\n\nThe inside router is not recognising or honoring the XDEBUGKEY\n\nNginx is performing a redirect or an access denied before the request can be routed to php. You\u2019ll need your IP to be whitelisted if using HTTP access controls.\nThe xdebug php service (site-$USER-xdebug-php) is not running or responding. You should see it in the server process list (ps -axf).\n\nInvestigating\nThings don\u2019t always go smoothly, so here is a process of elimination to ensure that all things are set up as expected.\nTo verify that xdebug configs have been deployed on the host(s)\nYou can see the settings on the servers in /etc/platform/${PROJECTID}${SUFFIX}/php.xdebug.ini,\nlooking like\n    xdebug.remote_host = unix:///run/platform/xxxxxxxxxxxxx_stg/xdebug.sock\n\nTo verify that xdebug is being loaded by PHP\nYou may be able to check out a phpinfo diagnostic from within your web application and confirm xdebug is running.\nIn Drupal this can be found underneath reports.\nDon\u2019t verify using php -m command\n\nNote: Running basic diagnostics like commandline php -i on the server\nmay not show that xdebug is enabled as php can be configured to use different settings\nfor commandline than it does for web requests. The files php-fpm.conf, php-cli.conf, and php-fpm.xdebug.conf\n(deployed into in the apps etc folder) are different in that way, and are each used depending upon context of the request.\n\nTo verify that the xdebug process is active\nxdebug.access.log\nThe xdebug.conf  tells us that the logs are at /var/log/platform/$USER/xdebug.access.log\nTailing that log should show some current activity when a browser session activates xdebug with the xdebug key.\nWhen connected to an instance,\n tail -f /var/log/platform/${USER}/xdebug.access.log\n\nOr called directly from your environment:\necho tail /var/log/platform/${PROJECTID}${SUFFIX}/xdebug.access.log | platform --project=${PROJECTID} --environment=${BRANCH} ssh\n\necho tail /var/log/platform/${PROJECTID}${SUFFIX}/error.log | platform --project=${PROJECTID} --environment=${BRANCH} ssh\n\n\nBeware, the requests will actually happen on more than one instance, so you will only see some of the requests. Use tmux or similar tools to watch them all simultaneously.\n\nGotcha if using non-standard project names\nMost dedicated hosting plans name your docroot after your project ID. Such as qazqaz234qaz or qazqaz234qaz_stg. Thus is the assumption used in the tunnel script that is configured to listen to the xdebug socket /run/platform/qazqaz234qaz/php5-xdebug.sock . However, if you are using a non-standard or legacy docroot name, some of these paths need to be updated. The socket may instead be something like /run/platform/shoppingsite/php5-xdebug.sock.\nDiagnosing if the cache layer is interfering\nIf your outer cache layer (eg Fastly) is returning a previously cached version of the page, you will seem to be getting debuggable transactions at first, but later requests will fail to debug, sometimes unpredictably.\nUse curl -I \"${URL}?XDEBUG_SESSION_START=${XDEBUGKEY}\" a couple of times in a row, and look for x-cache: HIT, HIT in the response.\nIf this is happening, you need to bypass the cache. This may be possible by disabling your cache, or configuring it to use the presence of the XDEBUG_SESSION_START argument to prevent caching - using the cache management configurations if you have access to them.\nTo verify that the socket is open for communication with the debugger client\nAfter the client sets up a tunnel from their development side, the socket file mentioned in the configs\nshould be seen on each of the servers.\nls -la /run/platform/${USER}/xdebug.sock\n\nYou should check to see that the last-modified date on it is recent - that reflects the last time the socket was set up.\n\nBeware timezones on the server are likely to be quite different to your own!\nCompare the date against the server time!\necho $(( $(date +%s) - $(stat -c%Y \"/run/platform/${USER}/xdebug.sock\") )) seconds old.`\n\n\n\nNote: Don\u2019t get distracted by php5-xdebug.sock seen in the same directory, that\u2019s an internal socket used for communication between php-fpm and nginx\n\nTo verify that messages are being sent down the pipe to the debugger client\nListen for a bit\nWhen the tunnels are active, port 9000 on the developers machine is a window into the xdebug process.\nIf it seems that xdebug is not firing at all, on the server you may sniff what\u2019s happening on port 9000 with something like\nAs a very basic test, running\nnetcat --listen --local-port 9000\n\non the developer machine, and then visiting the website with the XDEBUG_SESSION_START key in the URL (or the XDEBUG_CONFIG set in a CLI environment) should result in the first raw xdebug message being shown on your console.\nIt\u2019s an XML packet in the DBGp protocol.\nDoing this will stall the server, as you will not be able to respond with the expected sort of acknowledgements (just exit out)\nbut if you get any sort of initial packet sent to that port, it shows that something xdebug is happening, and you need to work on the tunnels.\nIt seems that unless you acknowledge that first message appropriately, no subsequent ones will be sent, and the server will hang there until you kill one end of the conversation, so there is a limit to what can be done without a real debugging tool, but this may at least prove that messages are getting through to the developers desktop.\nDephpugger is a quick CLI tool for this, but you probably want to just go straight to using a real IDE.\nUsing an IDE to listen to xdebug messages\nWith something like PHPStorm, you can just \u2018start listening\u2019 to port 9000 and when the first message arrives from the server, the wizard will ask you to match the incoming request (eg /app/${PROJECTID}_stg/index.php )\nto a local file to begin breakpoint debugging. If you don\u2019t have a local checkout of the project, well, you need to go get one to proceed now.\nXDebug on cli\n\nNote that xdebugging on the CLI does NOT log into the access log (not even the xdebug.access.log which is for web requests)\nso looking for clues there will not help.\n\nYou can trigger xdebug behaviour on the CLI\n\nusing a custom php.ini,\nby setting an environment variable export XDEBUG_CONFIG=\"remote_enable=1\"\n\nor by specifying everything up front in the commandline arguments\n\n\u2026though all methods ALSO need XDEBUG_CONFIG to at least be set to SOMETHING.\nTo test XDebug is working in a snippet\nAs a single command is the most straightforward for testing, XDebug can be triggered minimally with:\n# On the host:\nSOCKETPATH=\"unix:///run/platform/${USER}/xdebug.sock\"\nexport XDEBUG_CONFIG=\"remote_enable=1 remote_host=$SOCKETPATH\"\nphp \\\n  -dzend_extension=xdebug.so \\\n  index.php\n\nIf you have a listener open on port 9000 on your local dev, it\u2019ll start getting messages.\nI haven\u2019t been able to find a way to get logs of these transactions, so it\u2019s up to you to be listening correctly.\nTo use the php.xdebug.ini\n\nTo work as designed however, a php.xdebug.ini has been provided.\nTo use that, you should invoke php, source the special ini, and also must set XDEBUG_CONFIG to non-null in your session.\nPHPXDEBUG=/etc/platform/${USER}/php.xdebug.ini\nexport XDEBUG_CONFIG=true\nphp -c $PHPXDEBUG index.php\n\n\u2026 and stuff should be coming down the socket.\nInteresting snippets:\nPHPXDEBUG=/etc/platform/$USER/php.xdebug.ini\nphp -c $PHPXDEBUG -r \u2018echo(ini_get(\u201cxdebug.idekey\u201d));\u2019\nGo and trace your project\nThe real fun begins after the tunnels are set up and the XDebug communications are happening. Other tutorials from your IDE will probably be more helpful than can be covered here.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to use wkhtmltopdf on platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-use-wkhtmltopdf-on-platform-sh/445", "documentId": "215343332625050fbc5fefc48ffd57aea353c900", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to use wkhtmltopdf on platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            drupal\n          \n        \n        \n          \n            wkhtmltopdf\n          \n        \n        \n          \n            pdf\n          \n        \n        \n          \n            php\n          \n        \n    \n\n\n\n\n  \n      \n        \n          matthias-van-woensel\n          \n        \n\n        \n            \n            \n              February 7, 2020,  7:34pm\n            \n        #1\n        \n      \n      \n        Goal\nwkhtmltopdf is a tool to generate PDF files from HTML. It can also be used from within drupal. This article will explain how to install it on platform.sh\nInstalling\nYou can install the wkhtmltopdf-binary using the ruby gem. You do not need to run ruby to be able to use this.\nAdd this to your .platform.app.yaml dependencies to install:\ndependencies:\n    ruby:\n        \"wkhtmltopdf-binary\": \"&gt; 0.12.5.1\"\n\nNote that you can specify the binary version. Check the ruby gem maintainer for a full list of all versions.\nImportant: Make sure you also add wkhtmltopdf -V to your build hook. This is needed because of the way the ruby gem works. The first time it runs, it unpacks the correct binary into your /app folder. And since we have a read-only files system by design, this can only be done in the build hook.\nhooks:\n    build: |\n        wkhtmltopdf -V\n\nUsage\nWhen you\u2019re using the drupal wkhtmltopdf it should already be working.\nYou can also use a wrapper e.g.\n\n  \n      \n      GitHub\n  \n  \n    \n\nmikehaertl/phpwkhtmltopdf\n\nA slim PHP wrapper around wkhtmltopdf with an easy to use and clean OOP interface - mikehaertl/phpwkhtmltopdf\n\n\n  \n  \n    \n    \n  \n  \n\n\nThe default examples should work\nuse mikehaertl\\wkhtmlto\\Pdf;\n\n// You can pass a filename, a HTML string, an URL or an options array to the constructor\n$pdf = new Pdf('/path/to/page.html');\n\nif (!$pdf-&gt;saveAs('/path/to/page.pdf')) {\n    $error = $pdf-&gt;getError();\n    // ... handle error here\n}\n\nIf you have any other way of using it, make sure you are calling the alias wkhtmltopdf. Don\u2019t use /app/.global/gems/wkhtmltopdf-binary-0.12.5/bin/wkhtmltopdf because that will cause problems upon upgrading the version.\ne.g.\n&lt;?php\nsystem('wkhtmltopdf https://platform.sh platformsh.pdf');\n\nPossible issues\nI\u2019m getting SSL errors when generating a page.\nwkhtmltopdf is a headless webbrowser that opens your html and all assests (img, css, js). Make sure all assets are referenced relatively and do not have an absolute path. If you still continue to see errors, try upgrading to the next version of wkhtmltopdf.\nError: Failed loading page xxxxx (sometimes it will work just to ignore this error with --load-error-handling ignore)\nSee above.\nNo stderr output available\nwkhtmltopdf [\"/app/.global/bin/wkhtmltopdf\" -q --page-size A4 --orientation portrait --dpi 96 - -] (returned 1): No stderr output available.\n\nHave you put wkhtmltopdf -V in the build hook? Are you seeing errors in the build hook as well?\nMy wkhtmltopdf version suddenly upgraded to a newer version and no longer works!\nYou probably haven\u2019t defined a version for wkhtmltopdf-binary\nChange this:\ndependencies:\n  ruby:\n    \"wkhtmltopdf-binary\": \"&gt; 0.0\"\n\nto this:\ndependencies:\n  ruby:\n    \"wkhtmltopdf-binary\": \"&gt; 0.12.5\"\n\nor any other version you specifically require.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to set up automated environment tasks", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-set-up-automated-environment-tasks/127", "documentId": "93daa53e63c36c5bdb3cc34ad9bec4cfdf83d321", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to set up automated environment tasks\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            snapshots\n          \n        \n        \n          \n            cron\n          \n        \n        \n          \n            redeploy\n          \n        \n        \n          \n            backups\n          \n        \n    \n\n\n\n\n  \n      \n        \n          bogdan-vasilescu\n          \n        \n\n        \n            \n            \n              February 12, 2020,  9:04pm\n            \n        #1\n        \n      \n      \n        Goal\nTo have one more more environments automatically backed up through snapshots triggered without manual intervention.\nAssumptions\n\nAccess to a project hosted on Platform.sh\n\nYour project account has administrator rights\nKnowledge on using the project web interface or the Platform.sh CLI\n\nCLI tool set up in the environment, as described in this how-to\n\n\nProblems\nThe snapshot process is not automated and requires a manual trigger using the CLI or web interface.\nSteps\n1. Check the CLI tool is correctly installed in the environment\nAfter logging in with SSH in the environment, you should be able to run platform and see the welcome prompt, together with a list of your projects.\n2. Add a cron for automated environment snapshots\nEdit your .platform.app.yaml file and add the snapshot command in a cron. Example:\ncrons:\n    auto_snapshot:\n        # The cron task will run everyday at 4 am (UTC)\n        spec: '0 4 * * *'\n        cmd: |\n            if [ \"$PLATFORM_BRANCH\" = master ]; then\n                 platform backup:create --yes --no-wait\n            fi\n\nThe PLATFORM_BRANCH variable check ensures automatic snapshots are done only on the master environment. The --yes flag skips user interaction for the snapshot command. Ensure the --no-wait parameter is added to the command, in order to make the operation non-blocking (otherwise, your site will be down until the snapshot operation is completed).\n3. Add a cron for automated SSL certificate renewal\nThe provided Let\u2019s Encrypt certificates have to be renewed every 3 months. The renewal is done automatically on every deployment, but if you do not deploy that often it is possible to have the SSL certificate expire. In order to ensure this does not happen, you can configure a cron job to automatically redeploy your environment. If there are no code changes, this will happen very fast and ensure your SSL certificate is refreshed.\nTo do this, you need to edit your .platform.app.yaml just like before and add a cron job like in this example:\ncrons:\n    auto_renewcert:\n        # Force a redeploy at 10 am (UTC) on the 1st and 15th of every month.\n        spec: '0 10 1,15 * *'\n        cmd: |\n            if [ \"$PLATFORM_BRANCH\" = master ]; then\n                platform redeploy --yes --no-wait\n            fi\n\nLike above, PLATFORM_BRANCH variable check ensures the redeployment is done only on the master environment.\nConclusion\nAfter setting up the CLI tool in the environment, we learned how to use it in order to trigger various maintenance tasks for the project.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    Consequences of restoring backups after the persistent data model has been changed\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to flush the Fastly cache", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-flush-the-fastly-cache/484", "documentId": "d81fcee262a0467bb9024c7df5ae99a6c67051d2", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to flush the Fastly cache\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            cache\n          \n        \n        \n          \n            fastly\n          \n        \n    \n\n\n\n\n  \n      \n        \n          dman\n          \n        \n\n        \n            \n            \n              March 6, 2020,  2:46am\n            \n        #1\n        \n      \n      \n        Goal\nTo purge all cached assets from the CDN layer sitting in front of your site.\nAssumptions\nYou will need:\n\nTo have Fastly cache running in front of your site\nThe ability to run curl from your local terminal,\nWorking access to the platform command for your project\nOR\nRead access to the Variables on your project through the web console.\n\nProblems\nFor most Enterprise or Premium plans, The Platform.sh setup team has configured Fastly CDN for you, and manages it on your behalf with a built-in account. This means you do not have direct administration access using the Fastly web UI, where a \u2018Purge\u2019 button can be found.\nHowever, you have been issued with an \u201cAPI\u201d key that allows you access to many actions on your account, and you can initiate a purge using this.\nTo purge a single page\nFastly lets you purge individual URLs with no authentication.\ncurl -X PURGE $url\n\nThat\u2019s it!\nTo Purge all\nYou need use the API key.\nAll projects with Fastly configured should have had the env:FASTLY_API_TOKEN set in their\n/master/settings/variables\nThis key can be used to construct a purge_all API request.\nThe Fastly API documentation says to construct a request like this:\nPOST /service/SU1Z0isxPaozGVKXdv0eY/purge_all HTTP/1.1\nFastly-Key: YOUR_FASTLY_TOKEN\nAccept: application/json\n\nSo, from a local CLI, run this sequence to retrieve your keys:\n(or you can just set the variables to the values you can see in the web console yourself)\nFASTLY_SERVICE_ID=$(platform --project=$PROJECTID --environment=master variable:get env:FASTLY_SERVICE_ID --pipe)\nFASTLY_API_TOKEN=$(platform --project=$PROJECTID --environment=master variable:get env:FASTLY_API_TOKEN --pipe)\nFASTLY_API_URL=\"https://api.fastly.com\"\n    \ncurl -H \"Fastly-Key: $FASTLY_API_TOKEN\" \\\n  -X POST \"${FASTLY_API_URL}/service/${FASTLY_SERVICE_ID}/purge_all\"\n\neg:\ncurl -H Fastly-Key: nfDDFUahPwV4wQiJOMbLwJsCBy3Wh4TQ -X POST https://api.fastly.com/service/nOBmPqIK5M71NgZMhLYTZk/purge_all\n\n{\"status\":\"ok\"}\n\nVerify it really worked\nTo empirically test, you could retrieve a page from your site and see if it looks right   , or immediately make a network request and check the cache headers and dates:\ncurl -I -s $url\n\nHTTP/2 200\n...\ncache-control: max-age=3600, public\nlast-modified: Fri, 06 Mar 2020 01:36:16 GMT\ndate: Fri, 06 Mar 2020 02:26:54 GMT\n...\nvia: 1.1 varnish\nage: 0\nx-served-by: cache-syd10142-SYD, cache-hkg17927-HKG\nx-cache: MISS, MISS\n\nThe x-served-by and via confirm that a cache is working.\nUnless someone else has already requested this page just ahead of you, you should see a MISS in the x-cache.\nEither way, the age (in seconds) should be low, and the date should be fresh. Ignore the last-modified\nVerify via API (just FYI)\nTo verify the command ran as expected, you can retrieve a list of the recent events, with a command like:\ncurl -H \"Fastly-Key: $FASTLY_API_TOKEN\"  -X GET \"${FASTLY_API_URL}/events?page[number]=1&amp;page[size]=10\"\n\n\u2026which should return a response including something like:\n    {\n      \"id\": \"miaXP6k1OLwUdOIXcKkiHG\",\n      \"type\": \"event\",\n      \"attributes\": {\n        \"customer_id\": \"rSam6DCAgeyDU7gSoC5pJi\",\n        \"description\": \"Purge all was performed\",\n        \"event_type\": \"service.purge_all\",\n        \"ip\": \"118.173.60.218, 118.173.60.218\",\n        \"metadata\": {},\n        \"service_id\": \"ZknOBmPqIK5M71NgZMhLYT\",\n        \"user_id\": \"TdqCvp120Tm185r3gn4DYR\",\n        \"created_at\": \"2020-03-06T01:35:35Z\",\n        \"admin\": false\n      }\n    },\n\nConclusion\nThis is a quick method to flush your CDN cache as needed.\nThere are many other actions possible through the Fastly API though not all will be available to the account granted with that API key.\nIf you are using a CMS like Drupal, then a Fastly module can be installed to integrate cache management into your CMS. This provides an easier interface to actions like this. This approach also lets the CMS invoke a CDN purge when things change, so is recommended if you need to tune things finer.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to compile CSS using SASS on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-compile-css-using-sass-on-platform-sh/129", "documentId": "094eb82848e60a44d7aebe40a324bd89e68c2da2", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to compile CSS using SASS on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            css\n          \n        \n        \n          \n            sass\n          \n        \n    \n\n\n\n\n  \n      \n        \n          jonaskroeger\n          \n        \n\n        \n            \n            \n              February 18, 2020,  2:20am\n            \n        #1\n        \n      \n      \n        Goal\nHave your SCSS Code compiled to CSS during deployment on Platform.sh\nAssumptions\n\nAn empty Platform.sh project\nA local git repository, with Platform.as as a remote\nKnowledge of how to serve a static HTML page on Platform.sh\n\n\nSteps\n1. Create a HTML file and link style.css.\n./web/index.html\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n  &lt;link rel=\"stylesheet\" href=\"style.css\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\t&lt;h1&gt;Foobar&lt;/h1&gt;\n  &lt;p&gt;lorem ipsum&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n\n2. Create a SCSS file .\n./scss/style.scss\n$colors: (\n  background: rgb(26, 25, 43),\n  text: rgb(255, 255, 255),\n);\n\nbody {\n  background-color: map-get($colors, 'background');\n  color: map-get($colors, 'text');\n}\n\n3. Define default routes.\n./.platform/routes.yaml\nhttps://{default}/:\n    type: upstream\n    upstream: sasshowto:http    \n\n4. Add empty services (we don\u2019t need any in this example).\n./.platform/services.yaml\n# empty\n\n5. Add .platform.app.yaml configuration.\n./.platform.app.yaml\nname: sasshowto\n\n# Any type will work as we just serve static HTML\ntype: \"php:7.3\"\n\n# Install sass from npm\ndependencies:\n  nodejs:\n    sass: '~1.17.2'\n\n# Compile sass to css during the build hook and save output to web/style.css with compressed css for production\nhooks:\n    build: |\n        sass --style compressed scss/style.scss web/style.css\n\ndisk: 256\nweb:\n    locations:\n        \"/\":\n            # This tells Nginx to serve from the base directory\n            root: \"web\"\n            index:\n                - \"index.html\"\n\n6. Add, commit, and push these files to your empty Platform.sh project.\ngit add .\ngit commit -m \"Compile SASS to CSS\"\ngit push -u platform master\n\n7. Test by visiting the URL of your environment.\nCheck that white text on a dark blue background is visible on the site.\nplatform url\nConclusion\nEvery time the project is pushed to Platform.sh, compressed CSS will be generated from your SCSS-File and put into web/style.css.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to determine database usage of an environment", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-determine-database-usage-of-an-environment/180", "documentId": "2d38efd8144cac036f7ca67fec732cf44d7bd441", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to determine database usage of an environment\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            storage\n          \n        \n        \n          \n            disk\n          \n        \n        \n          \n            databases\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          tristan-blattman\n          \n        \n\n        \n            \n            \n              February 19, 2020, 11:34am\n            \n        #1\n        \n      \n      \n        Goal\nDetermine approximate database usage of a Platform.sh project using the Platform.sh CLI tool.\nAssumptions\n\nOne or more Platform.sh projects\n\nPlatform.sh CLI tool installed locally\n\nSSH key configured with the project account(s)\n\nProblems\nAs a general rule, the database service should have at least 15% of disk space available on a Platform.sh project environment, so it is useful to be able to approximate the current disk usage of a project\u2019s database(s).\nSteps\n1. Log in to Platform CLI\n$ platform login\n\n2. Find the project ID\nNote the project ID of the project you\u2019re checking:\n$ platform project:list\n\n3. Find the environment ID\nNote the environment ID for the environment you\u2019re checking.\n$ platform environment:list -p &lt;project-ID&gt;\n\n4. Run the database size command\n$ platform db:size -p &lt;project-ID&gt; -e &lt;environment-ID&gt;\n\nThe command will return something like:\n+----------------+-----------------+--------+\n| Allocated disk | Estimated usage | % used |\n+----------------+-----------------+--------+\n| 14.6 GiB       | 9.4 GiB         | ~ 64%  |\n+----------------+-----------------+--------+\n\n\nWarning\nThis is an estimate of the databases disk usage. It does not represent its real size on disk.\n\nConclusion\nObtaining an approximate measure of your database usage can be done from the command line using the Platform.sh CLI tool.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    Where is my database storage going to?\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "If I add a service, can I still restore a snapshot from before that service existed?", "section": "Questions & Answers", "url": "https://community.platform.sh/t/if-i-add-a-service-can-i-still-restore-a-snapshot-from-before-that-service-existed/298/2", "documentId": "b2d81f8858009b870e9e245eedf6e3c619ff1fa6", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  If I add a service, can I still restore a snapshot from before that service existed?\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n    \n        \n          \n            backups\n          \n        \n    \n\n\n\n\n  \n      \n        \n          platform-qa\n          \n        \n\n        \n            \n            \n              June 3, 2019,  3:40pm\n            \n        #1\n        \n      \n      \n        Adding a new service (eg. a new MongoDB) changes the persistent data model of my project. Does that render it incompatible with backups/snapshots made before?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              February 12, 2020, 10:20pm\n            \n        #2\n        \n      \n      \n        Yes, a backup taken before service was added will be incompatible with your configuration.\nA backup is a collection of the persistent storage backups for each service (and application) containers. When a restore takes place, each of those individual backups is applied to each service one by one. Of course, the new MongoDB service is not included in that backup, but the problem occurs in the step right before the backups are applied.\nAll of the persistent data in the environment is erased first, in order to make way for the backups to be applied. This, in combination with MongoDB missing from the backup, will result in data loss.\nYou can take a look at the tutorial here for a more comprehensive look at some of these consequences in this case and in the case of newly added mounts.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to fail a build on failing unit tests", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-fail-a-build-on-failing-unit-tests/57", "documentId": "2996a2ff7f5331871ab5886ae99819793bdde41f", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to fail a build on failing unit tests\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            testing\n          \n        \n        \n          \n            npm\n          \n        \n        \n          \n            php\n          \n        \n    \n\n\n\n\n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n            \n              March 19, 2019, 10:28pm\n            \n        #1\n        \n      \n      \n        Goal\nEvery time a push is made, run all unit tests.  If tests fail, the build should fail and not be deployed.\nAssumptions\nDuring the build phase no services are available.  That means only tests that can run with only your code (no database, no web requests, etc.) can be run.  Most testing frameworks have a way to define test suites and run only a selected set of them.  This guide assumes you have defined a test suite that is safe to run in isolation.\nAlthough this example uses PHP the process is essentially identical for any language, provide its test runner follows standard Unix error conventions.\nSteps\n1. Ensure that your test framework is included in your list of project dependencies\nFor a PHP application that would mean composer.json.  For a Node.js application it would mean package.json.  For PHP:\n{\n    \"requires-dev\": {\n        \"phpunit/phpunit\": \"^7.5\"\n    }\n}\n\n(By default Platform.sh installs dev dependencies as well, so it will be downloaded by default.)\n2. Add set -e as the first line of your build hook\nIn .platform.app.yaml, locate your build hook and add set -e as the first line.  If one does not exist go ahead and create it.\nhooks:\n    build:\n        set -e\n\nThat tells the system to fail the build if any command in the build hook returns an error code.\n3. Add your test command as the last step of your build hook\nAfter all other tasks in your build hook have run, add a line to run your tests.  For PHP your build hook will look like this:\nhooks:\n    build:\n        set -e\n        # Possibly other stuff here\n        vendor/bin/phpunit\n\nFor Node.js it will look like this:\nhooks:\n    build:\n        set -e\n        # Possibly other stuff here\n        npm test\n\n4. Commit the result and push\ngit add composer.json .platform.app.yaml\ngit commit -m \"Enable build tests\"\n\nConclusion\nIf the test command fails a test it will return a non-0 error code to the shell.  The set -e flag means that error will cause the whole build process to fail and the container will not be deployed.  If no tests fail then the test command will return 0, allowing the build to proceed.\nThe output of the test runner will be available in the build log.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    Using platform.sh environments for continuous integration / functional tests\n                  \n                \n          \n\n  \n  \n      \n        \n          lukas-smith\n          \n        \n\n        \n            \n              March 6, 2020,  7:58am\n            \n        #2\n        \n      \n      \n        But what if my tests need access to a service, specifically a database?\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              March 6, 2020,  4:08pm\n            \n        #3\n        \n      \n      \n        Those don\u2019t work in the build environment.  (Also, they\u2019re not technically unit tests at that point.)\nIf you need tests that run on a service, you could use a post-deploy hook and have it run only on non-master branches.  That wouldn\u2019t block the deploy of course, but it would still give you an automated test run.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to run CryptPad on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-run-cryptpad-on-platform-sh/486", "documentId": "36cad684f52cc4fab42f69543afb51dc55f5ce9a", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to run CryptPad on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            nodejs\n          \n        \n    \n\n\n\n\n  \n      \n        \n          kotnik\n          \n        \n\n        \n            \n            \n              March 8, 2020,  9:16pm\n            \n        #1\n        \n      \n      \n        Goal\nHere you can find what is needed to run CryptPad on Platform.sh. You will see soon that it doesn\u2019t take much at all, and very quickly you will be able to collaborate on slides, sheets, and other types of documents in secure and private manner.\nTL;DR Clone CryptPad, cherry pick my commit, push to fresh Platform.sh project, profffit.\nHere\u2019s what you can collaborate on with CryptPad:\n\nScreenshot from 2020-03-08 21-00-16.png740\u00d7754 165 KB\n\nIt\u2019s like Google Docs or Microsoft Office365, but on your own: you own the data, and it is protected at rest. Interested? Let\u2019s go.\nAssumptions\nYou will need:\n\n\nBasic knowledge of how Platform.sh works.\nYou have run at least one project on Platform.sh, so we don\u2019t have to go over git and other primitives here.\n\nSteps\nBefore we go to steps you can pick up this complete Github repo, push it to your Platform.sh project, and you will have fully working CryptPad copy. You can see this repo running in my project.\nAnd now, here are all the steps I took to make it happen.\n1. Fork it - Clone it - Branch it\nSo I forked original XWiki repo to my own Github account and cloned it. I will paste my own command, but please adjust it for your own username and URL:\ngit clone git@github.com:kotnik/cryptpad.git\ncd cryptpad\n\nOk, origin remote is Github one. Sweet. Next, I wanted to use the latest CryptPad release, which at the time of writing this is 3.12.0, and name that branch platform, you can guess why. Let\u2019s go:\ngit checkout -b platform tags/3.12.0\n\nEasier to do than to describe.\n2. Create Platform.sh project\nSo go and create new project. It can be trial too. It\u2019s fast, I\u2019ll wait.\n3. Hook it up - Basics\nAs you already probably know, there are only a few things Platform.sh needs to know before it is able to run your application:\n\n\nYour app description: what it runs on, how to build it, how to serve it, etc. It\u2019s that .platform.app.yaml file.\n\nServices your app is using. It\u2019s easy here because CryptPad uses no external services and keeps everything on the disk.\nYour routes, how to access your application. And only here we have one small gotcha that is crucial, we\u2019ll cover it below.\n\nBut first, let\u2019s add Platform.sh project remote to our repo:\nplatform project:set-remote &lt;YOUR PROJECT ID&gt;\n\n4. Hook it up - Describing the app\nHere it is, full and fully commented .platform.app.yaml file:\nname: cryptpad\n# CryptPad needs to run on Node 12.\ntype: nodejs:12\n\nvariables:\n  env:\n    # This tells the app how to create encryption key. Refer its documentation for more info.\n    FRESH: 1\n    # No, don't sweat it, you're behind proxy and we got TLS all figured out :slight_smile:.\n    USE_SSL: \"false\"\n\nweb:\n  commands:\n    # I love Express framework apps, they're so easy to run!\n    start: \"node ./server.js\"\n\nbuild:\n  # Let me handle it, don't be smart.\n  flavor: none\n\nhooks:\n  build: |\n    npm install\n    # Make our life easier with official Platform.sh helper.\n    npm install platformsh-config@2.3.1\n    bower install\n    # This is the configuration file, more about this one later.\n    cp config.platformsh.js config/config.js\n\ndependencies:\n  nodejs:\n    bower: \"^1.8.8\"\n\nmounts:\n   datastore:\n       source: local\n       source_path: datastore\n   data:\n       source: local\n       source_path: data\n   block:\n       source: local\n       source_path: block\n   blob:\n       source: local\n       source_path: blob\n\n# Starting with half of a gigabyte. It's easy to bump it up, so you choose.\ndisk: 512\n\n5. Hook it up - Services and routes\nNow we need to tell Platform.sh what we need for the application to run, and where one can find it.\nAs for services, there\u2019s nothing we need, so use this for .platform/services.yaml file:\n# No needs\n\nYou do need it, even an empty one. Next, here are the routes you need to put in your .platform/routes.yaml file:\n\"https://{default}/\":\n  type: upstream\n  upstream: \"cryptpad:http\"\n\n\"https://{default}/cryptpad_websocket\":\n  type: upstream\n  upstream: \"cryptpad:http\"\n  cache:\n    enabled: false\n\nAnd this is the only tricky part of this how-to, the one I figured out the hard way: CryptPad uses WebSockets to talk with browsers and you must have that second entry in routes.yaml to disable caching it, or your app will simply not work. We got you covered but CryptPad people should have this endpoint mentioned on their installation page.\n6. Hook it up - Configure app itself\nCryptPad looks at config/config.js file by default for configuration instructions. This file is rather long so I will not include it here, you can take it yourself and save it to config.platform.js. It\u2019s well documented so you should have no problems figuring out what to do.\n7. Run it\nThis is it, after defining your application (with .platform.app.yaml, .platform/services.yaml and .platform/routes.yaml in place) and instructing how your CryptPad should behave (file config.platform.js is ready), you can simply commit all this and push it to your Platform.sh project:\ngit add .platform.app.yaml .platform/services.yaml .platform/routes.yaml config.platform.js\ngit commit -m 'Platformize'\ngit push platform -u platform:master\n\nAfter building and deploying your application, your project will inform you where your CryptPad is and you can start using it right away!\nHappy hacking on Platform.sh!\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to run Grocy on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-run-grocy-on-platform-sh/498", "documentId": "ec74f3dd4e5cd3183b055ba4aaed7fb8c903adee", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to run Grocy on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          kotnik\n          \n        \n\n        \n            \n              March 18, 2020,  1:50pm\n            \n        #1\n        \n      \n      \n        Goal\nGrocy is an awesome app one can use to manage groceries, food stock, recipes, chores and more. It\u2019s like a personal ERP, I am using it to hoard responsibly without wasting food and other household items.\nHere\u2019s how it looks like:\n\nScreenshot from 2020-03-16 17-02-06.png1594\u00d7840 88.6 KB\n\nIt is very easy to run Grocy on Platform.sh, and I will show you here what it takes. You can always fork this run-ready repo, and have it running in seconds.\nAssumptions\nYou will need:\n\n\nPlatform.sh project, it can be development sized one too.\n\nSteps\nClone your Platform.sh project locally first:\nplatform get &lt;project id&gt;\n\nIt should be fresh and empty project. Now, let\u2019s add Grocy as submodule so we can upgrade easily when new version is released:\ncd &lt;project id&gt;\ngit submodule add https://github.com/grocy/grocy.git\ngit submodule init\ngit submodule update\ncd grocy\ngit checkout v2.6.1\ncd ..\ngit add .\ngit commit -am 'Added Grocy 2.6.1'\n\nOK, latest Grocy is ready. Now, let\u2019s add some info so Platform.sh knows how to run it. Grocy itself is not using any additional services, all the data is kept in a file, so let\u2019s create empty .platform/services.yaml file:\n# No need for services\n\nRoutes can be default ones, have this in .platform/routes.yaml:\n\"https://{default}/\":\n    type: upstream\n    upstream: \"app:http\"\n\n\"http://{default}/\":\n    type: redirect\n    to: \"https://{default}/\"\n\nGood. Now, let\u2019s create .platform.app.yaml. You can take complete file from here, but here we\u2019ll cover it section by section.\nGrocy, at the time this is written, needs PHP 7.2 so let\u2019s use that:\nname: 'app'\ntype: 'php:7.2'\n\nIt keeps all the data in single file with db extension it searches for in data/ directory. So, let\u2019s give it writable permanent mount there:\ndisk: 512\n\nmounts:\n    '/data':\n        source: local\n        source_path: 'data'\n\nFor build it only requires yarn around, so let\u2019s get it:\nbuild:\n    flavor: none\n\ndependencies:\n    nodejs:\n        yarn: \"*\"\n\nNow, this is the build hook:\nhooks:\n    build: |\n        set -e\n        mkdir -p www\n\n        cd www\n        ln -s ../data/data data\n        cd ..\n\n        mv grocy/public www\n        mv grocy/controllers www\n        mv grocy/helpers www\n        mv grocy/localization www\n        mv grocy/middleware www\n        mv grocy/migrations www\n        mv grocy/publication_assets www\n        mv grocy/services www\n        mv grocy/views www\n        mv grocy/composer.* www\n        mv grocy/.yarnrc www\n        mv grocy/yarn.* www\n        mv grocy/*.php www\n        mv grocy/*.json www\n\n        cd www\n        composer install\n        yarn install\n\nThis results with built app in www sub-directory. Notice the trick we did with the data directory. By Grocy\u2019s own installation documentation, /data directory keeps cache and plugins as well (structure is provided in the repo of the app itself), not just the data created by user. So we link it to the permanent mount and then copy the provided plugins in the deploy hook:\nhooks:\n    deploy: |\n        set -e\n        mkdir -p data/data/viewcache\n        cp -rp grocy/data/* data/data\n        cp config.php data/data\n\nDeploy hook also provides configuration file config.php. You can look at the defaults, but at least you should disable PHP\u2019s error reporting since it breaks session management:\n&lt;?php\n\nerror_reporting(E_ERROR | E_PARSE);\n\nThe only thing that\u2019s left is describing how to serve the application, and that\u2019s fairly easy:\nweb:\n    locations:\n        '/':\n            root: 'www/public'\n            expires: 5m\n            passthru: '/index.php'\n            allow: false\n            rules:\n                '\\.(jpe?g|png|gif|svgz?|css|js|map|ico|bmp|eot|woff2?|otf|ttf)$':\n                    allow: true\n                    expires: 2w\n\nAnd that is it, you\u2019re now ready to run Grocy and manage your household like a proper company.\n      \n\n      \n\n      \n         \n         \n         2 Likes\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to access InfluxDB credentials on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-access-influxdb-credentials-on-platform-sh/148", "documentId": "fee55dd80b232511d2aabae9b58491a888322d4a", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to access InfluxDB credentials on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            influxdb\n          \n        \n        \n          \n            credentials\n          \n        \n        \n          \n            config-reader-php\n          \n        \n        \n          \n            databases\n          \n        \n        \n          \n            php\n          \n        \n    \n\n\n\n\n  \n      \n        \n          chad-carlson\n          \n        \n\n        \n            \n            \n              April 16, 2019,  6:13pm\n            \n        #1\n        \n      \n      \n        Goal\nAccess credentials for InfluxDB from within a Platform.sh application using PHP.\nAssumptions\n\nan active Platform.sh project\nproperly configured .platform/services.yaml for the given service\n\nSSH key configured on account if developing locally\nInfluxDB installed if developing locally\nproperly configured InfluxDB relationship like so, in .platform.app.yaml:\n\nrelationships:\n    influxdb: 'influxdb:influxdb'\n\nIf developing locally, remember to first open a tunnel to the project environment using the Platform CLI.\n$ platform tunnel:open &amp;&amp; export PLATFORM_RELATIONSHIPS=\"$(platform tunnel:info --encode)\"\n\nThis will open an SSH tunnel to your current Platform.sh environment and expose a local environment variable that mimics the relationships array on Platform.sh. Check the Platform.sh documentation and How to develop locally on Platform.sh with a tethered connection for more information.\nProblems\nPlatform.sh service credentials are made available to applications as the PLATFORM_RELATIONSHIPS environment variable, which is a base64-encoded JSON string that has to be decoded before it can be used.\nThere are two primary options for accessing service credentials on Platform.sh that can be used within an application:\n\nUsing the Platform.sh Config Reader library\n\nAccessing environment variables directly\n\nSteps (Config Reader)\n1. Install the library\nInstall the configuration library. See the documentation for minimum requirements.\n$ composer install platformsh/config-reader    \n\n2. Create a Config object\nCreating a Config object provides access to the Platform.sh environment.\nuse Platformsh\\ConfigReader\\Config;\n    \n$config = new Config();    \n\n3. Read the credentials\n// Get the credentials to connect to the InfluxDB service.   \n$credentials = $config-&gt;credentials('influxdb');   \n\nSteps (Manual)\n1. Load and decode the environment variable\n$relationships = json_decode(base64_decode(getenv('PLATFORM_RELATIONSHIPS')), TRUE);    \n\n2. Read the credentials\n$credentials = $relationships['influxdb'];   \n\nUse:\nIn most cases, you will need only the  host  and  port  properties to connect to InfluxDB. Pass those to your InfluxDB library\u2019s setup routine in your application. Most of the time the other values may be ignored.\nIn either case, credentials is now an array matching the relationship JSON object.\n{\n  \"service\": \"influxdb\",\n  \"ip\": \"169.254.113.144\",\n  \"hostname\": \"haz5rys6n2dsnjusqa54os3ii4.influxdb.service._.eu-3.platformsh.site\",\n  \"cluster\": \"rjify4yjcwxaa-master-7rqtwti\",\n  \"host\": \"influxdb.internal\",\n  \"rel\": \"influxdb\",\n  \"scheme\": \"http\",\n  \"type\": \"influxdb:1.3\",\n  \"port\": 8086\n}\n\nConclusions:\nUsing either the language-specific Platform.sh Configuration library or direct access methods for environment variables, an application can get InfluxDB credentials in PHP.\nPlatform.sh supports configuration libraries for multiple languages. The PHP configuration library can be useful for inspecting the project environment:\n// Checks whether the code is running in a build environment\n$config-&gt;inBuild();\n// Checks whether the code is running in a runtime environment\n$config-&gt;inRuntime();\n\nand for reading environment variables as attributes of config:\n// Available in Build and at Runtime\n$config-&gt;appDir;\n// Available at Runtime only\n$config-&gt;branch;\n$config-&gt;smtpHost;\n\nThe APIs for each language are written to be as consistent as possible, but seek out each library\u2019s documentation for specific differences.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          chrigu\n          \n        \n\n        \n            \n              March 12, 2020,  8:19pm\n            \n        #2\n        \n      \n      \n        Thanks for sharing!\nI\u2019m able to setup the database &amp; tunnel to my InfluxDB, but whenever I\u2019m trying to connect from my application or from the influx cli I get the following message:\nERR: error authorizing query: create admin user first or disable authentication\nWarning: It is possible this error is due to not setting a database.\nPlease set a database with the command \"use &lt;database&gt;\".\n\nUnfortunately there are no credentials in the relationship JSON. Is there a way to add some settings to the service.yaml or how is one able to connect a InfluxDB.\nThanks!\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          kotnik\n          \n        \n\n        \n            \n              March 18, 2020,  1:59pm\n            \n        #3\n        \n      \n      \n        @chrigu for now, you have to create admin user yourself like this:\ncurl http://influx.internal:&lt;port&gt;/query -X POST -F q=\"CREATE USER admin WITH PASSWORD 'admin' WITH ALL PRIVILEGES\"\n\nWe\u2019re working on making this automatic and seamless, as with other services. It should be released rather soon.\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          chrigu\n          \n        \n\n        \n            \n              March 19, 2020,  6:42am\n            \n        #4\n        \n      \n      \n        Thanks! That exactly the information I was missing.\nFunnily enough it did not work when I used the curl command.\nI had to (after I started the tunnel)\ninflux -host 127.0.0.1 -port 30000                                                                                                                                                              [7:13:48]\nConnected to http://127.0.0.1:30000 version 1.7.10\nInfluxDB shell version: v1.7.9\n&gt; CREATE USER admin WITH PASSWORD 'admin' WITH ALL PRIVILEGES\n\nthen to use the user\ninflux -host 127.0.0.1 -port 30000 -username admin -password ''\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to create, initialize, and delete a Platform.sh project from the command line", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-create-initialize-and-delete-a-platform-sh-project-from-the-command-line/188", "documentId": "d43126d3ffe2ae6d717e593878c645aea6485890", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to create, initialize, and delete a Platform.sh project from the command line\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            project\n          \n        \n        \n          \n            devops\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          robert\n          \n        \n\n        \n            \n            \n              March 19, 2020, 11:37am\n            \n        #1\n        \n      \n      \n        Goal\nTo fully manage the life cycle of sites on Platform.sh, including the creation of new projects, initializing from a hosted GitHub repository, and deleting projects.\nAssumptions\n\n\nSSH key configured on account\nThe Platform.sh CLI installed\n\nProblems\nYou will need a public GitHub project that already has the required YAML files to work with Platform.sh.\nSteps\n1. Creating projects\nTo create a new project, use the platform create command.\n\n2019-04-03_09-50-13 (1).gif1130\u00d7533 1.24 MB\n\n2. Initializing projects from a GitHub repository\nThe platform environment:init command requires both the Project ID of the newly created project and the URL of the GitHub project. Note that as of version 3.40.8 of the Platform.sh CLI, the environment:init command is considered beta and not listed via platform list.\nplatform environment:init -p &lt;Project ID&gt; -e master &lt;GitHub URL&gt;\nNote that the GitHub URL is the https: URL from the browser, not the git: URL.\n\n2019-04-03_10-33-32 (1).gif1130\u00d7533 1.81 MB\n\nOpen the new site in your browser with the following command:\nplatform url -p &lt;Project ID&gt;\n\nplatform url -p ov4iu6fcb35jg\n\nEnvironment ID [master]:\n\nEnter a number to open a URL\n\n[0] https://master-7rqtwti-ov4iu6fcb35jg.de-2.platformsh.site/\n\n[1] https://www.master-7rqtwti-ov4iu6fcb35jg.de-2.platformsh.site/\n\n[2] http://master-7rqtwti-ov4iu6fcb35jg.de-2.platformsh.site/\n\n[3] http://www.master-7rqtwti-ov4iu6fcb35jg.de-2.platformsh.site/\n\n&gt; 0\n\nhttps://master-7rqtwti-ov4iu6fcb35jg.de-2.platformsh.site/\n\n\n\nScreen Shot 2019-04-03 at 10.40.15.jpg1518\u00d7798 128 KB\n\n3. Deleting projects\nDelete the project with the following command:\nplatform project:delete -p &lt;Project ID&gt;\nYou will be prompted to type the name of the project as a security confirmation, since deleting a project is irreversible.\n\nplatform project:delete -p ov4iu6fcb35jg\n\nYou are about to delete the project:\n\nNew Drupal Site (ov4iu6fcb35jg)\n\n* This action is irreversible.\n\n* Your site will no longer be accessible.\n\n* All data associated with this project will be deleted, including backups.\n\n* You will be charged at the end of the month for any remaining project costs.\n\nAre you sure you want to delete this project? [y/N] y\n\nType the project title to confirm: New Drupal Site\n\n\nConclusion\nThe Platform.sh CLI enables full life cycle management of your sites. It is not even necessary to use Git directly when creating, initializing, and deleting sites.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to monitor long running scripts with pv", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-monitor-long-running-scripts-with-pv/537", "documentId": "fc82415ed3208e46c6c38c4dccdb493ee9478c9b", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to monitor long running scripts with pv\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            import\n          \n        \n        \n          \n            pv\n          \n        \n        \n          \n            mysql\n          \n        \n        \n          \n            monitor\n          \n        \n    \n\n\n\n\n  \n      \n        \n          matthias-van-woensel\n          \n        \n\n        \n            \n            \n              April 22, 2020, 12:21pm\n            \n        #1\n        \n      \n      \n        Goal\nSometimes you want to run a long running process without feedback. PV is a tool that allows you to do just that.\nExample\n\nRunning a mysqldump\nmysqldump &lt;yourparams&gt; | pv --progress --size 100m &gt; /tmp/dump.sql\n\nImporting a mysql dump\npv dump.sql | mysql &lt;yourparams&gt;\n\nCopying a large file\npv /originallocation/largefile.bin &gt; /otherlocation/largefile.bin\n\nCreate a zip file\npv largefile.txt | zip &gt; largefile.zip\n\nCreate a tar archive\ntar -czf - ./foldertotar | (pv -p --timer --rate --bytes &gt; backup.tgz)\n\n\nProblem\nSounds cool, but pv isn\u2019t available by default.\nSolution\nLuckily, there is an easy solution.\nSimply add the pv package in your .platform.app.yaml file. This will automatically install pv. So you can use it.\ndependencies:\n  nodejs: # Specify one NPM package per line.\n    pv: '~1.0.1'\n\nNote: you can do this in any container type. PHP, nodejs, golang, \u2026\nThis works because there is a nodejs package that does the heavy lifting for us.\nFor more information on dependencies, check our documentation\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to Migrate my Java Application to Platfrom.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-migrate-my-java-application-to-platfrom-sh/529", "documentId": "97fd2b016d45e62c773e1f5facf312c0b25c0a0d", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to Migrate my Java Application to Platfrom.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            java\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n            \n              April 16, 2020, 11:28am\n            \n        #1\n        \n      \n      \n        Goal\nThis tutorial will cover how to migrate your Java application to Platform.sh.\nPreparation\nThis tutorial assumes you have\n\nA working Java 8 or higher application\nA text editor of your choice.\n\nProblems\nThe Java Application is ready, and now the team wants to migrate to Platform.sh and enjoy the benefits of cloud computing naturally.\nSteps\n\nUnderstand how Platform.sh works\nCreate a new Platform.sh projects\nCreate the route file to define the route, the service file to identify any services such a database that your application needs and the application file to determine how your application will be containerized and build.\nDefine the Java version that you want to use.\nYou can integrate to existing Github, Gitlab, or just use the remote repository that Platform.sh will provide to you.\n\nFurthermore, we also have those guides to help you to migrate with your Spring or Jakarta EE application:\n\nMigrate Spring-Data JPA\nMigrate Spring-Data MongoDB\nMigrate Payara JPA\nMigrate Jakarta EE/MicroProfile\nHow to migrate your Java Application from Heroku\n\nReferences\n\nTips about Java Commands to run your Application at Platform.sh\nHello World at Platform.sh\nJava Configuration-Reader\nJava at Platform.sh\nJava Frameworks at Platform.sh\nSamples Codes\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n                \n                  \n                    \n                    \n                    Tips for running Java on Platform.sh\n                  \n                \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to configure Java with New Relic At Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-configure-java-with-new-relic-at-platform-sh/533", "documentId": "2772948d9ac60ed532983127ace98a8717972062", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to configure Java with New Relic At Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            java\n          \n        \n    \n\n\n\n\n  \n      \n        \n          otavio-santana\n          \n        \n\n        \n            \n            \n              April 17, 2020,  7:48pm\n            \n        #1\n        \n      \n      \n        Goal\nThis tutorial will explain how to configure New Relic into a Java application at Platform.sh.\nAssumptions\n\n\nYou either have a Java application, and you want to run at Platform.sh or you already have a Java application running at Platform.sh\n\n\nA text editor of your choice.\n\n\nProblems\nNew Relic is a technology company that develops cloud-based software to help website and application owners track the performance of their services. That might be useful because you can track everything from performance issues to tiny errors within your code. Every minute the agent posts metric time slice and event data to the New Relic user interface, where the owner of that data can sign in and use the data to see how their website is performing.\nSteps\nTo set up new-relic in the Java project, we have two ways:\n\nUsing the maven project\nDownload the code through application.app.yaml.\n\nMaven\nThis section explains how to configure Maven to download and unzip the newrelic-java.zip file, which contains all New Relic Java agent components.\nTo set up the application with New Relic, you have two options:\nTo set up the application with New Relic, you have two options:\n\nConfiguring and download from Maven\nDownloading on your own\n\nConfigure your pom.xml to download newrelic-java.zip. For example:\n&lt;dependency&gt;\n     &lt;groupId&gt;com.newrelic.agent.java&lt;/groupId&gt;\n     &lt;artifactId&gt;newrelic-java&lt;/artifactId&gt;\n      &lt;version&gt;JAVA_AGENT_VERSION&lt;/version&gt;\n     &lt;scope&gt;provided&lt;/scope&gt;\n     &lt;type&gt;zip&lt;/type&gt;\n&lt;/dependency&gt;\n\n\nReplace JAVA_AGENT_VERSION with the latest Java agent version.\nUnzip newrelic-java.zip by configuring maven-dependency-plugin in your pom.xml. For example:\n   &lt;plugin&gt;\n        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n        &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;\n        &lt;version&gt;3.1.1&lt;/version&gt;\n        &lt;executions&gt;\n          &lt;execution&gt;\n            &lt;id&gt;unpack-newrelic&lt;/id&gt;\n            &lt;phase&gt;package&lt;/phase&gt;\n            &lt;goals&gt;\n              &lt;goal&gt;unpack-dependencies&lt;/goal&gt;\n            &lt;/goals&gt;\n            &lt;configuration&gt;\n              &lt;includeGroupIds&gt;com.newrelic.agent.java&lt;/includeGroupIds&gt;\n              &lt;includeArtifactIds&gt;newrelic-java&lt;/includeArtifactIds&gt;\n              &lt;excludes&gt;**/newrelic.yml&lt;/excludes&gt;\n              &lt;overWriteReleases&gt;false&lt;/overWriteReleases&gt;\n              &lt;overWriteSnapshots&gt;false&lt;/overWriteSnapshots&gt;\n              &lt;overWriteIfNewer&gt;true&lt;/overWriteIfNewer&gt;\n              &lt;outputDirectory&gt;${project.build.directory}&lt;/outputDirectory&gt;\n            &lt;/configuration&gt;\n          &lt;/execution&gt;\n        &lt;/executions&gt;\n      &lt;/plugin&gt;\n\nThe next step is to configure the .platform.app.yaml file to:\n\nSet the agent in the JVM parameters\nOverwrite the application file with the proper license key and application name. You can also do it using the API or the web UI. Therefore this configuration will work outside the code very useful when the application is on a public repository.\n\nname: app\ntype: 'java:8'\ndisk: 1024\nhooks:\n    build: |\n        mvn clean package\n        rm -rf newrelic/\n        mv target/newrelic/ newrelic/\n\nmounts:\n    'server/':\n        source: local\n        source_path: server_source\n\nvariables:\n    env:\n        NEW_RELIC_LICENSE_KEY: &lt;LICENSE_KEY&gt;\n        NEW_RELIC_APP_NAME: &lt;NAME_APPLICATION&gt;\n\nweb:\n    commands:\n        start: |\n            cp target/dependency/webapp-runner.jar server/webapp-runner.jar\n            cp target/tomcat.war server/tomcat.war\n             java -jar \\\n            -Xmx$(jq .info.limits.memory /run/config.json)m -XX:+ExitOnOutOfMemoryError \\\n            -javaagent:/app/newrelic/newrelic.jar //the other parameters here\n            \n\n\nManual installation\nTo use this installation it is only required that you modify .platform.app.yaml , which will download and set the New Relic Java agent for you.\nname: app\ntype: 'java:8'\ndisk: 1024\n\n\nvariables:\n    env:\n        NEW_RELIC_URL: https://download.newrelic.com/newrelic/java-agent/newrelic-agent/current/newrelic-java.zip\n        NEW_RELIC_LICENSE_KEY: &lt;LICENSE_KEY&gt;\n        NEW_RELIC_APP_NAME: &lt;NAME_APPLICATION&gt;\n\nhooks:\n    build: |\n      mvn clean package\n      rm -rf newrelic\n      curl -O $NEW_RELIC_URL\n      unzip newrelic-java.zip\n\n\nweb:\n    commands:\n        start: |\n            java -jar \\\n            -Xmx$(jq .info.limits.memory /run/config.json)m \\\n            -XX:+ExitOnOutOfMemoryError \\\n            -javaagent:/app/newrelic/newrelic.jar //the left of the commands here\n\n\nReferences\n\nNew Relic\nNew Relic Configuration File\nNew Relic Using Maven\nNew Relic install Java agent\nSource Code sample\n\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "How to make a Vue.js single page application (SPA) on Platform.sh", "section": "How-to Guides", "url": "https://community.platform.sh/t/how-to-make-a-vue-js-single-page-application-spa-on-platform-sh/125", "documentId": "b8513ae904afc6e34461e538ed6cf05ef608ce9f", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  How to make a Vue.js single page application (SPA) on Platform.sh\n\n\n\n    \n      \n        \n        How-to Guides\n      \n    \n\n\n    \n        \n          \n            nodejs\n          \n        \n        \n          \n            vuejs\n          \n        \n        \n          \n            cli\n          \n        \n    \n\n\n\n\n  \n      \n        \n          GuGuss\n          \n        \n\n        \n            \n            \n              March 8, 2020,  9:13pm\n            \n        #1\n        \n      \n      \n        Goal\nThis guide shows how to deploy a Vue.js application on Platform.sh, using Vue CLI 3.\nAssumptions\nTo go through this guide, you will need:\n\nAn empty Platform.sh project (you can click here to start your free trial)\nYour SSH key loaded in your SSH agent and configured in the Platform.sh dashboard\n\nThe Platform.sh CLI installed.\nThe Vue CLI installed.\n\nSteps\n1. Create a Vue.js application\nCreate a new Vue.js project with Vue CLI (ignore this step if you want to deploy an existing Vue.js application on Platform.sh):\nvue create vuejs-platformsh\ncd vuejs-platformsh\n\nSet the platform Git remote:\nplatform project:set-remote &lt;project id&gt;\n\nAdd the Platform.sh Vue plugin:\nvue add platformsh\n\nThis plugin will add the Platform.sh configuration files to your project and extract the Platform.sh environment variables.\n2.  Deploy your application to Platform.sh\n\nCommit and push your code to deploy your application:\ngit add --all\ngit commit -m \"Vue.js on Platform.sh.\"\ngit push platform master\n\n3. Test your application on Platform.sh\n\nplatform url\n\nThis opens a browser tab with your Vue.js application running.\n4. Fetch Platform.sh environment variables\nThe plugin will automatically extract the Platform.sh environment variables.\nTo fetch those, you simply need to import the following package:\nimport platformshVar from 'platformsh_variables'\n\nConclusion\nUsing the Vue CLI, it\u2019s very easy to setup and deploy a new or an existing Vue.js application on Platform.sh.\n      \n\n      \n\n      \n         \n         \n         2 Likes\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          modermo\n          \n        \n\n        \n            \n              April 20, 2020,  9:46pm\n            \n        #2\n        \n      \n      \n        What about proper redirecting when Vue Router is in \u2018history\u2019 mode?  I know that Platform has their own way of doing redirects, wondering whether I need to touch the routes.yaml file.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          yann-deshayes\n          \n        \n\n        \n            \n            \n              April 22, 2020,  2:32pm\n            \n        #3\n        \n      \n      \n        @modermo I think what you want is to add  passthru option to the web location YAML object.\nThat option will for all the routes to be passed to the index.html, and you can handle that route in your app.\nFor example:\nname: app\ntype: nodejs:12\n# The configuration of app when it is exposed to the web.\nweb:\n  locations:\n    \"/\":\n      root: \"dist\"\n      index:\n        - \"index.html\"\n      passthru: /index.html\n\nYann\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n  \n      \n        \n          modermo\n          \n        \n\n        \n            \n            \n              April 23, 2020, 12:00am\n            \n        #4\n        \n      \n      \n        @ yann-deshayes That works. Thanks for that.\nI would consider including this in the above documentation, as getting History mode for a Vue SPA working on different server environments is a common but somewhat tricky endeavour.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3},
{"site": "community", "title": "Using platform.sh environments for continuous integration / functional tests", "section": "Questions & Answers", "url": "https://community.platform.sh/t/using-platform-sh-environments-for-continuous-integration-functional-tests/386/2", "documentId": "2fe4fb2771c14157e7c1de42f6f6ca38a4573699", "text": "\n    \n\n\n    \n      \n          \n      \n    \n    \n      \n  Using platform.sh environments for continuous integration / functional tests\n\n\n\n    \n      \n        \n        Questions &amp; Answers\n      \n    \n\n\n\n\n\n\n  \n      \n        \n          daniel\n          \n        \n\n        \n            \n              September 9, 2019,  6:45am\n            \n        #1\n        \n      \n      \n        What would the pros / cons of using platform to run integration / functional tests, instead of a typical Continuous Integration service? And is using platform to run functional tests possible / a bad idea?\nMy thinking is this:\n\nUnit tests, static analysis, code linting etc. are easy to run in isolation, so that should remain in a typical CI environment\nFunctional tests require a functioning environment, which platform.sh can automatically provide\nSometimes you want to run your functional tests against production data, which is also something platform.sh can automatically provide\n\nAn example implementation could be:\n\nOn build, detect if this is an environment you want to run tests in (eg. non-production, pull request environment etc.)\nInstall any tools you need to run functional tests (eg. a headless browser and testing framework)\nRun the tests \u2013 fail the build if the tests fail\nSend notification of the passed/failed build (I think the standard github pull request integration would report this back, but I\u2019m not sure \u2013 an email or slack notification could be sent)\n\n      \n\n      \n\n      \n         \n         \n         1 Like\n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n  \n      \n        \n          Crell\n          \n        \n\n        \n            \n              February 7, 2020,  8:12pm\n            \n        #2\n        \n      \n      \n        Hi Daniel.\nThe build environment is branch-agnostic.  Since build images can be reused on multiple branches there\u2019s no way to detect the branch during build.\nThis is not something we currently support directly; you can run unit tests (that do not require access to the database) during build.  More on that here: How to fail a build on failing unit tests\nFor end to end tests, you would need to ensure the tools are installed in all environments.  Then in a post_deploy hook, check if you\u2019re on a branch where you want to run tests (at minimum, non-master), and run whatever commands you need.  It\u2019s better to do in post_deploy than deploy because deploy blocks the environment being publicly accessible, which  may be necessary depending on the nature of your tests.\nThe report-back in case of failure is the big challenge.  At present we have no mechanism available to do that.  If you have some external notification system that can accept a webhook, you can have your test code ping that URL when it\u2019s done.  We have no built-in support for it at this time, though.\n      \n\n      \n\n      \n         \n         \n         \n       \n\n       \n          \n          \n        \n\n          \n          \n\n  \n\n\n\n\n\n\n    \n    \n      \n        \n        Home \n        Categories \n        FAQ/Guidelines \n        Terms of Service \n        Privacy Policy \n        \n      \n      Powered by Discourse, best viewed with JavaScript enabled\n    \n    \n  ", "rank": 3}
]